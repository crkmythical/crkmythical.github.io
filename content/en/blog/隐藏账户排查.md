---
title: 隐藏账户排查
encrypt: false
enc_pwd: askding
categories:
  - Response
date: 2022-02-15 18:57:27
top:
tags:
layout:
---
编写进度
- [x] 


隐藏账户排查


# 隐藏账户排查
## 创建隐藏账户
用户名$ 方式创建的用户，使用`net user`方式查看不到
参考 [隐藏账户创建](https://www.freebuf.com/articles/system/258981.html)
D盾可查到
```zsh
net user test$ passwd /add && net localgroup administrators test$ /add  
```

## 排查隐藏账户-lusrmgr方式
`win+R` 输入 `lusrmgr.msc` 打开 **本地用户和组**，查看是否存在$结尾的账户

## 排查隐藏账户-regedit方式
`win+R` 输入 `regedit` 打开 **注册表编辑器** ，定位到 `HKEY_LOCAL_MACHINE/SAM/SAM`,右键最后一个 **SAM** 选择**权限** 将权限勾选为**完全控制**，然后确定，关闭注册表编辑器
![regedit](https://raw.githubusercontent.com/crkmythical/PicGo/main/images/20210818143221_regedit.png)

最后定位到 `HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\Names`查看所有账户
![regiedit-Names](https://raw.githubusercontent.com/crkmythical/PicGo/main/images/20210818143712_regedit-Names.png)



## 端口排查
- `win+R` 输入 `cmd` 运行 `netstat -nao` 查看异常端口连接找到对应PID
- `win+R` 输入 `taskmgr` 打开任务管理器 点击**详细信息**查看对应的PID进程信息，右键进程打开文件所在位置，可查看当前进程对应的程序


## 启动项及计划任务排查
- 系统启动菜单`C:\Users\frame\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup` 
- `win+R` 输入 `msconfig` 打开系统配置，查看**启动**
-  `win+R` 输入 `regedit` 打开注册表编辑器，查看以下路径是否存在
`{HKEY_LOCAL_MACHINE|HKEY_CURRENT_USER}\Software\Microsoft\Windows\CurrentVersion\{Run|RunOnce}`






